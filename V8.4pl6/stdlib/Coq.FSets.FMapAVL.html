<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/node/node.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/defaults.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/user/user.css" />
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/coq/style.css" />
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/coq/coqdoc.css" />

<title>Standard Library | The Coq Proof Assistant</title>

</head>

<body>

<div id="container">
  <div id="headertop">
    <div id="nav">
      <ul class="links-menu">
        <li><a href="/" class="active">Home</a></li>
        <li><a href="/about-coq" title="More about coq">About Coq</a></li>
        <li><a href="/download">Get Coq</a></li>
        <li><a href="/documentation">Documentation</a></li>
        <li><a href="/community">Community</a></li>
      </ul>
    </div>
  </div>

  <div id="header">
    <div id="logoWrapper">
      <div id="logo"><a href="/" title="Home"><img src="/files/barron_logo.png" alt="Home" /></a>
      </div>
      <div id="siteName"><a href="/" title="Home">The Coq Proof Assistant</a>
      </div>
    </div>
  </div>

  <div id="content">

<h1 class="libtitle">Library Coq.FSets.FMapAVL</h1>

<div class="code">

<br/>

<br/>
</div>

<div class="doc">
<a name="lab390"></a><h1 class="section">FMapAVL</h1>

<div class="paragraph"> </div>

 This module implements maps using AVL trees.
    It follows the implementation from Ocaml's standard library.

<div class="paragraph"> </div>

    See the comments at the beginning of FSetAVL for more details.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Coq.FSets.FMapInterface.html#"><span class="id" title="library">FMapInterface</span></a> <a class="idref" href="Coq.FSets.FMapList.html#"><span class="id" title="library">FMapList</span></a> <a class="idref" href="Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a> <a class="idref" href="Coq.ZArith.Int.html#"><span class="id" title="library">Int</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>

<br/>
</div>

<div class="doc">
Notations and helper lemma about pairs 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <a name="958089bbde3710709508243fb6154391"><span class="id" title="notation">&quot;</span></a>s #1" := (<a class="idref" href="Coq.Init.Datatypes.html#fst"><span class="id" title="definition">fst</span></a> <span class="id" title="var">s</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "s '#1'") : <span class="id" title="var">pair_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> <a name="530f8ed31843cc030ef5c7c9bedb7689"><span class="id" title="notation">&quot;</span></a>s #2" := (<a class="idref" href="Coq.Init.Datatypes.html#snd"><span class="id" title="definition">snd</span></a> <span class="id" title="var">s</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "s '#2'") : <span class="id" title="var">pair_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab391"></a><h1 class="section">The Raw functor</h1>


<div class="paragraph"> </div>

   Functor of pure functions + separate proofs of invariant
   preservation 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="Raw"><span class="id" title="module">Raw</span></a> (<span class="id" title="keyword">Import</span> <span class="id" title="var">I</span>:<a class="idref" href="Coq.ZArith.Int.html#Int"><span class="id" title="module">Int</span></a>)(<span class="id" title="var">X</span>: <a class="idref" href="Coq.Structures.OrderedType.html#OrderedType"><span class="id" title="module">OrderedType</span></a>).<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">pair_scope</span>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">lazy_bool_scope</span>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Int_scope</span>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Notation</span> <a name="Raw.int"><span class="id" title="abbreviation">int</span></a> := <a class="idref" href="Coq.FSets.FMapAVL.html#I.t"><span class="id" title="axiom">I.t</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.key"><span class="id" title="definition">key</span></a> := <a class="idref" href="Coq.FSets.FMapAVL.html#X.t"><span class="id" title="axiom">X.t</span></a>.<br/>
<span class="id" title="keyword">Hint Transparent</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab392"></a><h1 class="section">Trees</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a name="Raw.Elt"><span class="id" title="section">Elt</span></a>.<br/>

<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Elt.elt"><span class="id" title="variable">elt</span></a> : <span class="id" title="keyword">Type</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab393"></a><h1 class="section">Trees</h1>


<div class="paragraph"> </div>

   The fifth field of <span class="inlinecode"><span class="id" title="var">Node</span></span> is the height of the tree 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="Raw.tree"><span class="id" title="inductive">tree</span></a> :=<br/>
&nbsp;&nbsp;| <a name="Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#tree"><span class="id" title="inductive">tree</span></a><br/>
&nbsp;&nbsp;| <a name="Raw.Node"><span class="id" title="constructor">Node</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#tree"><span class="id" title="inductive">tree</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#tree"><span class="id" title="inductive">tree</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.int"><span class="id" title="abbreviation">int</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#tree"><span class="id" title="inductive">tree</span></a>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <a name="Raw.t"><span class="id" title="abbreviation">t</span></a> := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.tree"><span class="id" title="inductive">tree</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab394"></a><h1 class="section">Basic functions on trees: height and cardinal</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.height"><span class="id" title="definition">height</span></a> (<span class="id" title="var">m</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a>) : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.int"><span class="id" title="abbreviation">int</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; 0<br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">h</span> =&gt; <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.cardinal"><span class="id" title="definition">cardinal</span></a> (<span class="id" title="var">m</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a>) : <a class="idref" href="Coq.Init.Datatypes.html#nat"><span class="id" title="inductive">nat</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; 0%<span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#S"><span class="id" title="constructor">S</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#cardinal"><span class="id" title="definition">cardinal</span></a> <span class="id" title="var">l</span> <a class="idref" href="Coq.Init.Peano.html#b3eea360671e1b32b18a26e15b3aace3"><span class="id" title="notation">+</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#cardinal"><span class="id" title="definition">cardinal</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab395"></a><h1 class="section">Empty Map</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.empty"><span class="id" title="definition">empty</span></a> := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab396"></a><h1 class="section">Emptyness test</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.is_empty"><span class="id" title="definition">is_empty</span></a> <span class="id" title="var">m</span> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab397"></a><h1 class="section">Membership</h1>

<div class="paragraph"> </div>

 The <span class="inlinecode"><span class="id" title="var">mem</span></span> function is deciding membership. It exploits the <span class="inlinecode"><span class="id" title="var">bst</span></span> property
    to achieve logarithmic complexity. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.mem"><span class="id" title="definition">mem</span></a> <span class="id" title="var">x</span> <span class="id" title="var">m</span> : <a class="idref" href="Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">_</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#LT"><span class="id" title="constructor">LT</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#mem"><span class="id" title="definition">mem</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#EQ"><span class="id" title="constructor">EQ</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#GT"><span class="id" title="constructor">GT</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#mem"><span class="id" title="definition">mem</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.find"><span class="id" title="definition">find</span></a> <span class="id" title="var">x</span> <span class="id" title="var">m</span> : <a class="idref" href="Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#LT"><span class="id" title="constructor">LT</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#find"><span class="id" title="definition">find</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#EQ"><span class="id" title="constructor">EQ</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#GT"><span class="id" title="constructor">GT</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#find"><span class="id" title="definition">find</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab398"></a><h1 class="section">Helper functions</h1>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">create</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> creates a node, assuming <span class="inlinecode"><span class="id" title="var">l</span></span> and <span class="inlinecode"><span class="id" title="var">r</span></span>
    to be balanced and <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">r</span>|</span> <span class="inlinecode">&lt;=</span> <span class="inlinecode">2</span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> :=<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#I.max"><span class="id" title="axiom">max</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.height"><span class="id" title="definition">height</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a>) (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.height"><span class="id" title="definition">height</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a>) <a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a> 1).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">bal</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> acts as <span class="inlinecode"><span class="id" title="var">create</span></span>, but performs one step of
    rebalancing if necessary, i.e. assumes <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">r</span>|</span> <span class="inlinecode">&lt;=</span> <span class="inlinecode">3</span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.assert_false"><span class="id" title="definition">assert_false</span></a> := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.bal"><span class="id" title="definition">bal</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hl</span> := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.height"><span class="id" title="definition">height</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hr</span> := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.height"><span class="id" title="definition">height</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.FSets.FMapAVL.html#I.gt_le_dec"><span class="id" title="axiom">gt_le_dec</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#hl"><span class="id" title="variable">hl</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#hr"><span class="id" title="variable">hr</span></a><a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a>2) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.assert_false"><span class="id" title="definition">assert_false</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> <span class="id" title="var">lr</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.FSets.FMapAVL.html#I.ge_lt_dec"><span class="id" title="axiom">ge_lt_dec</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.height"><span class="id" title="definition">height</span></a> <span class="id" title="var">ll</span>) (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.height"><span class="id" title="definition">height</span></a> <span class="id" title="var">lr</span>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">lr</span> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lr</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.assert_false"><span class="id" title="definition">assert_false</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">lrl</span> <span class="id" title="var">lrx</span> <span class="id" title="var">lrd</span> <span class="id" title="var">lrr</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> <span class="id" title="var">lrl</span>) <span class="id" title="var">lrx</span> <span class="id" title="var">lrd</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">lrr</span> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.FSets.FMapAVL.html#I.gt_le_dec"><span class="id" title="axiom">gt_le_dec</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#hr"><span class="id" title="variable">hr</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#hl"><span class="id" title="variable">hl</span></a><a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a>2) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.assert_false"><span class="id" title="definition">assert_false</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rd</span> <span class="id" title="var">rr</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.FSets.FMapAVL.html#I.ge_lt_dec"><span class="id" title="axiom">ge_lt_dec</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.height"><span class="id" title="definition">height</span></a> <span class="id" title="var">rr</span>) (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.height"><span class="id" title="definition">height</span></a> <span class="id" title="var">rl</span>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="var">rl</span>) <span class="id" title="var">rx</span> <span class="id" title="var">rd</span> <span class="id" title="var">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">rl</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.assert_false"><span class="id" title="definition">assert_false</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">rll</span> <span class="id" title="var">rlx</span> <span class="id" title="var">rld</span> <span class="id" title="var">rlr</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="var">rll</span>) <span class="id" title="var">rlx</span> <span class="id" title="var">rld</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">rlr</span> <span class="id" title="var">rx</span> <span class="id" title="var">rd</span> <span class="id" title="var">rr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab399"></a><h1 class="section">Insertion</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.add"><span class="id" title="definition">add</span></a> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">m</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> 1<br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">d&acute;</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#LT"><span class="id" title="constructor">LT</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.bal"><span class="id" title="definition">bal</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#add"><span class="id" title="definition">add</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">y</span> <span class="id" title="var">d&acute;</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#EQ"><span class="id" title="constructor">EQ</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="var">r</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#GT"><span class="id" title="constructor">GT</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.bal"><span class="id" title="definition">bal</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">d&acute;</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#add"><span class="id" title="definition">add</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab400"></a><h1 class="section">Extraction of minimum binding</h1>


<div class="paragraph"> </div>

  Morally, <span class="inlinecode"><span class="id" title="var">remove_min</span></span> is to be applied to a non-empty tree
  <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Node</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span>. Since we can't deal here with <span class="inlinecode"><span class="id" title="tactic">assert</span></span> <span class="inlinecode"><span class="id" title="var">false</span></span>
  for <span class="inlinecode"><span class="id" title="var">t</span>=<span class="id" title="var">Leaf</span></span>, we pre-unpack <span class="inlinecode"><span class="id" title="var">t</span></span> (and forget about <span class="inlinecode"><span class="id" title="var">h</span></span>).

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.remove_min"><span class="id" title="definition">remove_min</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a><a class="idref" href="Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*(</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a><a class="idref" href="Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a><a class="idref" href="Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">)</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,(</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">))</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> <span class="id" title="var">lr</span> <span class="id" title="var">lh</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">l&acute;</span>,<span class="id" title="var">m</span>) := <a class="idref" href="Coq.FSets.FMapAVL.html#remove_min"><span class="id" title="definition">remove_min</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> <span class="id" title="var">lr</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#Raw.bal"><span class="id" title="definition">bal</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l&acute;"><span class="id" title="variable">l&acute;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab401"></a><h1 class="section">Merging two trees</h1>


<div class="paragraph"> </div>

  <span class="inlinecode"><span class="id" title="var">merge</span></span> <span class="inlinecode"><span class="id" title="var">t1</span></span> <span class="inlinecode"><span class="id" title="var">t2</span></span> builds the union of <span class="inlinecode"><span class="id" title="var">t1</span></span> and <span class="inlinecode"><span class="id" title="var">t2</span></span> assuming all elements
  of <span class="inlinecode"><span class="id" title="var">t1</span></span> to be smaller than all elements of <span class="inlinecode"><span class="id" title="var">t2</span></span>, and
  <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">t1</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">t2</span>|</span> <span class="inlinecode">&lt;=</span> <span class="inlinecode">2</span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.merge"><span class="id" title="definition">merge</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> :=  <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#s1"><span class="id" title="variable">s1</span></a>,<a class="idref" href="Coq.FSets.FMapAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#s2"><span class="id" title="variable">s2</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#s1"><span class="id" title="variable">s1</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l2</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">h2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.remove_min"><span class="id" title="definition">remove_min</span></a> <span class="id" title="var">l2</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">s2&acute;</span><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,(</span></a><span class="id" title="var">x</span><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">d</span><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">))</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.bal"><span class="id" title="definition">bal</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#s1"><span class="id" title="variable">s1</span></a> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">s2&acute;</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab402"></a><h1 class="section">Deletion</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.remove"><span class="id" title="definition">remove</span></a> <span class="id" title="var">x</span> <span class="id" title="var">m</span> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#LT"><span class="id" title="constructor">LT</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.bal"><span class="id" title="definition">bal</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#remove"><span class="id" title="definition">remove</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">y</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#EQ"><span class="id" title="constructor">EQ</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.merge"><span class="id" title="definition">merge</span></a> <span class="id" title="var">l</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#GT"><span class="id" title="constructor">GT</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.bal"><span class="id" title="definition">bal</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">d</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#remove"><span class="id" title="definition">remove</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab403"></a><h1 class="section">join</h1>


<div class="paragraph"> </div>

    Same as <span class="inlinecode"><span class="id" title="var">bal</span></span> but does not assume anything regarding heights of <span class="inlinecode"><span class="id" title="var">l</span></span>
    and <span class="inlinecode"><span class="id" title="var">r</span></span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.join"><span class="id" title="definition">join</span></a> <span class="id" title="var">l</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.add"><span class="id" title="definition">add</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> <span class="id" title="var">lr</span> <span class="id" title="var">lh</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="var">join_aux</span> (<span class="id" title="var">r</span>:<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a>) : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt;  <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.add"><span class="id" title="definition">add</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rd</span> <span class="id" title="var">rr</span> <span class="id" title="var">rh</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.FSets.FMapAVL.html#I.gt_le_dec"><span class="id" title="axiom">gt_le_dec</span></a> <span class="id" title="var">lh</span> (<span class="id" title="var">rh</span><a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a>2) <span class="id" title="keyword">then</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.bal"><span class="id" title="definition">bal</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#join"><span class="id" title="definition">join</span></a> <span class="id" title="var">lr</span> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <a class="idref" href="Coq.FSets.FMapAVL.html#I.gt_le_dec"><span class="id" title="axiom">gt_le_dec</span></a> <span class="id" title="var">rh</span> (<span class="id" title="var">lh</span><a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a>2) <span class="id" title="keyword">then</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.bal"><span class="id" title="definition">bal</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#join_aux"><span class="id" title="variable">join_aux</span></a> <span class="id" title="var">rl</span>) <span class="id" title="var">rx</span> <span class="id" title="var">rd</span> <span class="id" title="var">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.create"><span class="id" title="definition">create</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab404"></a><h1 class="section">Splitting</h1>


<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">split</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> returns a triple <span class="inlinecode">(<span class="id" title="var">l</span>,</span> <span class="inlinecode"><span class="id" title="var">o</span>,</span> <span class="inlinecode"><span class="id" title="var">r</span>)</span> where

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">l</span></span> is the set of elements of <span class="inlinecode"><span class="id" title="var">m</span></span> that are <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">x</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">r</span></span> is the set of elements of <span class="inlinecode"><span class="id" title="var">m</span></span> that are <span class="inlinecode">&gt;</span> <span class="inlinecode"><span class="id" title="var">x</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">o</span></span> is the result of <span class="inlinecode"><span class="id" title="var">find</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span>.

</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <a name="Raw.triple"><span class="id" title="record">triple</span></a> := <a name="Raw.mktriple"><span class="id" title="constructor">mktriple</span></a> { <a name="Raw.t_left"><span class="id" title="projection">t_left</span></a>:<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a>; <a name="Raw.t_opt"><span class="id" title="projection">t_opt</span></a>:<a class="idref" href="Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a>; <a name="Raw.t_right"><span class="id" title="projection">t_right</span></a>:<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> }.<br/>
<span class="id" title="keyword">Notation</span> <a name="fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&quot;</span></a>&lt;&lt; l , b , r &gt;&gt;" := (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.mktriple"><span class="id" title="constructor">mktriple</span></a> <span class="id" title="var">l</span> <span class="id" title="var">b</span> <span class="id" title="var">r</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.split"><span class="id" title="definition">split</span></a> <span class="id" title="var">x</span> <span class="id" title="var">m</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.triple"><span class="id" title="record">triple</span></a> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&lt;&lt;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#LT"><span class="id" title="constructor">LT</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">ll</span>,<span class="id" title="var">o</span>,<span class="id" title="var">rl</span>) := <a class="idref" href="Coq.FSets.FMapAVL.html#split"><span class="id" title="definition">split</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">l</span> <span class="id" title="keyword">in</span> <a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&lt;&lt;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#ll"><span class="id" title="variable">ll</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#o"><span class="id" title="variable">o</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.join"><span class="id" title="definition">join</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#rl"><span class="id" title="variable">rl</span></a> <span class="id" title="var">y</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#EQ"><span class="id" title="constructor">EQ</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&lt;&lt;</span></a> <span class="id" title="var">l</span><a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">d</span><a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">,</span></a> <span class="id" title="var">r</span> <a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#GT"><span class="id" title="constructor">GT</span></a> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">rl</span>,<span class="id" title="var">o</span>,<span class="id" title="var">rr</span>) := <a class="idref" href="Coq.FSets.FMapAVL.html#split"><span class="id" title="definition">split</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">r</span> <span class="id" title="keyword">in</span> <a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&lt;&lt;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.join"><span class="id" title="definition">join</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">d</span> <a class="idref" href="Coq.FSets.FMapAVL.html#rl"><span class="id" title="variable">rl</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#o"><span class="id" title="variable">o</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#rr"><span class="id" title="variable">rr</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#fe7428777e9f19ea90383aff0018617c"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab405"></a><h1 class="section">Concatenation</h1>


<div class="paragraph"> </div>

   Same as <span class="inlinecode"><span class="id" title="var">merge</span></span> but does not assume anything about heights.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.concat"><span class="id" title="definition">concat</span></a> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m1"><span class="id" title="variable">m1</span></a>, <a class="idref" href="Coq.FSets.FMapAVL.html#m2"><span class="id" title="variable">m2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#m2"><span class="id" title="variable">m2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> , <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#m1"><span class="id" title="variable">m1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l2</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">m2&acute;</span>,<span class="id" title="var">xd</span>) := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.remove_min"><span class="id" title="definition">remove_min</span></a> <span class="id" title="var">l2</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.join"><span class="id" title="definition">join</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m1"><span class="id" title="variable">m1</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#xd"><span class="id" title="variable">xd</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#958089bbde3710709508243fb6154391"><span class="id" title="notation">#1</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#xd"><span class="id" title="variable">xd</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#530f8ed31843cc030ef5c7c9bedb7689"><span class="id" title="notation">#2</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m2&acute;"><span class="id" title="variable">m2&acute;</span></a><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab406"></a><h1 class="section">Elements</h1>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">elements_tree_aux</span></span> <span class="inlinecode"><span class="id" title="var">acc</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> catenates the elements of <span class="inlinecode"><span class="id" title="var">t</span></span> in infix
    order to the list <span class="inlinecode"><span class="id" title="var">acc</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.elements_aux"><span class="id" title="definition">elements_aux</span></a> (<span class="id" title="var">acc</span> : <a class="idref" href="Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a><a class="idref" href="Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a>)) <span class="id" title="var">m</span> : <a class="idref" href="Coq.Init.Datatypes.html#list"><span class="id" title="inductive">list</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a><a class="idref" href="Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#acc"><span class="id" title="variable">acc</span></a><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#elements_aux"><span class="id" title="definition">elements_aux</span></a> (<a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><span class="id" title="var">x</span><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><span class="id" title="var">d</span><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a> <a class="idref" href="Coq.Init.Datatypes.html#0a8150c3c4df34d205c5ed9a427e2ed5"><span class="id" title="notation">::</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#elements_aux"><span class="id" title="definition">elements_aux</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#acc"><span class="id" title="variable">acc</span></a> <span class="id" title="var">r</span>) <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
then <span class="inlinecode"><span class="id" title="var">elements</span></span> is an instanciation with an empty <span class="inlinecode"><span class="id" title="var">acc</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.elements"><span class="id" title="definition">elements</span></a> := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.elements_aux"><span class="id" title="definition">elements_aux</span></a> <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" title="constructor">nil</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab407"></a><h1 class="section">Fold</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.fold"><span class="id" title="definition">fold</span></a> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#A"><span class="id" title="variable">A</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#A"><span class="id" title="variable">A</span></a>) (<span class="id" title="var">m</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a>) : <a class="idref" href="Coq.FSets.FMapAVL.html#A"><span class="id" title="variable">A</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#A"><span class="id" title="variable">A</span></a> :=<br/>
&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> =&gt; <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#a"><span class="id" title="variable">a</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">r</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">x</span> <span class="id" title="var">d</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#fold"><span class="id" title="definition">fold</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">l</span> <a class="idref" href="Coq.FSets.FMapAVL.html#a"><span class="id" title="variable">a</span></a>))<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab408"></a><h1 class="section">Comparison</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Elt.cmp"><span class="id" title="variable">cmp</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a>-&gt;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a>-&gt;<a class="idref" href="Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab409"></a><h2 class="section">Enumeration of the elements of a tree</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="Raw.enumeration"><span class="id" title="inductive">enumeration</span></a> :=<br/>
&nbsp;| <span class="id" title="keyword">End</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#enumeration"><span class="id" title="inductive">enumeration</span></a><br/>
&nbsp;| <a name="Raw.More"><span class="id" title="constructor">More</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#enumeration"><span class="id" title="inductive">enumeration</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#enumeration"><span class="id" title="inductive">enumeration</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">cons</span></span> <span class="inlinecode"><span class="id" title="var">m</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> adds the elements of tree <span class="inlinecode"><span class="id" title="var">m</span></span> on the head of
    enumeration <span class="inlinecode"><span class="id" title="var">e</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.cons"><span class="id" title="definition">cons</span></a> <span class="id" title="var">m</span> <span class="id" title="var">e</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.enumeration"><span class="id" title="inductive">enumeration</span></a> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#e"><span class="id" title="variable">e</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#cons"><span class="id" title="definition">cons</span></a> <span class="id" title="var">l</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.More"><span class="id" title="constructor">More</span></a> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <a class="idref" href="Coq.FSets.FMapAVL.html#e"><span class="id" title="variable">e</span></a>)<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
One step of comparison of elements 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.equal_more"><span class="id" title="definition">equal_more</span></a> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> (<span class="id" title="var">cont</span>:<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.enumeration"><span class="id" title="inductive">enumeration</span></a>-&gt;<a class="idref" href="Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <span class="id" title="var">e2</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#e2"><span class="id" title="variable">e2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="keyword">End</span> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.More"><span class="id" title="constructor">More</span></a> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x1"><span class="id" title="variable">x1</span></a> <span class="id" title="var">x2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Structures.OrderedType.html#EQ"><span class="id" title="constructor">EQ</span></a> <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt.cmp"><span class="id" title="variable">cmp</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d1"><span class="id" title="variable">d1</span></a> <span class="id" title="var">d2</span> <a class="idref" href="Coq.Bool.Bool.html#904a85b4814d009a1516bd4b10d7e096"><span class="id" title="notation">&amp;&amp;&amp;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#cont"><span class="id" title="variable">cont</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.cons"><span class="id" title="definition">cons</span></a> <span class="id" title="var">r2</span> <a class="idref" href="Coq.FSets.FMapAVL.html#e2"><span class="id" title="variable">e2</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Comparison of left tree, middle element, then right tree 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.equal_cont"><span class="id" title="definition">equal_cont</span></a> <span class="id" title="var">m1</span> (<span class="id" title="var">cont</span>:<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.enumeration"><span class="id" title="inductive">enumeration</span></a>-&gt;<a class="idref" href="Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <span class="id" title="var">e2</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m1"><span class="id" title="variable">m1</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#cont"><span class="id" title="variable">cont</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e2"><span class="id" title="variable">e2</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l1</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> <span class="id" title="var">r1</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#equal_cont"><span class="id" title="definition">equal_cont</span></a> <span class="id" title="var">l1</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.equal_more"><span class="id" title="definition">equal_more</span></a> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#equal_cont"><span class="id" title="definition">equal_cont</span></a> <span class="id" title="var">r1</span> <a class="idref" href="Coq.FSets.FMapAVL.html#cont"><span class="id" title="variable">cont</span></a>)) <a class="idref" href="Coq.FSets.FMapAVL.html#e2"><span class="id" title="variable">e2</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Initial continuation 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.equal_end"><span class="id" title="definition">equal_end</span></a> <span class="id" title="var">e2</span> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#e2"><span class="id" title="variable">e2</span></a> <span class="id" title="keyword">with</span> <span class="id" title="keyword">End</span> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a> | <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a> <span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The complete comparison 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.equal"><span class="id" title="definition">equal</span></a> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.equal_cont"><span class="id" title="definition">equal_cont</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m1"><span class="id" title="variable">m1</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.equal_end"><span class="id" title="definition">equal_end</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.cons"><span class="id" title="definition">cons</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m2"><span class="id" title="variable">m2</span></a> <span class="id" title="keyword">End</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Elt"><span class="id" title="section">Elt</span></a>.<br/>
<span class="id" title="keyword">Notation</span> <a name="Raw.t"><span class="id" title="abbreviation">t</span></a> := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.tree"><span class="id" title="inductive">tree</span></a>.<br/>
<span class="id" title="keyword">Notation</span> <a name="aaef9b9f9603a4d5cb17d6afc46c9149"><span class="id" title="notation">&quot;</span></a>&lt;&lt; l , b , r &gt;&gt;" := (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.mktriple"><span class="id" title="constructor">mktriple</span></a> <span class="id" title="var">l</span> <span class="id" title="var">b</span> <span class="id" title="var">r</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9).<br/>
<span class="id" title="keyword">Notation</span> <a name="9492790caeffc9a1b71f6f0a20596a90"><span class="id" title="notation">&quot;</span></a>t #l" := (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t_left"><span class="id" title="projection">t_left</span></a> <span class="id" title="var">t</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "t '#l'").<br/>
<span class="id" title="keyword">Notation</span> <a name="434727a9b9f9663894950e213a8fb599"><span class="id" title="notation">&quot;</span></a>t #o" := (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t_opt"><span class="id" title="projection">t_opt</span></a> <span class="id" title="var">t</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "t '#o'").<br/>
<span class="id" title="keyword">Notation</span> <a name="071cee7594a1fd97bb3653d0a158ac42"><span class="id" title="notation">&quot;</span></a>t #r" := (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t_right"><span class="id" title="projection">t_right</span></a> <span class="id" title="var">t</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "t '#r'").<br/>

<br/>
</div>

<div class="doc">
<a name="lab410"></a><h1 class="section">Map</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.map"><span class="id" title="definition">map</span></a> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> : <span class="id" title="keyword">Type</span>)(<span class="id" title="var">f</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#elt&acute;"><span class="id" title="variable">elt&acute;</span></a>)(<span class="id" title="var">m</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#elt"><span class="id" title="variable">elt</span></a>) : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#elt&acute;"><span class="id" title="variable">elt&acute;</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a>   =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">x</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">d</span>) (<a class="idref" href="Coq.FSets.FMapAVL.html#map"><span class="id" title="definition">map</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">r</span>) <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.mapi"><span class="id" title="definition">mapi</span></a> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> : <span class="id" title="keyword">Type</span>)(<span class="id" title="var">f</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#elt&acute;"><span class="id" title="variable">elt&acute;</span></a>)(<span class="id" title="var">m</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#elt"><span class="id" title="variable">elt</span></a>) : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#elt&acute;"><span class="id" title="variable">elt&acute;</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a>   =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#mapi"><span class="id" title="definition">mapi</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">x</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">x</span> <span class="id" title="var">d</span>) (<a class="idref" href="Coq.FSets.FMapAVL.html#mapi"><span class="id" title="definition">mapi</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">r</span>) <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab411"></a><h1 class="section">Map with removal</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.map_option"><span class="id" title="definition">map_option</span></a> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> : <span class="id" title="keyword">Type</span>)(<span class="id" title="var">f</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#elt&acute;"><span class="id" title="variable">elt&acute;</span></a>)(<span class="id" title="var">m</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#elt"><span class="id" title="variable">elt</span></a>)<br/>
&nbsp;&nbsp;: <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#elt&acute;"><span class="id" title="variable">elt&acute;</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> <span class="id" title="var">_</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">d&acute;</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.join"><span class="id" title="definition">join</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#map_option"><span class="id" title="definition">map_option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">x</span> <span class="id" title="var">d&acute;</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#map_option"><span class="id" title="definition">map_option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.concat"><span class="id" title="definition">concat</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#map_option"><span class="id" title="definition">map_option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">l</span>) (<a class="idref" href="Coq.FSets.FMapAVL.html#map_option"><span class="id" title="definition">map_option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab412"></a><h1 class="section">Optimized map2</h1>


<div class="paragraph"> </div>

  Suggestion by B. Gregoire: a <span class="inlinecode"><span class="id" title="var">map2</span></span> function with specialized
  arguments allowing to bypass some tree traversal. Instead of one
  <span class="inlinecode"><span class="id" title="var">f0</span></span> of type <span class="inlinecode"><span class="id" title="var">key</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">option</span></span> <span class="inlinecode"><span class="id" title="var">elt</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">option</span></span> <span class="inlinecode"><span class="id" title="var">elt&acute;</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode"><span class="id" title="var">option</span></span> <span class="inlinecode"><span class="id" title="var">elt&acute;&acute;</span></span>,
  we ask here for:

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">f</span></span> which is a specialisation of <span class="inlinecode"><span class="id" title="var">f0</span></span> when first option isn't <span class="inlinecode"><span class="id" title="var">None</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">mapl</span></span> treats a <span class="inlinecode"><span class="id" title="var">tree</span></span> <span class="inlinecode"><span class="id" title="var">elt</span></span> with <span class="inlinecode"><span class="id" title="var">f0</span></span> when second option is <span class="inlinecode"><span class="id" title="var">None</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">mapr</span></span> treats a <span class="inlinecode"><span class="id" title="var">tree</span></span> <span class="inlinecode"><span class="id" title="var">elt&acute;</span></span> with <span class="inlinecode"><span class="id" title="var">f0</span></span> when first option is <span class="inlinecode"><span class="id" title="var">None</span></span>

</li>
</ul>
  The idea is that <span class="inlinecode"><span class="id" title="var">mapl</span></span> and <span class="inlinecode"><span class="id" title="var">mapr</span></span> can be instantaneous (e.g.
  the identity or some constant function).

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a name="Raw.Map2_opt"><span class="id" title="section">Map2_opt</span></a>.<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Map2_opt.elt"><span class="id" title="variable">elt</span></a> <a name="Raw.Map2_opt.elt&acute;"><span class="id" title="variable">elt&acute;</span></a> <a name="Raw.Map2_opt.elt&acute;&acute;"><span class="id" title="variable">elt&acute;&acute;</span></a> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Map2_opt.f"><span class="id" title="variable">f</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.elt&acute;"><span class="id" title="variable">elt&acute;</span></a> -&gt; <a class="idref" href="Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.elt&acute;&acute;"><span class="id" title="variable">elt&acute;&acute;</span></a>.<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Map2_opt.mapl"><span class="id" title="variable">mapl</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.elt&acute;&acute;"><span class="id" title="variable">elt&acute;&acute;</span></a>.<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Map2_opt.mapr"><span class="id" title="variable">mapr</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.elt&acute;"><span class="id" title="variable">elt&acute;</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.elt&acute;&acute;"><span class="id" title="variable">elt&acute;&acute;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Raw.map2_opt"><span class="id" title="definition">map2_opt</span></a> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m1"><span class="id" title="variable">m1</span></a>, <a class="idref" href="Coq.FSets.FMapAVL.html#m2"><span class="id" title="variable">m2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.mapr"><span class="id" title="variable">mapr</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m2"><span class="id" title="variable">m2</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.mapl"><span class="id" title="variable">mapl</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m1"><span class="id" title="variable">m1</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l1</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> <span class="id" title="var">r1</span> <span class="id" title="var">h1</span>, <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">l2&acute;</span>,<span class="id" title="var">o2</span>,<span class="id" title="var">r2&acute;</span>) := <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.split"><span class="id" title="definition">split</span></a> <span class="id" title="var">x1</span> <a class="idref" href="Coq.FSets.FMapAVL.html#m2"><span class="id" title="variable">m2</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt.f"><span class="id" title="variable">f</span></a> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> <a class="idref" href="Coq.FSets.FMapAVL.html#o2"><span class="id" title="variable">o2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <span class="id" title="var">e</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.join"><span class="id" title="definition">join</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#map2_opt"><span class="id" title="definition">map2_opt</span></a> <span class="id" title="var">l1</span> <a class="idref" href="Coq.FSets.FMapAVL.html#l2&acute;"><span class="id" title="variable">l2&acute;</span></a>) <span class="id" title="var">x1</span> <span class="id" title="var">e</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#map2_opt"><span class="id" title="definition">map2_opt</span></a> <span class="id" title="var">r1</span> <a class="idref" href="Coq.FSets.FMapAVL.html#r2&acute;"><span class="id" title="variable">r2&acute;</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.concat"><span class="id" title="definition">concat</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#map2_opt"><span class="id" title="definition">map2_opt</span></a> <span class="id" title="var">l1</span> <a class="idref" href="Coq.FSets.FMapAVL.html#l2&acute;"><span class="id" title="variable">l2&acute;</span></a>) (<a class="idref" href="Coq.FSets.FMapAVL.html#map2_opt"><span class="id" title="definition">map2_opt</span></a> <span class="id" title="var">r1</span> <a class="idref" href="Coq.FSets.FMapAVL.html#r2&acute;"><span class="id" title="variable">r2&acute;</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2_opt"><span class="id" title="section">Map2_opt</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab413"></a><h1 class="section">Map2</h1>


<div class="paragraph"> </div>

    The <span class="inlinecode"><span class="id" title="var">map2</span></span> function of the Map interface can be implemented
    via <span class="inlinecode"><span class="id" title="var">map2_opt</span></span> and <span class="inlinecode"><span class="id" title="var">map_option</span></span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a name="Raw.Map2"><span class="id" title="section">Map2</span></a>.<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Map2.elt"><span class="id" title="variable">elt</span></a> <a name="Raw.Map2.elt&acute;"><span class="id" title="variable">elt&acute;</span></a> <a name="Raw.Map2.elt&acute;&acute;"><span class="id" title="variable">elt&acute;&acute;</span></a> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Map2.f"><span class="id" title="variable">f</span></a> : <a class="idref" href="Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.elt&acute;"><span class="id" title="variable">elt&acute;</span></a> -&gt; <a class="idref" href="Coq.Init.Datatypes.html#option"><span class="id" title="inductive">option</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.elt&acute;&acute;"><span class="id" title="variable">elt&acute;&acute;</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.map2"><span class="id" title="definition">map2</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.elt"><span class="id" title="variable">elt</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.elt&acute;"><span class="id" title="variable">elt&acute;</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.elt&acute;&acute;"><span class="id" title="variable">elt&acute;&acute;</span></a> :=<br/>
&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.map2_opt"><span class="id" title="definition">map2_opt</span></a><br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span> <span class="id" title="var">o</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a>) <a class="idref" href="Coq.FSets.FMapAVL.html#o"><span class="id" title="variable">o</span></a>)<br/>
&nbsp;&nbsp;&nbsp;(<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.map_option"><span class="id" title="definition">map_option</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">d</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.f"><span class="id" title="variable">f</span></a> (<a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d"><span class="id" title="variable">d</span></a>) <a class="idref" href="Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a>))<br/>
&nbsp;&nbsp;&nbsp;(<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.map_option"><span class="id" title="definition">map_option</span></a> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> <span class="id" title="var">d&acute;</span> =&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2.f"><span class="id" title="variable">f</span></a> <a class="idref" href="Coq.Init.Datatypes.html#None"><span class="id" title="constructor">None</span></a> (<a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" title="constructor">Some</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#d&acute;"><span class="id" title="variable">d&acute;</span></a>))).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Map2"><span class="id" title="section">Map2</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab414"></a><h1 class="section">Invariants</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Section</span> <a name="Raw.Invariants"><span class="id" title="section">Invariants</span></a>.<br/>
<span class="id" title="keyword">Variable</span> <a name="Raw.Invariants.elt"><span class="id" title="variable">elt</span></a> : <span class="id" title="keyword">Type</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab415"></a><h2 class="section">Occurrence in a tree</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="Raw.MapsTo"><span class="id" title="inductive">MapsTo</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a>)(<span class="id" title="var">e</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Invariants.elt"><span class="id" title="variable">elt</span></a>) : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Invariants.elt"><span class="id" title="variable">elt</span></a> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Raw.MapsRoot"><span class="id" title="constructor">MapsRoot</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#X.eq"><span class="id" title="axiom">X.eq</span></a> <span class="id" title="var">x</span> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#MapsTo"><span class="id" title="inductive">MapsTo</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <span class="id" title="var">e</span> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#h"><span class="id" title="variable">h</span></a>)<br/>
&nbsp;&nbsp;| <a name="Raw.MapsLeft"><span class="id" title="constructor">MapsLeft</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#MapsTo"><span class="id" title="inductive">MapsTo</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#MapsTo"><span class="id" title="inductive">MapsTo</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e&acute;"><span class="id" title="variable">e&acute;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#h"><span class="id" title="variable">h</span></a>)<br/>
&nbsp;&nbsp;| <a name="Raw.MapsRight"><span class="id" title="constructor">MapsRight</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#MapsTo"><span class="id" title="inductive">MapsTo</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#MapsTo"><span class="id" title="inductive">MapsTo</span></a> <span class="id" title="var">x</span> <span class="id" title="var">e</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e&acute;"><span class="id" title="variable">e&acute;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#h"><span class="id" title="variable">h</span></a>).<br/>

<br/>
<span class="id" title="keyword">Inductive</span> <a name="Raw.In"><span class="id" title="inductive">In</span></a> (<span class="id" title="var">x</span> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.key"><span class="id" title="definition">key</span></a>) : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Invariants.elt"><span class="id" title="variable">elt</span></a> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Raw.InRoot"><span class="id" title="constructor">InRoot</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#X.eq"><span class="id" title="axiom">X.eq</span></a> <span class="id" title="var">x</span> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#In"><span class="id" title="inductive">In</span></a> <span class="id" title="var">x</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#h"><span class="id" title="variable">h</span></a>)<br/>
&nbsp;&nbsp;| <a name="Raw.InLeft"><span class="id" title="constructor">InLeft</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#In"><span class="id" title="inductive">In</span></a> <span class="id" title="var">x</span> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#In"><span class="id" title="inductive">In</span></a> <span class="id" title="var">x</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e&acute;"><span class="id" title="variable">e&acute;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#h"><span class="id" title="variable">h</span></a>)<br/>
&nbsp;&nbsp;| <a name="Raw.InRight"><span class="id" title="constructor">InRight</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#In"><span class="id" title="inductive">In</span></a> <span class="id" title="var">x</span> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#In"><span class="id" title="inductive">In</span></a> <span class="id" title="var">x</span> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e&acute;"><span class="id" title="variable">e&acute;</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#h"><span class="id" title="variable">h</span></a>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.In0"><span class="id" title="definition">In0</span></a> <span class="id" title="var">k</span> <span class="id" title="var">m</span> := <a class="idref" href="Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">exists</span></a> <span class="id" title="var">e</span>:<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Invariants.elt"><span class="id" title="variable">elt</span></a><a class="idref" href="Coq.Init.Logic.html#84eb6d2849dbf3581b1c0c05add5f2d8"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.MapsTo"><span class="id" title="inductive">MapsTo</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#k"><span class="id" title="variable">k</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab416"></a><h2 class="section">Binary search trees</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">lt_tree</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span>: all elements in <span class="inlinecode"><span class="id" title="var">s</span></span> are smaller than <span class="inlinecode"><span class="id" title="var">x</span></span>
   (resp. greater for <span class="inlinecode"><span class="id" title="var">gt_tree</span></span>) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.lt_tree"><span class="id" title="definition">lt_tree</span></a> <span class="id" title="var">x</span> <span class="id" title="var">m</span> := <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.In"><span class="id" title="inductive">In</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#X.lt"><span class="id" title="axiom">X.lt</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a>.<br/>
<span class="id" title="keyword">Definition</span> <a name="Raw.gt_tree"><span class="id" title="definition">gt_tree</span></a> <span class="id" title="var">x</span> <span class="id" title="var">m</span> := <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.In"><span class="id" title="inductive">In</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#m"><span class="id" title="variable">m</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#X.lt"><span class="id" title="axiom">X.lt</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#y"><span class="id" title="variable">y</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">bst</span></span> <span class="inlinecode"><span class="id" title="var">t</span></span> : <span class="inlinecode"><span class="id" title="var">t</span></span> is a binary search tree 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <a name="Raw.bst"><span class="id" title="inductive">bst</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.t"><span class="id" title="abbreviation">t</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Invariants.elt"><span class="id" title="variable">elt</span></a> -&gt; <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;| <a name="Raw.BSLeaf"><span class="id" title="constructor">BSLeaf</span></a> : <a class="idref" href="Coq.FSets.FMapAVL.html#bst"><span class="id" title="inductive">bst</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Leaf"><span class="id" title="constructor">Leaf</span></a> <span class="id" title="var">_</span>)<br/>
&nbsp;&nbsp;| <a name="Raw.BSNode"><span class="id" title="constructor">BSNode</span></a> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>, <a class="idref" href="Coq.FSets.FMapAVL.html#bst"><span class="id" title="inductive">bst</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#bst"><span class="id" title="inductive">bst</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.lt_tree"><span class="id" title="definition">lt_tree</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.gt_tree"><span class="id" title="definition">gt_tree</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> -&gt; <a class="idref" href="Coq.FSets.FMapAVL.html#bst"><span class="id" title="inductive">bst</span></a> (<a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Node"><span class="id" title="constructor">Node</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#e"><span class="id" title="variable">e</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#r"><span class="id" title="variable">r</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#h"><span class="id" title="variable">h</span></a>).<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Coq.FSets.FMapAVL.html#Raw.Invariants"><span class="id" title="section">Invariants</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab417"></a><h1 class="section">Correctness proofs, isolated in a sub-module</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="Raw.Proofs"><span class="id" title="module">Proofs</span></a>.<br/>
&nbsp;<span class="id" title="keyword">Module</span> <a name="Raw.Proofs.MX"><span class="id" title="module">MX</span></a> := <a class="idref" href="Coq.Structures.OrderedType.html#OrderedTypeFacts"><span class="id" title="module">OrderedTypeFacts</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#X"><span class="id" title="module">X</span></a>.<br/>
&nbsp;<span class="id" title="keyword">Module</span> <a name="Raw.Proofs.PX"><span class="id" title="module">PX</span></a> := <a class="idref" href="Coq.Structures.OrderedType.html#KeyOrderedType"><span class="id" title="module">KeyOrderedType</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#X"><span class="id" title="module">X</span></a>.<br/>
&nbsp;<span class="id" title="keyword">Module</span> <a name="Raw.Proofs.L"><span class="id" title="module">L</span></a> := <a class="idref" href="Coq.FSets.FMapList.html#Raw"><span class="id" title="module">FMapList.Raw</span></a> <a class="idref" href="Coq.FSets.FMapAVL.html#X"><span class="id" title="module">X</span></a>.<br/>

<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">mem_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">mem</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">find_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">find</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">bal_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">bal</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">add_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">add</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">remove_min_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">remove_min</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">merge_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">merge</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">remove_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">remove</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">concat_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">concat</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">split_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="tactic">split</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">map_option_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">map_option</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">map2_opt_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">map2_opt</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab418"></a><h1 class="section">Automation and dedicated tactics.</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Hint Constructors</span> <span class="id" title="var">tree</span> <span class="id" title="var">MapsTo</span> <span class="id" title="var">In</span> <span class="id" title="var">bst</span>.<br/>
<span class="id" title="keyword">Hint Unfold</span> <span class="id" title="var">lt_tree</span> <span class="id" title="var">gt_tree</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "factornode" <span class="id" title="var">ident</span>(<span class="id" title="var">l</span>) <span class="id" title="var">ident</span>(<span class="id" title="var">x</span>) <span class="id" title="var">ident</span>(<span class="id" title="var">d</span>) <span class="id" title="var">ident</span>(<span class="id" title="var">r</span>) <span class="id" title="var">ident</span>(<span class="id" title="var">h</span>)<br/>
&nbsp;"as" <span class="id" title="var">ident</span>(<span class="id" title="var">s</span>) :=<br/>
&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">s</span>:=<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) <span class="id" title="keyword">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">s</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>.<br/>

<br/>
</div>

<div class="doc">
A tactic for cleaning hypothesis after use of functional induction. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">clearf</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : (@<span class="id" title="var">Logic.eq</span> (<span class="id" title="var">Compare</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">clearf</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : (@<span class="id" title="var">Logic.eq</span> (<span class="id" title="var">sumbool</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) <span class="id" title="var">_</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">clearf</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
A tactic to repeat <span class="inlinecode"><span class="id" title="tactic">inversion_clear</span></span> on all hyps of the
    form <span class="inlinecode">(<span class="id" title="var">f</span></span> <span class="inlinecode">(<span class="id" title="var">Node</span></span> <span class="inlinecode">...))</span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="var">f</span> (<span class="id" title="var">Leaf</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="var">f</span> <span class="id" title="var">_</span> (<span class="id" title="var">Leaf</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Leaf</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Leaf</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="var">f</span> (<span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="var">f</span> <span class="id" title="var">_</span> (<span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>:<span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> (<span class="id" title="var">Node</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">inv_all</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>: <span class="id" title="var">f</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>: <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>: <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">H</span>: <span class="id" title="var">f</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">inversion_clear</span> <span class="id" title="var">H</span>; <span class="id" title="var">inv</span> <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Helper tactic concerning order of elements. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">order</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="var">U</span>: <span class="id" title="var">lt_tree</span> <span class="id" title="var">_</span> ?<span class="id" title="var">s</span>, <span class="id" title="var">V</span>: <span class="id" title="var">In</span> <span class="id" title="var">_</span> ?<span class="id" title="var">s</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">generalize</span> (<span class="id" title="var">U</span> <span class="id" title="var">_</span> <span class="id" title="var">V</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">U</span>; <span class="id" title="var">order</span><br/>
&nbsp;| <span class="id" title="var">U</span>: <span class="id" title="var">gt_tree</span> <span class="id" title="var">_</span> ?<span class="id" title="var">s</span>, <span class="id" title="var">V</span>: <span class="id" title="var">In</span> <span class="id" title="var">_</span> ?<span class="id" title="var">s</span> |- <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">generalize</span> (<span class="id" title="var">U</span> <span class="id" title="var">_</span> <span class="id" title="var">V</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">U</span>; <span class="id" title="var">order</span><br/>
&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">MX.order</span><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">intuition_in</span> := <span class="id" title="tactic">repeat</span> <span class="id" title="tactic">progress</span> (<span class="id" title="tactic">intuition</span>; <span class="id" title="var">inv</span> <span class="id" title="var">In</span>; <span class="id" title="var">inv</span> <span class="id" title="var">MapsTo</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">join_tac</span> :=<br/>
&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">ll</span> <span class="id" title="var">_</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> <span class="id" title="var">lr</span> <span class="id" title="var">Hlr</span> <span class="id" title="var">lh</span>];<br/>
&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">r</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">rl</span> <span class="id" title="var">Hrl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rd</span> <span class="id" title="var">rr</span> <span class="id" title="var">_</span> <span class="id" title="var">rh</span>]; <span class="id" title="tactic">unfold</span> <span class="id" title="var">join</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">destruct</span> (<span class="id" title="var">gt_le_dec</span> <span class="id" title="var">lh</span> (<span class="id" title="var">rh</span>+2)) <span class="id" title="keyword">as</span> [<span class="id" title="var">GT</span>|<span class="id" title="var">LE</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">bal</span> ?<span class="id" title="var">u</span> ?<span class="id" title="var">v</span> ?<span class="id" title="var">w</span> ?<span class="id" title="var">z</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">bal</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">bal</span> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> (<span class="id" title="var">join</span> <span class="id" title="var">lr</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> (<span class="id" title="var">Node</span> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rd</span> <span class="id" title="var">rr</span> <span class="id" title="var">rh</span>))); [ | <span class="id" title="tactic">auto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">destruct</span> (<span class="id" title="var">gt_le_dec</span> <span class="id" title="var">rh</span> (<span class="id" title="var">lh</span>+2)) <span class="id" title="keyword">as</span> [<span class="id" title="var">GT&acute;</span>|<span class="id" title="var">LE&acute;</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="keyword">context</span> [ <span class="id" title="var">bal</span> ?<span class="id" title="var">u</span> ?<span class="id" title="var">v</span> ?<span class="id" title="var">w</span> ?<span class="id" title="var">z</span> ] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">bal</span> <span class="id" title="var">u</span> <span class="id" title="var">v</span> <span class="id" title="var">w</span> <span class="id" title="var">z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">bal</span> (<span class="id" title="var">join</span> (<span class="id" title="var">Node</span> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">ld</span> <span class="id" title="var">lr</span> <span class="id" title="var">lh</span>) <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">rl</span>) <span class="id" title="var">rx</span> <span class="id" title="var">rd</span> <span class="id" title="var">rr</span>); [ | <span class="id" title="tactic">auto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ] ] ] ]; <span class="id" title="tactic">intros</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Elt</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">elt</span>:<span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">m</span> <span class="id" title="var">r</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab419"></a><h1 class="section">Basic results about <span class="inlinecode"><span class="id" title="var">MapsTo</span></span>, <span class="inlinecode"><span class="id" title="var">In</span></span>, <span class="inlinecode"><span class="id" title="var">lt_tree</span></span>, <span class="inlinecode"><span class="id" title="var">gt_tree</span></span>, <span class="inlinecode"><span class="id" title="var">height</span></span></h1>

<div class="paragraph"> </div>

 Facts about <span class="inlinecode"><span class="id" title="var">MapsTo</span></span> and <span class="inlinecode"><span class="id" title="var">In</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MapsTo_In</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>, <span class="id" title="var">MapsTo</span> <span class="id" title="var">k</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">MapsTo_In</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">In_MapsTo</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span>, <span class="id" title="var">In</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">e</span>, <span class="id" title="var">MapsTo</span> <span class="id" title="var">k</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">In_alt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span>, <span class="id" title="var">In0</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span> &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MapsTo_1</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>
<span class="id" title="keyword">Hint Immediate</span> <span class="id" title="var">MapsTo_1</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">In_1</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">In_node_iff</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> \/ <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span>.<br/>

<br/>
</div>

<div class="doc">
Results about <span class="inlinecode"><span class="id" title="var">lt_tree</span></span> and <span class="inlinecode"><span class="id" title="var">gt_tree</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_leaf</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="var">Leaf</span> <span class="id" title="var">elt</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gt_leaf</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="var">Leaf</span> <span class="id" title="var">elt</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_tree_node</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">X.lt</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gt_tree_node</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">X.lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>).<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">lt_leaf</span> <span class="id" title="var">gt_leaf</span> <span class="id" title="var">lt_tree_node</span> <span class="id" title="var">gt_tree_node</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_left</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_right</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gt_left</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gt_right</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">lt_left</span> <span class="id" title="var">lt_right</span> <span class="id" title="var">gt_left</span> <span class="id" title="var">gt_right</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_tree_not_in</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>, <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> -&gt; ~ <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_tree_trans</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">X.lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gt_tree_not_in</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>, <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> -&gt; ~ <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">gt_tree_trans</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">X.lt</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">lt_tree_not_in</span> <span class="id" title="var">lt_tree_trans</span> <span class="id" title="var">gt_tree_not_in</span> <span class="id" title="var">gt_tree_trans</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab420"></a><h1 class="section">Empty map</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Empty</span> <span class="id" title="var">m</span> := <span class="id" title="keyword">forall</span> (<span class="id" title="var">a</span>:<span class="id" title="var">key</span>)(<span class="id" title="var">e</span>:<span class="id" title="var">elt</span>) , ~ <span class="id" title="var">MapsTo</span> <span class="id" title="var">a</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_bst</span> : <span class="id" title="var">bst</span> (<span class="id" title="var">empty</span> <span class="id" title="var">elt</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_1</span> : <span class="id" title="var">Empty</span> (<span class="id" title="var">empty</span> <span class="id" title="var">elt</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab421"></a><h1 class="section">Emptyness test</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_empty_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">Empty</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">is_empty</span> <span class="id" title="var">m</span> = <span class="id" title="var">true</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_empty_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">is_empty</span> <span class="id" title="var">m</span> = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">Empty</span> <span class="id" title="var">m</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab422"></a><h1 class="section">Membership</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mem_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">mem</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">true</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mem_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">mem</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">Some</span> <span class="id" title="var">e</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>, <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">Some</span> <span class="id" title="var">e</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_iff</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">Some</span> <span class="id" title="var">e</span> &lt;-&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> &lt;&gt; <span class="id" title="var">None</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">in_find</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> &lt;&gt; <span class="id" title="var">None</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_in_iff</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> &lt;&gt; <span class="id" title="var">None</span> &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">not_find_iff</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">None</span> &lt;-&gt; ~<span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_find</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">x</span>,<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span> &lt;-&gt;<br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">d</span>, <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">Some</span> <span class="id" title="var">d</span> &lt;-&gt; <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span> = <span class="id" title="var">Some</span> <span class="id" title="var">d</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_mapsto_equiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span> &lt;-&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">d</span>, <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">m</span> &lt;-&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">m&acute;</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_in_equiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab423"></a><h1 class="section">Helper functions</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">create_bst</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>, <span class="id" title="var">bst</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> -&gt;<br/>
&nbsp;<span class="id" title="var">bst</span> (<span class="id" title="var">create</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">create_bst</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">create_in</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">create</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bal_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>, <span class="id" title="var">bst</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">r</span> -&gt;<br/>
&nbsp;<span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">bal</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">bal_bst</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bal_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">bal</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bal_mapsto</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span>,<br/>
&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span> (<span class="id" title="var">bal</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>) &lt;-&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span> (<span class="id" title="var">create</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bal_find</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">bal</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>) = <span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">create</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab424"></a><h1 class="section">Insertion</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>,<br/>
&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">add_bst</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span>, ~<span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt;<br/>
&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e&acute;</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span>, ~<span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt;<br/>
&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e&acute;</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_find</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">X.compare</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span> <span class="id" title="var">EQ</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">e</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab425"></a><h1 class="section">Extraction of minimum binding</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#2#1 \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_mapsto</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;&nbsp;((<span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#2#1) /\ <span class="id" title="var">e&acute;</span> = (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#2#2)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;\/ <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e&acute;</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">bst</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#1.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">remove_min_bst</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_gt_tree</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">bst</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) -&gt;<br/>
&nbsp;<span class="id" title="var">gt_tree</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#2#1 (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#1.<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">remove_min_gt_tree</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_find</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">bst</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) =<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">X.compare</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#2#1 <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">LT</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">EQ</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Some</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#2#2<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">GT</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">r</span>)#1<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab426"></a><h1 class="section">Merging two trees</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">merge_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m2</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">merge</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m1</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">merge_mapsto</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m2</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">merge</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>) &lt;-&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m1</span> \/ <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">merge_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m2</span> -&gt;<br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span> : <span class="id" title="var">key</span>, <span class="id" title="var">In</span> <span class="id" title="var">y1</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">y2</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">X.lt</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>) -&gt;<br/>
&nbsp;<span class="id" title="var">bst</span> (<span class="id" title="var">merge</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab427"></a><h1 class="section">Deletion</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>) &lt;-&gt; ~ <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> /\ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; ~ <span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; ~<span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt;<br/>
&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab428"></a><h1 class="section">join</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">join_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">join</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">join_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span>, <span class="id" title="var">bst</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">r</span> -&gt;<br/>
&nbsp;<span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">join</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">join_bst</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">join_find</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">r</span> -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">join</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span>) = <span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">create</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab429"></a><h1 class="section">split</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_in_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>,<br/>
&nbsp;(<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">l</span> &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> /\ <span class="id" title="var">X.lt</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_in_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>,<br/>
&nbsp;(<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">r</span> &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> /\ <span class="id" title="var">X.lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_in_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;(<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">o</span> = <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;<span class="id" title="var">bst</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">l</span> /\ <span class="id" title="var">bst</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_lt_tree</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">l</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_gt_tree</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_find</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> = <span class="id" title="keyword">match</span> <span class="id" title="var">X.compare</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">LT</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">EQ</span> <span class="id" title="var">_</span> =&gt; (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">o</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">GT</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>)#<span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab430"></a><h1 class="section">Concatenation</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">concat_in</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">concat</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m1</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m2</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">concat_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m2</span> -&gt;<br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>, <span class="id" title="var">In</span> <span class="id" title="var">y1</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">y2</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">X.lt</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>) -&gt;<br/>
&nbsp;<span class="id" title="var">bst</span> (<span class="id" title="var">concat</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">concat_bst</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">concat_find</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m2</span> -&gt;<br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>, <span class="id" title="var">In</span> <span class="id" title="var">y1</span> <span class="id" title="var">m1</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">y2</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">X.lt</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>) -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">concat</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m2</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Some</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">d</span> | <span class="id" title="var">None</span> =&gt; <span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m1</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab431"></a><h1 class="section">Elements</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">eqk</span> := (<span class="id" title="var">PX.eqk</span> (<span class="id" title="var">elt</span>:= <span class="id" title="var">elt</span>)).<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">eqke</span> := (<span class="id" title="var">PX.eqke</span> (<span class="id" title="var">elt</span>:= <span class="id" title="var">elt</span>)).<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">ltk</span> := (<span class="id" title="var">PX.ltk</span> (<span class="id" title="var">elt</span>:= <span class="id" title="var">elt</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_aux_mapsto</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">acc</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>,<br/>
&nbsp;<span class="id" title="var">InA</span> <span class="id" title="var">eqke</span> (<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) (<span class="id" title="var">elements_aux</span> <span class="id" title="var">acc</span> <span class="id" title="var">s</span>) &lt;-&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">s</span> \/ <span class="id" title="var">InA</span> <span class="id" title="var">eqke</span> (<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) <span class="id" title="var">acc</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_mapsto</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">x</span> <span class="id" title="var">e</span>, <span class="id" title="var">InA</span> <span class="id" title="var">eqke</span> (<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">s</span>) &lt;-&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_in</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">x</span>, <span class="id" title="var">L.PX.In</span> <span class="id" title="var">x</span> (<span class="id" title="var">elements</span> <span class="id" title="var">s</span>) &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_aux_sort</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">acc</span>, <span class="id" title="var">bst</span> <span class="id" title="var">s</span> -&gt; <span class="id" title="var">sort</span> <span class="id" title="var">ltk</span> <span class="id" title="var">acc</span> -&gt;<br/>
&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">y</span>, <span class="id" title="var">InA</span> <span class="id" title="var">eqke</span> (<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) <span class="id" title="var">acc</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">s</span> -&gt; <span class="id" title="var">X.lt</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>) -&gt;<br/>
&nbsp;<span class="id" title="var">sort</span> <span class="id" title="var">ltk</span> (<span class="id" title="var">elements_aux</span> <span class="id" title="var">acc</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_sort</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span>, <span class="id" title="var">bst</span> <span class="id" title="var">s</span> -&gt; <span class="id" title="var">sort</span> <span class="id" title="var">ltk</span> (<span class="id" title="var">elements</span> <span class="id" title="var">s</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">elements_sort</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_nodup</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span>, <span class="id" title="var">bst</span> <span class="id" title="var">s</span> -&gt; <span class="id" title="var">NoDupA</span> <span class="id" title="var">eqk</span> (<span class="id" title="var">elements</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_aux_cardinal</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">acc</span>, (<span class="id" title="var">length</span> <span class="id" title="var">acc</span> + <span class="id" title="var">cardinal</span> <span class="id" title="var">m</span>)%<span class="id" title="var">nat</span> = <span class="id" title="var">length</span> (<span class="id" title="var">elements_aux</span> <span class="id" title="var">acc</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_cardinal</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>), <span class="id" title="var">cardinal</span> <span class="id" title="var">m</span> = <span class="id" title="var">length</span> (<span class="id" title="var">elements</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_app</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">acc</span>, <span class="id" title="var">elements_aux</span> <span class="id" title="var">acc</span> <span class="id" title="var">s</span> = <span class="id" title="var">elements</span> <span class="id" title="var">s</span> ++ <span class="id" title="var">acc</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_node</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">t1</span> <span class="id" title="var">t2</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">z</span> <span class="id" title="var">l</span>,<br/>
&nbsp;<span class="id" title="var">elements</span> <span class="id" title="var">t1</span> ++ (<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) :: <span class="id" title="var">elements</span> <span class="id" title="var">t2</span> ++ <span class="id" title="var">l</span> =<br/>
&nbsp;<span class="id" title="var">elements</span> (<span class="id" title="var">Node</span> <span class="id" title="var">t1</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">t2</span> <span class="id" title="var">z</span>) ++ <span class="id" title="var">l</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab432"></a><h1 class="section">Fold</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">fold&acute;</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>)(<span class="id" title="var">s</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">L.fold</span> <span class="id" title="var">f</span> (<span class="id" title="var">elements</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fold_equiv_aux</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>) <span class="id" title="var">acc</span>,<br/>
&nbsp;<span class="id" title="var">L.fold</span> <span class="id" title="var">f</span> (<span class="id" title="var">elements_aux</span> <span class="id" title="var">acc</span> <span class="id" title="var">s</span>) <span class="id" title="var">a</span> = <span class="id" title="var">L.fold</span> <span class="id" title="var">f</span> <span class="id" title="var">acc</span> (<span class="id" title="tactic">fold</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fold_equiv</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">s</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) (<span class="id" title="var">a</span> : <span class="id" title="var">A</span>),<br/>
&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span> <span class="id" title="var">a</span> = <span class="id" title="var">fold&acute;</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fold_1</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">Hs</span>:<span class="id" title="var">bst</span> <span class="id" title="var">s</span>)(<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>)(<span class="id" title="var">i</span>:<span class="id" title="var">A</span>)(<span class="id" title="var">f</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>),<br/>
&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span> <span class="id" title="var">i</span> = <span class="id" title="var">fold_left</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">p</span>#1 <span class="id" title="var">p</span>#2 <span class="id" title="var">a</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">s</span>) <span class="id" title="var">i</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab433"></a><h1 class="section">Comparison</h1>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">flatten_e</span></span> <span class="inlinecode"><span class="id" title="var">e</span></span> returns the list of elements of the enumeration <span class="inlinecode"><span class="id" title="var">e</span></span>
    i.e. the list of elements actually compared 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">flatten_e</span> (<span class="id" title="var">e</span> : <span class="id" title="var">enumeration</span> <span class="id" title="var">elt</span>) : <span class="id" title="var">list</span> (<span class="id" title="var">key</span>*<span class="id" title="var">elt</span>) := <span class="id" title="keyword">match</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="keyword">End</span> =&gt; <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">More</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">t</span> <span class="id" title="var">r</span> =&gt; (<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) :: <span class="id" title="var">elements</span> <span class="id" title="var">t</span> ++ <span class="id" title="var">flatten_e</span> <span class="id" title="var">r</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">flatten_e_elements</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">r</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">z</span> <span class="id" title="var">e</span>,<br/>
&nbsp;<span class="id" title="var">elements</span> <span class="id" title="var">l</span> ++ <span class="id" title="var">flatten_e</span> (<span class="id" title="var">More</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">e</span>) =<br/>
&nbsp;<span class="id" title="var">elements</span> (<span class="id" title="var">Node</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">r</span> <span class="id" title="var">z</span>) ++ <span class="id" title="var">flatten_e</span> <span class="id" title="var">e</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">cons_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>) <span class="id" title="var">e</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">flatten_e</span> (<span class="id" title="var">cons</span> <span class="id" title="var">s</span> <span class="id" title="var">e</span>) = <span class="id" title="var">elements</span> <span class="id" title="var">s</span> ++ <span class="id" title="var">flatten_e</span> <span class="id" title="var">e</span>.<br/>

<br/>
</div>

<div class="doc">
Proof of correction for the comparison 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">cmp</span> : <span class="id" title="var">elt</span>-&gt;<span class="id" title="var">elt</span>-&gt;<span class="id" title="var">bool</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">IfEq</span> <span class="id" title="var">b</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> := <span class="id" title="var">L.equal</span> <span class="id" title="var">cmp</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> = <span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">cons_IfEq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">b</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">X.eq</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> -&gt; <span class="id" title="var">cmp</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span> = <span class="id" title="var">true</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">IfEq</span> <span class="id" title="var">b</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">IfEq</span> <span class="id" title="var">b</span> ((<span class="id" title="var">x1</span>,<span class="id" title="var">d1</span>)::<span class="id" title="var">l1</span>) ((<span class="id" title="var">x2</span>,<span class="id" title="var">d2</span>)::<span class="id" title="var">l2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_end_IfEq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">e2</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">IfEq</span> (<span class="id" title="var">equal_end</span> <span class="id" title="var">e2</span>) <span class="id" title="var">nil</span> (<span class="id" title="var">flatten_e</span> <span class="id" title="var">e2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_more_IfEq</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> (<span class="id" title="var">cont</span>:<span class="id" title="var">enumeration</span> <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">bool</span>) <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">IfEq</span> (<span class="id" title="var">cont</span> (<span class="id" title="var">cons</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span>)) <span class="id" title="var">l</span> (<span class="id" title="var">elements</span> <span class="id" title="var">r2</span> ++ <span class="id" title="var">flatten_e</span> <span class="id" title="var">e2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">IfEq</span> (<span class="id" title="var">equal_more</span> <span class="id" title="var">cmp</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> <span class="id" title="var">cont</span> (<span class="id" title="var">More</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span>)) ((<span class="id" title="var">x1</span>,<span class="id" title="var">d1</span>)::<span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">flatten_e</span> (<span class="id" title="var">More</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_cont_IfEq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">cont</span> <span class="id" title="var">e2</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">IfEq</span> (<span class="id" title="var">cont</span> <span class="id" title="var">e</span>) <span class="id" title="var">l</span> (<span class="id" title="var">flatten_e</span> <span class="id" title="var">e</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">IfEq</span> (<span class="id" title="var">equal_cont</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m1</span> <span class="id" title="var">cont</span> <span class="id" title="var">e2</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">m1</span> ++ <span class="id" title="var">l</span>) (<span class="id" title="var">flatten_e</span> <span class="id" title="var">e2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_IfEq</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>),<br/>
&nbsp;&nbsp;<span class="id" title="var">IfEq</span> (<span class="id" title="var">equal</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">m1</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">m2</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Equivb</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">k</span>, <span class="id" title="var">In</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span> &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">k</span> <span class="id" title="var">m&acute;</span>) /\<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span>, <span class="id" title="var">MapsTo</span> <span class="id" title="var">k</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">k</span> <span class="id" title="var">e&acute;</span> <span class="id" title="var">m&acute;</span> -&gt; <span class="id" title="var">cmp</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span> = <span class="id" title="var">true</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Equivb_elements</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">s&acute;</span>,<br/>
&nbsp;<span class="id" title="var">Equivb</span> <span class="id" title="var">s</span> <span class="id" title="var">s&acute;</span> &lt;-&gt; <span class="id" title="var">L.Equivb</span> <span class="id" title="var">cmp</span> (<span class="id" title="var">elements</span> <span class="id" title="var">s</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">s&acute;</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_Equivb</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">s</span> <span class="id" title="var">s&acute;</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>), <span class="id" title="var">bst</span> <span class="id" title="var">s</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">s&acute;</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="var">equal</span> <span class="id" title="var">cmp</span> <span class="id" title="var">s</span> <span class="id" title="var">s&acute;</span> = <span class="id" title="var">true</span> &lt;-&gt; <span class="id" title="var">Equivb</span> <span class="id" title="var">s</span> <span class="id" title="var">s&acute;</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Elt</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Map</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">f</span> : <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">elt&acute;</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>)(<span class="id" title="var">e</span>:<span class="id" title="var">elt</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> (<span class="id" title="var">f</span> <span class="id" title="var">e</span>) (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_2</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Map</span>.<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Mapi</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">f</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">elt&acute;</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mapi_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span>: <span class="id" title="var">tree</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>)(<span class="id" title="var">e</span>:<span class="id" title="var">elt</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">y</span>, <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> /\ <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> (<span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>) (<span class="id" title="var">mapi</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mapi_2</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">mapi</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mapi_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">mapi</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Mapi</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Map_option</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">f</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">option</span> <span class="id" title="var">elt&acute;</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">f_compat</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">x&acute;</span> <span class="id" title="var">d</span>, <span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">x&acute;</span> -&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> = <span class="id" title="var">f</span> <span class="id" title="var">x&acute;</span> <span class="id" title="var">d</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_option_2</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>),<br/>
&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">map_option</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">d</span>, <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">m</span> /\ <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> &lt;&gt; <span class="id" title="var">None</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_option_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">map_option</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">map_option_bst</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">nonify</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">e</span> <span class="id" title="keyword">with</span> (@<span class="id" title="var">None</span> <span class="id" title="var">elt</span>) <span class="id" title="tactic">by</span><br/>
&nbsp;&nbsp;(<span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">not_find_iff</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">intro</span>; <span class="id" title="var">order</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_option_find</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>),<br/>
&nbsp;<span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">x</span> (<span class="id" title="var">map_option</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>) <span class="id" title="keyword">with</span> <span class="id" title="var">Some</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> | <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Map_option</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Map2_opt</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> <span class="id" title="var">elt&acute;&acute;</span> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">f0</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">option</span> <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">option</span> <span class="id" title="var">elt&acute;</span> -&gt; <span class="id" title="var">option</span> <span class="id" title="var">elt&acute;&acute;</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">f</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">option</span> <span class="id" title="var">elt&acute;</span> -&gt; <span class="id" title="var">option</span> <span class="id" title="var">elt&acute;&acute;</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">mapl</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">t</span> <span class="id" title="var">elt&acute;&acute;</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">mapr</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt&acute;</span> -&gt; <span class="id" title="var">t</span> <span class="id" title="var">elt&acute;&acute;</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">f0_f</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">o</span>, <span class="id" title="var">f</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span> <span class="id" title="var">o</span> = <span class="id" title="var">f0</span> <span class="id" title="var">x</span> (<span class="id" title="var">Some</span> <span class="id" title="var">d</span>) <span class="id" title="var">o</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">mapl_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">mapl</span> <span class="id" title="var">m</span>).<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">mapr_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m&acute;</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">mapr</span> <span class="id" title="var">m&acute;</span>).<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">mapl_f0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">x</span> (<span class="id" title="var">mapl</span> <span class="id" title="var">m</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Some</span> <span class="id" title="var">d</span> =&gt; <span class="id" title="var">f0</span> <span class="id" title="var">x</span> (<span class="id" title="var">Some</span> <span class="id" title="var">d</span>) <span class="id" title="var">None</span> | <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">mapr_f0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">x</span> (<span class="id" title="var">mapr</span> <span class="id" title="var">m&acute;</span>) =<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Some</span> <span class="id" title="var">d&acute;</span> =&gt; <span class="id" title="var">f0</span> <span class="id" title="var">x</span> <span class="id" title="var">None</span> (<span class="id" title="var">Some</span> <span class="id" title="var">d&acute;</span>) | <span class="id" title="var">None</span> =&gt; <span class="id" title="var">None</span> <span class="id" title="keyword">end</span>.<br/>
<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">f0_compat</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">x&acute;</span> <span class="id" title="var">o</span> <span class="id" title="var">o&acute;</span>, <span class="id" title="var">X.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">x&acute;</span> -&gt; <span class="id" title="var">f0</span> <span class="id" title="var">x</span> <span class="id" title="var">o</span> <span class="id" title="var">o&acute;</span> = <span class="id" title="var">f0</span> <span class="id" title="var">x&acute;</span> <span class="id" title="var">o</span> <span class="id" title="var">o&acute;</span>.<br/>

<br/>
<span class="id" title="keyword">Notation</span> <span class="id" title="var">map2_opt</span> := (<span class="id" title="var">map2_opt</span> <span class="id" title="var">f</span> <span class="id" title="var">mapl</span> <span class="id" title="var">mapr</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_opt_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">map2_opt</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>) -&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m&acute;</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_opt_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;<span class="id" title="var">bst</span> (<span class="id" title="var">map2_opt</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>).<br/>
<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">map2_opt_bst</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">map2_aux</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="var">In</span> ?<span class="id" title="var">x</span> <span class="id" title="var">_</span> \/ <span class="id" title="var">In</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">H&acute;</span> : <span class="id" title="var">find</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m</span> = <span class="id" title="var">find</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">m&acute;</span>, <span class="id" title="var">B</span>:<span class="id" title="var">bst</span> ?<span class="id" title="var">m</span>, <span class="id" title="var">B&acute;</span>:<span class="id" title="var">bst</span> ?<span class="id" title="var">m&acute;</span> |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> <span class="id" title="var">H</span>; [ <span class="id" title="var">intuition_in</span>; <span class="id" title="var">order</span> |<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">rewrite</span> &lt;-(<span class="id" title="var">find_in_equiv</span> <span class="id" title="var">B</span> <span class="id" title="var">B&acute;</span> <span class="id" title="var">H&acute;</span>); <span class="id" title="tactic">auto</span> ]<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">nonify</span> <span class="id" title="var">t</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">find</span> ?<span class="id" title="var">y</span> (<span class="id" title="var">map2_opt</span> ?<span class="id" title="var">m</span> ?<span class="id" title="var">m&acute;</span>)) =&gt;<br/>
&nbsp;<span class="id" title="tactic">replace</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span> (@<span class="id" title="var">None</span> <span class="id" title="var">elt&acute;&acute;</span>);<br/>
&nbsp;[ | <span class="id" title="tactic">symmetry</span>; <span class="id" title="tactic">rewrite</span> <span class="id" title="var">not_find_iff</span>; <span class="id" title="tactic">auto</span>; <span class="id" title="tactic">intro</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">destruct</span> (@<span class="id" title="var">map2_opt_2</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">y</span>); <span class="id" title="tactic">auto</span>; <span class="id" title="var">order</span> ]<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_opt_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">map2_opt</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>) = <span class="id" title="var">f0</span> <span class="id" title="var">y</span> (<span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span>) (<span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m&acute;</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Map2_opt</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Map2</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> <span class="id" title="var">elt&acute;&acute;</span> : <span class="id" title="keyword">Type</span>.<br/>
<span class="id" title="keyword">Variable</span> <span class="id" title="var">f</span> : <span class="id" title="var">option</span> <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">option</span> <span class="id" title="var">elt&acute;</span> -&gt; <span class="id" title="var">option</span> <span class="id" title="var">elt&acute;&acute;</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_bst</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt; <span class="id" title="var">bst</span> (<span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m&acute;</span> -&gt; <span class="id" title="var">find</span> <span class="id" title="var">y</span> (<span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>) = <span class="id" title="var">f</span> (<span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span>) (<span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m&acute;</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">y</span>, <span class="id" title="var">bst</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">bst</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>) -&gt; <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">y</span> <span class="id" title="var">m&acute;</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Map2</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Proofs</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Raw</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab434"></a><h1 class="section">Encapsulation</h1>


<div class="paragraph"> </div>

   Now, in order to really provide a functor implementing <span class="inlinecode"><span class="id" title="var">S</span></span>, we
   need to encapsulate everything into a type of balanced binary search trees. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">IntMake</span> (<span class="id" title="var">I</span>:<span class="id" title="var">Int</span>)(<span class="id" title="var">X</span>: <span class="id" title="var">OrderedType</span>) &lt;: <span class="id" title="var">S</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Module</span> <span class="id" title="var">E</span> := <span class="id" title="var">X</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">E</span> := <span class="id" title="var">X</span>.<br/>
&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">Raw</span> := <span class="id" title="var">Raw</span> <span class="id" title="var">I</span> <span class="id" title="var">X</span>.<br/>
&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">Raw.Proofs</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">bst</span> (<span class="id" title="var">elt</span>:<span class="id" title="keyword">Type</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Bst</span> {<span class="id" title="var">this</span> :&gt; <span class="id" title="var">Raw.tree</span> <span class="id" title="var">elt</span>; <span class="id" title="var">is_bst</span> : <span class="id" title="var">Raw.bst</span> <span class="id" title="var">this</span>}.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">t</span> := <span class="id" title="var">bst</span>.<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">key</span> := <span class="id" title="var">E.t</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">Elt</span>.<br/>
&nbsp;<span class="id" title="keyword">Variable</span> <span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> <span class="id" title="var">elt&acute;&acute;</span>: <span class="id" title="keyword">Type</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">m</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span>.<br/>
&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : <span class="id" title="var">key</span>.<br/>
&nbsp;<span class="id" title="keyword">Implicit</span> <span class="id" title="keyword">Types</span> <span class="id" title="var">e</span> : <span class="id" title="var">elt</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">empty</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span> := <span class="id" title="var">Bst</span> (<span class="id" title="var">empty_bst</span> <span class="id" title="var">elt</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">is_empty</span> <span class="id" title="var">m</span> : <span class="id" title="var">bool</span> := <span class="id" title="var">Raw.is_empty</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span> := <span class="id" title="var">Bst</span> (<span class="id" title="var">add_bst</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.(<span class="id" title="var">is_bst</span>)).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt</span> := <span class="id" title="var">Bst</span> (<span class="id" title="var">remove_bst</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.(<span class="id" title="var">is_bst</span>)).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">mem</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> : <span class="id" title="var">bool</span> := <span class="id" title="var">Raw.mem</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> : <span class="id" title="var">option</span> <span class="id" title="var">elt</span> := <span class="id" title="var">Raw.find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt&acute;</span> := <span class="id" title="var">Bst</span> (<span class="id" title="var">map_bst</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>.(<span class="id" title="var">is_bst</span>)).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">mapi</span> (<span class="id" title="var">f</span>:<span class="id" title="var">key</span>-&gt;<span class="id" title="var">elt</span>-&gt;<span class="id" title="var">elt&acute;</span>) <span class="id" title="var">m</span> : <span class="id" title="var">t</span> <span class="id" title="var">elt&acute;</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Bst</span> (<span class="id" title="var">mapi_bst</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>.(<span class="id" title="var">is_bst</span>)).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> (<span class="id" title="var">m&acute;</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt&acute;</span>) : <span class="id" title="var">t</span> <span class="id" title="var">elt&acute;&acute;</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">Bst</span> (<span class="id" title="var">map2_bst</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>.(<span class="id" title="var">is_bst</span>) <span class="id" title="var">m&acute;</span>.(<span class="id" title="var">is_bst</span>)).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">elements</span> <span class="id" title="var">m</span> : <span class="id" title="var">list</span> (<span class="id" title="var">key</span>*<span class="id" title="var">elt</span>) := <span class="id" title="var">Raw.elements</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">cardinal</span> <span class="id" title="var">m</span> := <span class="id" title="var">Raw.cardinal</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="tactic">fold</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">f</span>:<span class="id" title="var">key</span>-&gt;<span class="id" title="var">elt</span>-&gt;<span class="id" title="var">A</span>-&gt;<span class="id" title="var">A</span>) <span class="id" title="var">m</span> <span class="id" title="var">i</span> := <span class="id" title="var">Raw.fold</span> (<span class="id" title="var">A</span>:=<span class="id" title="var">A</span>) <span class="id" title="var">f</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>) <span class="id" title="var">i</span>.<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">equal</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> : <span class="id" title="var">bool</span> := <span class="id" title="var">Raw.equal</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>) <span class="id" title="var">m&acute;</span>.(<span class="id" title="var">this</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> : <span class="id" title="keyword">Prop</span> := <span class="id" title="var">Raw.MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> : <span class="id" title="keyword">Prop</span> := <span class="id" title="var">Raw.In0</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Empty</span> <span class="id" title="var">m</span> : <span class="id" title="keyword">Prop</span> := <span class="id" title="var">Empty</span> <span class="id" title="var">m</span>.(<span class="id" title="var">this</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_key</span> : (<span class="id" title="var">key</span>*<span class="id" title="var">elt</span>) -&gt; (<span class="id" title="var">key</span>*<span class="id" title="var">elt</span>) -&gt; <span class="id" title="keyword">Prop</span> := @<span class="id" title="var">PX.eqk</span> <span class="id" title="var">elt</span>.<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq_key_elt</span> : (<span class="id" title="var">key</span>*<span class="id" title="var">elt</span>) -&gt; (<span class="id" title="var">key</span>*<span class="id" title="var">elt</span>) -&gt; <span class="id" title="keyword">Prop</span> := @<span class="id" title="var">PX.eqke</span> <span class="id" title="var">elt</span>.<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt_key</span> : (<span class="id" title="var">key</span>*<span class="id" title="var">elt</span>) -&gt; (<span class="id" title="var">key</span>*<span class="id" title="var">elt</span>) -&gt; <span class="id" title="keyword">Prop</span> := @<span class="id" title="var">PX.ltk</span> <span class="id" title="var">elt</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">MapsTo_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">E.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mem_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">mem</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">true</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mem_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span>, <span class="id" title="var">mem</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">empty_1</span> : <span class="id" title="var">Empty</span> <span class="id" title="var">empty</span>.<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_empty_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">Empty</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">is_empty</span> <span class="id" title="var">m</span> = <span class="id" title="var">true</span>.<br/>
 &nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">is_empty_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">is_empty</span> <span class="id" title="var">m</span> = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">Empty</span> <span class="id" title="var">m</span>.<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">E.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>).<br/>
 &nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span>, ~ <span class="id" title="var">E.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e&acute;</span> <span class="id" title="var">m</span>).<br/>
 &nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span>, ~ <span class="id" title="var">E.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">e&acute;</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">E.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; ~ <span class="id" title="var">In</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>).<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, ~ <span class="id" title="var">E.eq</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>).<br/>
 &nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>, <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>, <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">Some</span> <span class="id" title="var">e</span>.<br/>
 &nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">find_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>, <span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> = <span class="id" title="var">Some</span> <span class="id" title="var">e</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">fold_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> (<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>) (<span class="id" title="var">i</span> : <span class="id" title="var">A</span>) (<span class="id" title="var">f</span> : <span class="id" title="var">key</span> -&gt; <span class="id" title="var">elt</span> -&gt; <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">fold</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> <span class="id" title="var">i</span> = <span class="id" title="var">fold_left</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">f</span> (<span class="id" title="var">fst</span> <span class="id" title="var">p</span>) (<span class="id" title="var">snd</span> <span class="id" title="var">p</span>) <span class="id" title="var">a</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">m</span>) <span class="id" title="var">i</span>.<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">InA</span> <span class="id" title="var">eq_key_elt</span> (<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">m</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">InA</span> <span class="id" title="var">eq_key_elt</span> (<span class="id" title="var">x</span>,<span class="id" title="var">e</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">sort</span> <span class="id" title="var">lt_key</span> (<span class="id" title="var">elements</span> <span class="id" title="var">m</span>).<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">elements_3w</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">NoDupA</span> <span class="id" title="var">eq_key</span> (<span class="id" title="var">elements</span> <span class="id" title="var">m</span>).<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">cardinal_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span>, <span class="id" title="var">cardinal</span> <span class="id" title="var">m</span> = <span class="id" title="var">length</span> (<span class="id" title="var">elements</span> <span class="id" title="var">m</span>).<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Equal</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> := <span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m</span> = <span class="id" title="var">find</span> <span class="id" title="var">y</span> <span class="id" title="var">m&acute;</span>.<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Equiv</span> (<span class="id" title="var">eq_elt</span>:<span class="id" title="var">elt</span>-&gt;<span class="id" title="var">elt</span>-&gt;<span class="id" title="keyword">Prop</span>) <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> :=<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">k</span>, <span class="id" title="var">In</span> <span class="id" title="var">k</span> <span class="id" title="var">m</span> &lt;-&gt; <span class="id" title="var">In</span> <span class="id" title="var">k</span> <span class="id" title="var">m&acute;</span>) /\<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span>, <span class="id" title="var">MapsTo</span> <span class="id" title="var">k</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">k</span> <span class="id" title="var">e&acute;</span> <span class="id" title="var">m&acute;</span> -&gt; <span class="id" title="var">eq_elt</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span>).<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Equivb</span> <span class="id" title="var">cmp</span> := <span class="id" title="var">Equiv</span> (<span class="id" title="var">Cmp</span> <span class="id" title="var">cmp</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Equivb_Equivb</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Equivb</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> &lt;-&gt; <span class="id" title="var">Raw.Proofs.Equivb</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">cmp</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Equivb</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> -&gt; <span class="id" title="var">equal</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> = <span class="id" title="var">true</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">equal_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> <span class="id" title="var">cmp</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">equal</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">Equivb</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Elt</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">m</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>)(<span class="id" title="var">e</span>:<span class="id" title="var">elt</span>)(<span class="id" title="var">f</span>:<span class="id" title="var">elt</span>-&gt;<span class="id" title="var">elt&acute;</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt; <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> (<span class="id" title="var">f</span> <span class="id" title="var">e</span>) (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>).<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map_2</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">m</span>:<span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>)(<span class="id" title="var">f</span>:<span class="id" title="var">elt</span>-&gt;<span class="id" title="var">elt&acute;</span>), <span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">map</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mapi_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">m</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>)(<span class="id" title="var">e</span>:<span class="id" title="var">elt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">key</span>-&gt;<span class="id" title="var">elt</span>-&gt;<span class="id" title="var">elt&acute;</span>), <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> <span class="id" title="var">e</span> <span class="id" title="var">m</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">y</span>, <span class="id" title="var">E.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> /\ <span class="id" title="var">MapsTo</span> <span class="id" title="var">x</span> (<span class="id" title="var">f</span> <span class="id" title="var">y</span> <span class="id" title="var">e</span>) (<span class="id" title="var">mapi</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>).<br/>
 &nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mapi_2</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">m</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">f</span>:<span class="id" title="var">key</span>-&gt;<span class="id" title="var">elt</span>-&gt;<span class="id" title="var">elt&acute;</span>), <span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">mapi</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span>) -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> <span class="id" title="var">elt&acute;&acute;</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">m</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">m&acute;</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt&acute;</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>)(<span class="id" title="var">f</span>:<span class="id" title="var">option</span> <span class="id" title="var">elt</span>-&gt;<span class="id" title="var">option</span> <span class="id" title="var">elt&acute;</span>-&gt;<span class="id" title="var">option</span> <span class="id" title="var">elt&acute;&acute;</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">find</span> <span class="id" title="var">x</span> (<span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>) = <span class="id" title="var">f</span> (<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span>) (<span class="id" title="var">find</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">map2_2</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">elt</span> <span class="id" title="var">elt&acute;</span> <span class="id" title="var">elt&acute;&acute;</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">m</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt</span>)(<span class="id" title="var">m&acute;</span>: <span class="id" title="var">t</span> <span class="id" title="var">elt&acute;</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span>:<span class="id" title="var">key</span>)(<span class="id" title="var">f</span>:<span class="id" title="var">option</span> <span class="id" title="var">elt</span>-&gt;<span class="id" title="var">option</span> <span class="id" title="var">elt&acute;</span>-&gt;<span class="id" title="var">option</span> <span class="id" title="var">elt&acute;&acute;</span>),<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">In</span> <span class="id" title="var">x</span> (<span class="id" title="var">map2</span> <span class="id" title="var">f</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>) -&gt; <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m</span> \/ <span class="id" title="var">In</span> <span class="id" title="var">x</span> <span class="id" title="var">m&acute;</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">IntMake</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">IntMake_ord</span> (<span class="id" title="var">I</span>:<span class="id" title="var">Int</span>)(<span class="id" title="var">X</span>: <span class="id" title="var">OrderedType</span>)(<span class="id" title="var">D</span> : <span class="id" title="var">OrderedType</span>) &lt;:<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Sord</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Module</span> <span class="id" title="var">Data</span> := <span class="id" title="var">D</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Module</span> <span class="id" title="var">MapS.E</span> := <span class="id" title="var">X</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">Data</span> := <span class="id" title="var">D</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">MapS</span> := <span class="id" title="var">IntMake</span>(<span class="id" title="var">I</span>)(<span class="id" title="var">X</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">LO</span> := <span class="id" title="var">FMapList.Make_ord</span>(<span class="id" title="var">X</span>)(<span class="id" title="var">D</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">R</span> := <span class="id" title="var">Raw</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">P</span> := <span class="id" title="var">Raw.Proofs</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">t</span> := <span class="id" title="var">MapS.t</span> <span class="id" title="var">D.t</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">cmp</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">D.compare</span> <span class="id" title="var">e</span> <span class="id" title="var">e&acute;</span> <span class="id" title="keyword">with</span> <span class="id" title="var">EQ</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
One step of comparison of elements 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_more</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> (<span class="id" title="var">cont</span>:<span class="id" title="var">R.enumeration</span> <span class="id" title="var">D.t</span> -&gt; <span class="id" title="var">comparison</span>) <span class="id" title="var">e2</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">R.End</span> =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">R.More</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">X.compare</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">EQ</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">D.compare</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">EQ</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">cont</span> (<span class="id" title="var">R.cons</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">LT</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">GT</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">LT</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">GT</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Comparison of left tree, middle element, then right tree 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compare_cont</span> <span class="id" title="var">s1</span> (<span class="id" title="var">cont</span>:<span class="id" title="var">R.enumeration</span> <span class="id" title="var">D.t</span> -&gt; <span class="id" title="var">comparison</span>) <span class="id" title="var">e2</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s1</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">R.Leaf</span> =&gt; <span class="id" title="var">cont</span> <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">R.Node</span> <span class="id" title="var">l1</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> <span class="id" title="var">r1</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">compare_cont</span> <span class="id" title="var">l1</span> (<span class="id" title="var">compare_more</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> (<span class="id" title="var">compare_cont</span> <span class="id" title="var">r1</span> <span class="id" title="var">cont</span>)) <span class="id" title="var">e2</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Initial continuation 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_end</span> (<span class="id" title="var">e2</span>:<span class="id" title="var">R.enumeration</span> <span class="id" title="var">D.t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">with</span> <span class="id" title="var">R.End</span> =&gt; <span class="id" title="var">Eq</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Lt</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
The complete comparison 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare_pure</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">compare_cont</span> <span class="id" title="var">s1</span> <span class="id" title="var">compare_end</span> (<span class="id" title="var">R.cons</span> <span class="id" title="var">s2</span> (<span class="id" title="var">Raw.End</span> <span class="id" title="var">_</span>)).<br/>

<br/>
</div>

<div class="doc">
Correctness of this comparison 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Cmp</span> <span class="id" title="var">c</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">c</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">LO.eq_list</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">LO.lt_list</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> =&gt; (<span class="id" title="keyword">fun</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> =&gt; <span class="id" title="var">LO.lt_list</span> <span class="id" title="var">l2</span> <span class="id" title="var">l1</span>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">cons_Cmp</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">c</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">X.eq</span> <span class="id" title="var">x1</span> <span class="id" title="var">x2</span> -&gt; <span class="id" title="var">D.eq</span> <span class="id" title="var">d1</span> <span class="id" title="var">d2</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Cmp</span> <span class="id" title="var">c</span> <span class="id" title="var">l1</span> <span class="id" title="var">l2</span> -&gt; <span class="id" title="var">Cmp</span> <span class="id" title="var">c</span> ((<span class="id" title="var">x1</span>,<span class="id" title="var">d1</span>)::<span class="id" title="var">l1</span>) ((<span class="id" title="var">x2</span>,<span class="id" title="var">d2</span>)::<span class="id" title="var">l2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">cons_Cmp</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compare_end_Cmp</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">e2</span>, <span class="id" title="var">Cmp</span> (<span class="id" title="var">compare_end</span> <span class="id" title="var">e2</span>) <span class="id" title="var">nil</span> (<span class="id" title="var">P.flatten_e</span> <span class="id" title="var">e2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compare_more_Cmp</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> <span class="id" title="var">cont</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Cmp</span> (<span class="id" title="var">cont</span> (<span class="id" title="var">R.cons</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span>)) <span class="id" title="var">l</span> (<span class="id" title="var">R.elements</span> <span class="id" title="var">r2</span> ++ <span class="id" title="var">P.flatten_e</span> <span class="id" title="var">e2</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Cmp</span> (<span class="id" title="var">compare_more</span> <span class="id" title="var">x1</span> <span class="id" title="var">d1</span> <span class="id" title="var">cont</span> (<span class="id" title="var">R.More</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span>)) ((<span class="id" title="var">x1</span>,<span class="id" title="var">d1</span>)::<span class="id" title="var">l</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">P.flatten_e</span> (<span class="id" title="var">R.More</span> <span class="id" title="var">x2</span> <span class="id" title="var">d2</span> <span class="id" title="var">r2</span> <span class="id" title="var">e2</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compare_cont_Cmp</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">cont</span> <span class="id" title="var">e2</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">e</span>, <span class="id" title="var">Cmp</span> (<span class="id" title="var">cont</span> <span class="id" title="var">e</span>) <span class="id" title="var">l</span> (<span class="id" title="var">P.flatten_e</span> <span class="id" title="var">e</span>)) -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Cmp</span> (<span class="id" title="var">compare_cont</span> <span class="id" title="var">s1</span> <span class="id" title="var">cont</span> <span class="id" title="var">e2</span>) (<span class="id" title="var">R.elements</span> <span class="id" title="var">s1</span> ++ <span class="id" title="var">l</span>) (<span class="id" title="var">P.flatten_e</span> <span class="id" title="var">e2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compare_Cmp</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">Cmp</span> (<span class="id" title="var">compare_pure</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) (<span class="id" title="var">R.elements</span> <span class="id" title="var">s1</span>) (<span class="id" title="var">R.elements</span> <span class="id" title="var">s2</span>).<br/>

<br/>
</div>

<div class="doc">
The dependent-style <span class="inlinecode"><span class="id" title="var">compare</span></span> 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">eq</span> (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span> : <span class="id" title="var">t</span>) := <span class="id" title="var">LO.eq_list</span> (<span class="id" title="var">elements</span> <span class="id" title="var">m1</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">m2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">lt</span> (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span> : <span class="id" title="var">t</span>) := <span class="id" title="var">LO.lt_list</span> (<span class="id" title="var">elements</span> <span class="id" title="var">m1</span>) (<span class="id" title="var">elements</span> <span class="id" title="var">m2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare</span> (<span class="id" title="var">s</span> <span class="id" title="var">s&acute;</span>:<span class="id" title="var">t</span>) : <span class="id" title="var">Compare</span> <span class="id" title="var">lt</span> <span class="id" title="var">eq</span> <span class="id" title="var">s</span> <span class="id" title="var">s&acute;</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">selements</span> (<span class="id" title="var">m1</span> : <span class="id" title="var">t</span>) :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">LO.MapS.Build_slist</span> (<span class="id" title="var">P.elements_sort</span> <span class="id" title="var">m1</span>.(<span class="id" title="var">is_bst</span>)).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">seq</span> (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span> : <span class="id" title="var">t</span>) := <span class="id" title="var">LO.eq</span> (<span class="id" title="var">selements</span> <span class="id" title="var">m1</span>) (<span class="id" title="var">selements</span> <span class="id" title="var">m2</span>).<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">slt</span> (<span class="id" title="var">m1</span> <span class="id" title="var">m2</span> : <span class="id" title="var">t</span>) := <span class="id" title="var">LO.lt</span> (<span class="id" title="var">selements</span> <span class="id" title="var">m1</span>) (<span class="id" title="var">selements</span> <span class="id" title="var">m2</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_seq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>, <span class="id" title="var">eq</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> &lt;-&gt; <span class="id" title="var">seq</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_slt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>, <span class="id" title="var">lt</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> &lt;-&gt; <span class="id" title="var">slt</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_1</span> : <span class="id" title="keyword">forall</span> (<span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> : <span class="id" title="var">t</span>), <span class="id" title="var">Equivb</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> -&gt; <span class="id" title="var">eq</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>, <span class="id" title="var">eq</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span> -&gt; <span class="id" title="var">Equivb</span> <span class="id" title="var">cmp</span> <span class="id" title="var">m</span> <span class="id" title="var">m&acute;</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_refl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m</span> : <span class="id" title="var">t</span>, <span class="id" title="var">eq</span> <span class="id" title="var">m</span> <span class="id" title="var">m</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_sym</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> : <span class="id" title="var">t</span>, <span class="id" title="var">eq</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">eq</span> <span class="id" title="var">m2</span> <span class="id" title="var">m1</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">eq_trans</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">m3</span> : <span class="id" title="var">t</span>, <span class="id" title="var">eq</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">eq</span> <span class="id" title="var">m2</span> <span class="id" title="var">m3</span> -&gt; <span class="id" title="var">eq</span> <span class="id" title="var">m1</span> <span class="id" title="var">m3</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_trans</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">m3</span> : <span class="id" title="var">t</span>, <span class="id" title="var">lt</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> -&gt; <span class="id" title="var">lt</span> <span class="id" title="var">m2</span> <span class="id" title="var">m3</span> -&gt; <span class="id" title="var">lt</span> <span class="id" title="var">m1</span> <span class="id" title="var">m3</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">lt_not_eq</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> : <span class="id" title="var">t</span>, <span class="id" title="var">lt</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> -&gt; ~ <span class="id" title="var">eq</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">IntMake_ord</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Make</span> (<span class="id" title="var">X</span>: <span class="id" title="var">OrderedType</span>) &lt;: <span class="id" title="var">S</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Module</span> <span class="id" title="var">E</span> := <span class="id" title="var">X</span><br/>
&nbsp;:=<span class="id" title="var">IntMake</span>(<span class="id" title="var">Z_as_Int</span>)(<span class="id" title="var">X</span>).<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Make_ord</span> (<span class="id" title="var">X</span>: <span class="id" title="var">OrderedType</span>)(<span class="id" title="var">D</span>: <span class="id" title="var">OrderedType</span>)<br/>
&nbsp;&lt;: <span class="id" title="var">Sord</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Module</span> <span class="id" title="var">Data</span> := <span class="id" title="var">D</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> <span class="id" title="keyword">Module</span> <span class="id" title="var">MapS.E</span> := <span class="id" title="var">X</span><br/>
&nbsp;:=<span class="id" title="var">IntMake_ord</span>(<span class="id" title="var">Z_as_Int</span>)(<span class="id" title="var">X</span>)(<span class="id" title="var">D</span>).<br/>

<br/>
</div>
    <div id="sidebarWrapper">
      <div id="sidebar">
        <div class="block">
          <h2 class="title">Navigation</h2>
          <div class="content">
            <ul class="menu">
              <li class="leaf">Standard Library
                <ul class="menu">
                  <li><a href="index.html">Table of contents</a></li>
                  <li><a href="genindex.html">Index</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="footer">
    <div id="nav-footer">
      <ul class="links-menu-footer">
        <li><a href="mailto:coq-www_@_inria.fr">webmaster</a></li>
        <li><a href="http://validator.w3.org/">xhtml valid</a></li>
        <li><a href="http://jigsaw.w3.org/css-validator/">CSS valid</a></li>
      </ul>
    </div>
  </div>

</div>

</body>
</html>
