<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/node/node.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/defaults.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/user/user.css" />
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/coq/style.css" />
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/coq/coqdoc.css" />

<title>Standard Library | The Coq Proof Assistant</title>

</head>

<body>

<div id="container">
  <div id="headertop">
    <div id="nav">
      <ul class="links-menu">
        <li><a href="/" class="active">Home</a></li>
        <li><a href="/about-coq" title="More about coq">About Coq</a></li>
        <li><a href="/download">Get Coq</a></li>
        <li><a href="/documentation">Documentation</a></li>
        <li><a href="/community">Community</a></li>
      </ul>
    </div>
  </div>

  <div id="header">
    <div id="logoWrapper">
      <div id="logo"><a href="/" title="Home"><img src="/files/barron_logo.png" alt="Home" /></a>
      </div>
      <div id="siteName"><a href="/" title="Home">The Coq Proof Assistant</a>
      </div>
    </div>
  </div>

  <div id="content">

<h1 class="libtitle">Library Coq.MSets.MSetAVL</h1>

<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab571"></a><h1 class="section">MSetAVL : Implementation of MSetInterface via AVL trees</h1>

<div class="paragraph"> </div>

 This module implements finite sets using AVL trees.
    It follows the implementation from Ocaml's standard library,

<div class="paragraph"> </div>

    All operations given here expect and produce well-balanced trees
    (in the ocaml sense: heights of subtrees shouldn't differ by more
    than 2), and hence has low complexities (e.g. add is logarithmic
    in the size of the set). But proving these balancing preservations
    is in fact not necessary for ensuring correct operational behavior
    and hence fulfilling the MSet interface. As a consequence,
    balancing results are not part of this file anymore, they can
    now be found in <span class="inlinecode"><span class="id" title="var">MSetFullAVL</span></span>.

<div class="paragraph"> </div>

    Four operations (<span class="inlinecode"><span class="id" title="var">union</span></span>, <span class="inlinecode"><span class="id" title="var">subset</span></span>, <span class="inlinecode"><span class="id" title="var">compare</span></span> and <span class="inlinecode"><span class="id" title="var">equal</span></span>) have
    been slightly adapted in order to have only structural recursive
    calls. The precise ocaml versions of these operations have also
    been formalized (thanks to Function+measure), see <span class="inlinecode"><span class="id" title="var">ocaml_union</span></span>,
    <span class="inlinecode"><span class="id" title="var">ocaml_subset</span></span>, <span class="inlinecode"><span class="id" title="var">ocaml_compare</span></span> and <span class="inlinecode"><span class="id" title="var">ocaml_equal</span></span> in
    <span class="inlinecode"><span class="id" title="var">MSetFullAVL</span></span>. The structural variants compute faster in Coq,
    whereas the other variants produce nicer and/or (slightly) faster
    code after extraction.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <a class="idref" href="Coq.MSets.MSetInterface.html#"><span class="id" title="library">MSetInterface</span></a> <a class="idref" href="Coq.MSets.MSetGenTree.html#"><span class="id" title="library">MSetGenTree</span></a> <a class="idref" href="Coq.ZArith.ZArith.html#"><span class="id" title="library">ZArith</span></a> <a class="idref" href="Coq.ZArith.Int.html#"><span class="id" title="library">Int</span></a>.<br/>

<br/>
<span class="id" title="keyword">Set Implicit Arguments</span>.<br/>
<span class="id" title="keyword">Local</span><span class="id" title="keyword">Local</span>
<br/>
</div>

<div class="doc">
<a name="lab572"></a><h1 class="section">Ops : the pure functions</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="Ops"><span class="id" title="module">Ops</span></a> (<span class="id" title="keyword">Import</span> <span class="id" title="var">I</span>:<a class="idref" href="Coq.ZArith.Int.html#Int"><span class="id" title="module">Int</span></a>)(<span class="id" title="var">X</span>:<a class="idref" href="Coq.Structures.Orders.html#OrderedType"><span class="id" title="module">OrderedType</span></a>) &lt;: <a class="idref" href="Coq.MSets.MSetInterface.html#Ops"><span class="id" title="module">MSetInterface.Ops</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#X"><span class="id" title="module">X</span></a>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Int_scope</span>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Notation</span> <a name="Ops.int"><span class="id" title="abbreviation">int</span></a> := <a class="idref" href="Coq.MSets.MSetAVL.html#I.t"><span class="id" title="axiom">I.t</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab573"></a><h2 class="section">Generic trees instantiated with integer height</h2>

<div class="paragraph"> </div>

 We reuse a generic definition of trees where the information
    parameter is a <span class="inlinecode"><span class="id" title="var">Int.t</span></span>. Functions like mem or fold are also
    provided by this generic functor. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Include</span> <a class="idref" href="Coq.MSets.MSetGenTree.html#Ops"><span class="id" title="module">MSetGenTree.Ops</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#X"><span class="id" title="module">X</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#I"><span class="id" title="module">I</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Ops.t"><span class="id" title="definition">t</span></a> := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.tree"><span class="id" title="inductive">tree</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab574"></a><h2 class="section">Height of trees</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Ops.height"><span class="id" title="definition">height</span></a> (<span class="id" title="var">s</span> : <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a>) : <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.int"><span class="id" title="abbreviation">int</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; 0<br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">h</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab575"></a><h2 class="section">Singleton set</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Ops.singleton"><span class="id" title="definition">singleton</span></a> <span class="id" title="var">x</span> := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> 1 <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab576"></a><h2 class="section">Helper functions</h2>

<div class="paragraph"> </div>

 <span class="inlinecode"><span class="id" title="var">create</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> creates a node, assuming <span class="inlinecode"><span class="id" title="var">l</span></span> and <span class="inlinecode"><span class="id" title="var">r</span></span>
    to be balanced and <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">r</span>|</span> <span class="inlinecode">&lt;=</span> <span class="inlinecode">2</span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Ops.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> :=<br/>
&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#I.max"><span class="id" title="axiom">max</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.height"><span class="id" title="definition">height</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a>) (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.height"><span class="id" title="definition">height</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a>) <a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a> 1) <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">bal</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span> acts as <span class="inlinecode"><span class="id" title="var">create</span></span>, but performs one step of
    rebalancing if necessary, i.e. assumes <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">r</span>|</span> <span class="inlinecode">&lt;=</span> <span class="inlinecode">3</span>. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Ops.assert_false"><span class="id" title="definition">assert_false</span></a> := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <a name="Ops.bal"><span class="id" title="definition">bal</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hl</span> := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.height"><span class="id" title="definition">height</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">hr</span> := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.height"><span class="id" title="definition">height</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#I.gt_le_dec"><span class="id" title="axiom">gt_le_dec</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#hl"><span class="id" title="variable">hl</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#hr"><span class="id" title="variable">hr</span></a><a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a>2) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.assert_false"><span class="id" title="definition">assert_false</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#I.ge_lt_dec"><span class="id" title="axiom">ge_lt_dec</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.height"><span class="id" title="definition">height</span></a> <span class="id" title="var">ll</span>) (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.height"><span class="id" title="definition">height</span></a> <span class="id" title="var">lr</span>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">lr</span> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lr</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.assert_false"><span class="id" title="definition">assert_false</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">lrl</span> <span class="id" title="var">lrx</span> <span class="id" title="var">lrr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lrl</span>) <span class="id" title="var">lrx</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">lrr</span> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#I.gt_le_dec"><span class="id" title="axiom">gt_le_dec</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#hr"><span class="id" title="variable">hr</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#hl"><span class="id" title="variable">hl</span></a><a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a>2) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.assert_false"><span class="id" title="definition">assert_false</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#I.ge_lt_dec"><span class="id" title="axiom">ge_lt_dec</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.height"><span class="id" title="definition">height</span></a> <span class="id" title="var">rr</span>) (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.height"><span class="id" title="definition">height</span></a> <span class="id" title="var">rl</span>) <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">rl</span>) <span class="id" title="var">rx</span> <span class="id" title="var">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">rl</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.assert_false"><span class="id" title="definition">assert_false</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">rll</span> <span class="id" title="var">rlx</span> <span class="id" title="var">rlr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">rll</span>) <span class="id" title="var">rlx</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <span class="id" title="var">rlr</span> <span class="id" title="var">rx</span> <span class="id" title="var">rr</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab577"></a><h2 class="section">Insertion</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.add"><span class="id" title="definition">add</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> 1 <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">h</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Lt"><span class="id" title="constructor">Lt</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.bal"><span class="id" title="definition">bal</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#add"><span class="id" title="definition">add</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">y</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Eq"><span class="id" title="constructor">Eq</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">h</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Gt"><span class="id" title="constructor">Gt</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.bal"><span class="id" title="definition">bal</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#add"><span class="id" title="definition">add</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab578"></a><h2 class="section">Join</h2>


<div class="paragraph"> </div>

    Same as <span class="inlinecode"><span class="id" title="var">bal</span></span> but does not assume anything regarding heights
    of <span class="inlinecode"><span class="id" title="var">l</span></span> and <span class="inlinecode"><span class="id" title="var">r</span></span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.join"><span class="id" title="definition">join</span></a> <span class="id" title="var">l</span> : <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.elt"><span class="id" title="definition">elt</span></a> -&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a> -&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.add"><span class="id" title="definition">add</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">lh</span> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lr</span> =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="var">join_aux</span> (<span class="id" title="var">r</span>:<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a>) : <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.add"><span class="id" title="definition">add</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">rh</span> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#I.gt_le_dec"><span class="id" title="axiom">gt_le_dec</span></a> <span class="id" title="var">lh</span> (<span class="id" title="var">rh</span><a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a>2) <span class="id" title="keyword">then</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.bal"><span class="id" title="definition">bal</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#join"><span class="id" title="definition">join</span></a> <span class="id" title="var">lr</span> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#I.gt_le_dec"><span class="id" title="axiom">gt_le_dec</span></a> <span class="id" title="var">rh</span> (<span class="id" title="var">lh</span><a class="idref" href="Coq.ZArith.Int.html#5171f3cb981ed92452dbcf69d31b12d0"><span class="id" title="notation">+</span></a>2) <span class="id" title="keyword">then</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.bal"><span class="id" title="definition">bal</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#join_aux"><span class="id" title="variable">join_aux</span></a> <span class="id" title="var">rl</span>) <span class="id" title="var">rx</span> <span class="id" title="var">rr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.create"><span class="id" title="definition">create</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab579"></a><h2 class="section">Extraction of minimum element</h2>


<div class="paragraph"> </div>

  Morally, <span class="inlinecode"><span class="id" title="var">remove_min</span></span> is to be applied to a non-empty tree
  <span class="inlinecode"><span class="id" title="var">t</span></span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">Node</span></span> <span class="inlinecode"><span class="id" title="var">h</span></span> <span class="inlinecode"><span class="id" title="var">l</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">r</span></span>. Since we can't deal here with <span class="inlinecode"><span class="id" title="tactic">assert</span></span> <span class="inlinecode"><span class="id" title="var">false</span></span>
  for <span class="inlinecode"><span class="id" title="var">t</span>=<span class="id" title="var">Leaf</span></span>, we pre-unpack <span class="inlinecode"><span class="id" title="var">t</span></span> (and forget about <span class="inlinecode"><span class="id" title="var">h</span></span>).

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.remove_min"><span class="id" title="definition">remove_min</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> : <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a><a class="idref" href="Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#Ops.elt"><span class="id" title="definition">elt</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#l"><span class="id" title="variable">l</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">lh</span> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lr</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">l&acute;</span>,<span class="id" title="var">m</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#remove_min"><span class="id" title="definition">remove_min</span></a> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lr</span> <span class="id" title="keyword">in</span> <a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#Ops.bal"><span class="id" title="definition">bal</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l&acute;"><span class="id" title="variable">l&acute;</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r"><span class="id" title="variable">r</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#m"><span class="id" title="variable">m</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab580"></a><h2 class="section">Merging two trees</h2>


<div class="paragraph"> </div>

  <span class="inlinecode"><span class="id" title="var">merge</span></span> <span class="inlinecode"><span class="id" title="var">t1</span></span> <span class="inlinecode"><span class="id" title="var">t2</span></span> builds the union of <span class="inlinecode"><span class="id" title="var">t1</span></span> and <span class="inlinecode"><span class="id" title="var">t2</span></span> assuming all elements
  of <span class="inlinecode"><span class="id" title="var">t1</span></span> to be smaller than all elements of <span class="inlinecode"><span class="id" title="var">t2</span></span>, and
  <span class="inlinecode">|<span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">t1</span></span> <span class="inlinecode">-</span> <span class="inlinecode"><span class="id" title="var">height</span></span> <span class="inlinecode"><span class="id" title="var">t2</span>|</span> <span class="inlinecode">&lt;=</span> <span class="inlinecode">2</span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Ops.merge"><span class="id" title="definition">merge</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> :=  <span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a>,<a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l2</span> <span class="id" title="var">x2</span> <span class="id" title="var">r2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">s2&acute;</span>,<span class="id" title="var">m</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.remove_min"><span class="id" title="definition">remove_min</span></a> <span class="id" title="var">l2</span> <span class="id" title="var">x2</span> <span class="id" title="var">r2</span> <span class="id" title="keyword">in</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.bal"><span class="id" title="definition">bal</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#s2&acute;"><span class="id" title="variable">s2&acute;</span></a><br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab581"></a><h2 class="section">Deletion</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.remove"><span class="id" title="definition">remove</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Lt"><span class="id" title="constructor">Lt</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.bal"><span class="id" title="definition">bal</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#remove"><span class="id" title="definition">remove</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">l</span>) <span class="id" title="var">y</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Eq"><span class="id" title="constructor">Eq</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.merge"><span class="id" title="definition">merge</span></a> <span class="id" title="var">l</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Gt"><span class="id" title="constructor">Gt</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.bal"><span class="id" title="definition">bal</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#remove"><span class="id" title="definition">remove</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab582"></a><h2 class="section">Concatenation</h2>


<div class="paragraph"> </div>

    Same as <span class="inlinecode"><span class="id" title="var">merge</span></span> but does not assume anything about heights.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <a name="Ops.concat"><span class="id" title="definition">concat</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a>, <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l2</span> <span class="id" title="var">x2</span> <span class="id" title="var">r2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">s2&acute;</span>,<span class="id" title="var">m</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.remove_min"><span class="id" title="definition">remove_min</span></a> <span class="id" title="var">l2</span> <span class="id" title="var">x2</span> <span class="id" title="var">r2</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#m"><span class="id" title="variable">m</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#s2&acute;"><span class="id" title="variable">s2&acute;</span></a><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab583"></a><h2 class="section">Splitting</h2>


<div class="paragraph"> </div>

    <span class="inlinecode"><span class="id" title="tactic">split</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode"><span class="id" title="var">s</span></span> returns a triple <span class="inlinecode">(<span class="id" title="var">l</span>,</span> <span class="inlinecode"><span class="id" title="var">present</span>,</span> <span class="inlinecode"><span class="id" title="var">r</span>)</span> where

<div class="paragraph"> </div>

<ul class="doclist">
<li> <span class="inlinecode"><span class="id" title="var">l</span></span> is the set of elements of <span class="inlinecode"><span class="id" title="var">s</span></span> that are <span class="inlinecode">&lt;</span> <span class="inlinecode"><span class="id" title="var">x</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">r</span></span> is the set of elements of <span class="inlinecode"><span class="id" title="var">s</span></span> that are <span class="inlinecode">&gt;</span> <span class="inlinecode"><span class="id" title="var">x</span></span>

</li>
<li> <span class="inlinecode"><span class="id" title="var">present</span></span> is <span class="inlinecode"><span class="id" title="var">true</span></span> if and only if <span class="inlinecode"><span class="id" title="var">s</span></span> contains  <span class="inlinecode"><span class="id" title="var">x</span></span>.

</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Record</span> <a name="Ops.triple"><span class="id" title="record">triple</span></a> := <a name="Ops.mktriple"><span class="id" title="constructor">mktriple</span></a> { <a name="Ops.t_left"><span class="id" title="projection">t_left</span></a>:<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a>; <a name="Ops.t_in"><span class="id" title="projection">t_in</span></a>:<a class="idref" href="Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>; <a name="Ops.t_right"><span class="id" title="projection">t_right</span></a>:<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a> }.<br/>
<span class="id" title="keyword">Notation</span> <a name="92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&quot;</span></a>&lt;&lt; l , b , r &gt;&gt;" := (<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.mktriple"><span class="id" title="constructor">mktriple</span></a> <span class="id" title="var">l</span> <span class="id" title="var">b</span> <span class="id" title="var">r</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9).<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.split"><span class="id" title="definition">split</span></a> <span class="id" title="var">x</span> <span class="id" title="var">s</span> : <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.triple"><span class="id" title="record">triple</span></a> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&lt;&lt;</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" title="constructor">false</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#X.compare"><span class="id" title="axiom">X.compare</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Lt"><span class="id" title="constructor">Lt</span></a> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">ll</span>,<span class="id" title="var">b</span>,<span class="id" title="var">rl</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#split"><span class="id" title="definition">split</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">l</span> <span class="id" title="keyword">in</span> <a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&lt;&lt;</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#ll"><span class="id" title="variable">ll</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#rl"><span class="id" title="variable">rl</span></a> <span class="id" title="var">y</span> <span class="id" title="var">r</span> <a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Eq"><span class="id" title="constructor">Eq</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&lt;&lt;</span></a> <span class="id" title="var">l</span><a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" title="constructor">true</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">,</span></a> <span class="id" title="var">r</span> <a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Gt"><span class="id" title="constructor">Gt</span></a> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">rl</span>,<span class="id" title="var">b</span>,<span class="id" title="var">rr</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#split"><span class="id" title="definition">split</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#x"><span class="id" title="variable">x</span></a> <span class="id" title="var">r</span> <span class="id" title="keyword">in</span> <a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&lt;&lt;</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> <span class="id" title="var">l</span> <span class="id" title="var">y</span> <a class="idref" href="Coq.MSets.MSetAVL.html#rl"><span class="id" title="variable">rl</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#b"><span class="id" title="variable">b</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#rr"><span class="id" title="variable">rr</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#92cc305a1e2b5fe1e2c999e2c6d5cf10"><span class="id" title="notation">&gt;&gt;</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab584"></a><h2 class="section">Intersection</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.inter"><span class="id" title="definition">inter</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a>, <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l1</span> <span class="id" title="var">x1</span> <span class="id" title="var">r1</span>, <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">l2&acute;</span>,<span class="id" title="var">pres</span>,<span class="id" title="var">r2&acute;</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.split"><span class="id" title="definition">split</span></a> <span class="id" title="var">x1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#pres"><span class="id" title="variable">pres</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#inter"><span class="id" title="definition">inter</span></a> <span class="id" title="var">l1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#l2&acute;"><span class="id" title="variable">l2&acute;</span></a>) <span class="id" title="var">x1</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#inter"><span class="id" title="definition">inter</span></a> <span class="id" title="var">r1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r2&acute;"><span class="id" title="variable">r2&acute;</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.concat"><span class="id" title="definition">concat</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#inter"><span class="id" title="definition">inter</span></a> <span class="id" title="var">l1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#l2&acute;"><span class="id" title="variable">l2&acute;</span></a>) (<a class="idref" href="Coq.MSets.MSetAVL.html#inter"><span class="id" title="definition">inter</span></a> <span class="id" title="var">r1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r2&acute;"><span class="id" title="variable">r2&acute;</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab585"></a><h2 class="section">Difference</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.diff"><span class="id" title="definition">diff</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a>, <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><br/>
&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a><br/>
&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l1</span> <span class="id" title="var">x1</span> <span class="id" title="var">r1</span>, <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">l2&acute;</span>,<span class="id" title="var">pres</span>,<span class="id" title="var">r2&acute;</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.split"><span class="id" title="definition">split</span></a> <span class="id" title="var">x1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#pres"><span class="id" title="variable">pres</span></a> <span class="id" title="keyword">then</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.concat"><span class="id" title="definition">concat</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#diff"><span class="id" title="definition">diff</span></a> <span class="id" title="var">l1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#l2&acute;"><span class="id" title="variable">l2&acute;</span></a>) (<a class="idref" href="Coq.MSets.MSetAVL.html#diff"><span class="id" title="definition">diff</span></a> <span class="id" title="var">r1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r2&acute;"><span class="id" title="variable">r2&acute;</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#diff"><span class="id" title="definition">diff</span></a> <span class="id" title="var">l1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#l2&acute;"><span class="id" title="variable">l2&acute;</span></a>) <span class="id" title="var">x1</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#diff"><span class="id" title="definition">diff</span></a> <span class="id" title="var">r1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r2&acute;"><span class="id" title="variable">r2&acute;</span></a>)<br/>
<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab586"></a><h2 class="section">Union</h2>

<div class="paragraph"> </div>

 In ocaml, heights of <span class="inlinecode"><span class="id" title="var">s1</span></span> and <span class="inlinecode"><span class="id" title="var">s2</span></span> are compared each time in order
   to recursively perform the split on the smaller set.
   Unfortunately, this leads to a non-structural algorithm. The
   following code is a simplification of the ocaml version: no
   comparison of heights. It might be slightly slower, but
   experimentally all the tests I've made in ocaml have shown this
   potential slowdown to be non-significant. Anyway, the exact code
   of ocaml has also been formalized thanks to Function+measure, see
   <span class="inlinecode"><span class="id" title="var">ocaml_union</span></span> in <span class="inlinecode"><span class="id" title="var">MSetFullAVL</span></span>.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.union"><span class="id" title="definition">union</span></a> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a>, <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a>, <span class="id" title="var">_</span> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a><br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span>, <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#s1"><span class="id" title="variable">s1</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l1</span> <span class="id" title="var">x1</span> <span class="id" title="var">r1</span>, <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">l2&acute;</span>,<span class="id" title="var">_</span>,<span class="id" title="var">r2&acute;</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.split"><span class="id" title="definition">split</span></a> <span class="id" title="var">x1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s2"><span class="id" title="variable">s2</span></a> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> (<a class="idref" href="Coq.MSets.MSetAVL.html#union"><span class="id" title="definition">union</span></a> <span class="id" title="var">l1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#l2&acute;"><span class="id" title="variable">l2&acute;</span></a>) <span class="id" title="var">x1</span> (<a class="idref" href="Coq.MSets.MSetAVL.html#union"><span class="id" title="definition">union</span></a> <span class="id" title="var">r1</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r2&acute;"><span class="id" title="variable">r2&acute;</span></a>)<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab587"></a><h2 class="section">Filter</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.filter"><span class="id" title="definition">filter</span></a> (<span class="id" title="var">f</span>:<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.elt"><span class="id" title="definition">elt</span></a>-&gt;<a class="idref" href="Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>) <span class="id" title="var">s</span> := <span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l&acute;</span> := <a class="idref" href="Coq.MSets.MSetAVL.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">l</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">r&acute;</span> := <a class="idref" href="Coq.MSets.MSetAVL.html#filter"><span class="id" title="definition">filter</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">r</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">x</span> <span class="id" title="keyword">then</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l&acute;"><span class="id" title="variable">l&acute;</span></a> <span class="id" title="var">x</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r&acute;"><span class="id" title="variable">r&acute;</span></a> <span class="id" title="keyword">else</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.concat"><span class="id" title="definition">concat</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l&acute;"><span class="id" title="variable">l&acute;</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r&acute;"><span class="id" title="variable">r&acute;</span></a><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab588"></a><h2 class="section">Partition</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <a name="Ops.partition"><span class="id" title="definition">partition</span></a> (<span class="id" title="var">f</span>:<a class="idref" href="Coq.MSets.MSetAVL.html#Ops.elt"><span class="id" title="definition">elt</span></a>-&gt;<a class="idref" href="Coq.Init.Datatypes.html#bool"><span class="id" title="inductive">bool</span></a>)(<span class="id" title="var">s</span> : <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a>) : <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a><a class="idref" href="Coq.Init.Datatypes.html#d19c7eafd0e2d195d10df94b392087b5"><span class="id" title="notation">*</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#Ops.t"><span class="id" title="definition">t</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <a class="idref" href="Coq.MSets.MSetAVL.html#s"><span class="id" title="variable">s</span></a> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a> =&gt; <a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Leaf"><span class="id" title="constructor">Leaf</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">_</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">l1</span>,<span class="id" title="var">l2</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#partition"><span class="id" title="definition">partition</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">l</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">r1</span>,<span class="id" title="var">r2</span>) := <a class="idref" href="Coq.MSets.MSetAVL.html#partition"><span class="id" title="definition">partition</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">r</span> <span class="id" title="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <a class="idref" href="Coq.MSets.MSetAVL.html#f"><span class="id" title="variable">f</span></a> <span class="id" title="var">x</span> <span class="id" title="keyword">then</span> <a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l1"><span class="id" title="variable">l1</span></a> <span class="id" title="var">x</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r1"><span class="id" title="variable">r1</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.concat"><span class="id" title="definition">concat</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l2"><span class="id" title="variable">l2</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r2"><span class="id" title="variable">r2</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">(</span></a><a class="idref" href="Coq.MSets.MSetAVL.html#Ops.concat"><span class="id" title="definition">concat</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l1"><span class="id" title="variable">l1</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#r1"><span class="id" title="variable">r1</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">,</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops.join"><span class="id" title="definition">join</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#l2"><span class="id" title="variable">l2</span></a> <span class="id" title="var">x</span> <a class="idref" href="Coq.MSets.MSetAVL.html#r2"><span class="id" title="variable">r2</span></a><a class="idref" href="Coq.Init.Datatypes.html#44400027531d4bc3f586a1997dc874c0"><span class="id" title="notation">)</span></a><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops"><span class="id" title="module">Ops</span></a>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab589"></a><h1 class="section">MakeRaw</h1>


<div class="paragraph"> </div>

   Functor of pure functions + a posteriori proofs of invariant
   preservation 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <a name="MakeRaw"><span class="id" title="module">MakeRaw</span></a> (<span class="id" title="keyword">Import</span> <span class="id" title="var">I</span>:<a class="idref" href="Coq.ZArith.Int.html#Int"><span class="id" title="module">Int</span></a>)(<span class="id" title="var">X</span>:<a class="idref" href="Coq.Structures.Orders.html#OrderedType"><span class="id" title="module">OrderedType</span></a>) &lt;: <a class="idref" href="Coq.MSets.MSetInterface.html#RawSets"><span class="id" title="module">RawSets</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#X"><span class="id" title="module">X</span></a>.<br/>
<span class="id" title="keyword">Include</span> <a class="idref" href="Coq.MSets.MSetAVL.html#Ops"><span class="id" title="module">Ops</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#I"><span class="id" title="module">I</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#X"><span class="id" title="module">X</span></a>.<br/>

<br/>
</div>

<div class="doc">
Generic definition of binary-search-trees and proofs of
    specifications for generic functions such as mem or fold. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Include</span> <a class="idref" href="Coq.MSets.MSetGenTree.html#Props"><span class="id" title="module">MSetGenTree.Props</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#X"><span class="id" title="module">X</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#I"><span class="id" title="module">I</span></a>.<br/>

<br/>
</div>

<div class="doc">
Automation and dedicated tactics 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Hint Immediate</span> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.MX.eq_sym"><span class="id" title="definition">MX.eq_sym</span></a>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Hint Unfold</span> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.In"><span class="id" title="definition">In</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.lt_tree"><span class="id" title="definition">lt_tree</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.gt_tree"><span class="id" title="definition">gt_tree</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.Ok"><span class="id" title="class">Ok</span></a>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Hint Constructors</span> <a class="idref" href="Coq.MSets.MSetAVL.html#InT"><span class="id" title="inductive">InT</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#bst"><span class="id" title="inductive">bst</span></a>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Hint Resolve</span> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.MX.eq_refl"><span class="id" title="definition">MX.eq_refl</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.MX.eq_trans"><span class="id" title="definition">MX.eq_trans</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.MX.lt_trans"><span class="id" title="definition">MX.lt_trans</span></a> @<a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.ok"><span class="id" title="definition">ok</span></a>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Hint Resolve</span> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.lt_leaf"><span class="id" title="lemma">lt_leaf</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.gt_leaf"><span class="id" title="lemma">gt_leaf</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.lt_tree_node"><span class="id" title="lemma">lt_tree_node</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.gt_tree_node"><span class="id" title="lemma">gt_tree_node</span></a>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Hint Resolve</span> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.lt_tree_not_in"><span class="id" title="lemma">lt_tree_not_in</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.lt_tree_trans"><span class="id" title="lemma">lt_tree_trans</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.gt_tree_not_in"><span class="id" title="lemma">gt_tree_not_in</span></a> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.gt_tree_trans"><span class="id" title="lemma">gt_tree_trans</span></a>.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Hint Resolve</span> <a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.elements_spec2"><span class="id" title="lemma">elements_spec2</span></a>.<br/>

<br/>

<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "factornode" <span class="id" title="var">ident</span>(<span class="id" title="var">s</span>) :=<br/>
&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">clear</span> <span class="id" title="var">s</span>;<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| |- <span class="id" title="keyword">context</span> [<a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.Node"><span class="id" title="constructor">Node</span></a> ?<span class="id" title="var">l</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">r</span> ?<span class="id" title="var">h</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">s</span>:=<a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) <span class="id" title="keyword">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">s</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> : <span class="id" title="keyword">context</span> [<a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.Node"><span class="id" title="constructor">Node</span></a> ?<span class="id" title="var">l</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">r</span> ?<span class="id" title="var">h</span>] |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">s</span>:=<a class="idref" href="Coq.MSets.MSetAVL.html#MakeRaw.Node"><span class="id" title="constructor">Node</span></a> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span>) <span class="id" title="keyword">in</span> *; <span class="id" title="var">clearbody</span> <span class="id" title="var">s</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Inductions principles for some of the set operators 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">bal_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">bal</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">remove_min_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">remove_min</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">merge_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">merge</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">concat_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">concat</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">inter_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">inter</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">diff_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">diff</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>
<span class="id" title="keyword">Function</span><span class="id" title="var">al</span> <span class="id" title="keyword">Scheme</span> <span class="id" title="var">union_ind</span> := <span class="id" title="keyword">Induction</span> <span class="id" title="keyword">for</span> <span class="id" title="var">union</span> <span class="id" title="keyword">Sort</span> <span class="id" title="keyword">Prop</span>.<br/>

<br/>
</div>

<div class="doc">
Notations and helper lemma about pairs and triples 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Notation</span> &quot;s #1" := (<span class="id" title="var">fst</span> <span class="id" title="var">s</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "s '#1'") : <span class="id" title="var">pair_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;s #2" := (<span class="id" title="var">snd</span> <span class="id" title="var">s</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "s '#2'") : <span class="id" title="var">pair_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;t #l" := (<span class="id" title="var">t_left</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "t '#l'") : <span class="id" title="var">pair_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;t #b" := (<span class="id" title="var">t_in</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "t '#b'") : <span class="id" title="var">pair_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;t #r" := (<span class="id" title="var">t_right</span> <span class="id" title="var">t</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 9, <span class="id" title="var">format</span> "t '#r'") : <span class="id" title="var">pair_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">pair_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab590"></a><h2 class="section">Singleton set</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">singleton_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">singleton</span> <span class="id" title="var">x</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">singleton_ok</span> <span class="id" title="var">x</span> : <span class="id" title="var">Ok</span> (<span class="id" title="var">singleton</span> <span class="id" title="var">x</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab591"></a><h2 class="section">Helper functions</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">create_spec</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span>,  <span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">create</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">create_ok</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">l</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">r</span>, <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>, <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>) :<br/>
&nbsp;<span class="id" title="var">Ok</span> (<span class="id" title="var">create</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">bal_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">bal</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">bal_ok</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">l</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">r</span>, <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>, <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>) :<br/>
&nbsp;<span class="id" title="var">Ok</span> (<span class="id" title="var">bal</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab592"></a><h2 class="section">Insertion</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_spec&acute;</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>},<br/>
&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s</span>.<br/>
 
<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">add_ok</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Int_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab593"></a><h2 class="section">Join</h2>

<div class="paragraph"> </div>

 Function/Functional Scheme can't deal with internal fix.
    Let's do its job by hand: 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">join_tac</span> :=<br/>
&nbsp;<span class="id" title="tactic">intro</span> <span class="id" title="var">l</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">l</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">lh</span> <span class="id" title="var">ll</span> <span class="id" title="var">_</span> <span class="id" title="var">lx</span> <span class="id" title="var">lr</span> <span class="id" title="var">Hlr</span>];<br/>
&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">intros</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>; <span class="id" title="tactic">induction</span> <span class="id" title="var">r</span> <span class="id" title="keyword">as</span> [| <span class="id" title="var">rh</span> <span class="id" title="var">rl</span> <span class="id" title="var">Hrl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rr</span> <span class="id" title="var">_</span>]; <span class="id" title="tactic">unfold</span> <span class="id" title="var">join</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ | <span class="id" title="tactic">destruct</span> (<span class="id" title="var">gt_le_dec</span> <span class="id" title="var">lh</span> (<span class="id" title="var">rh</span>+2)) <span class="id" title="keyword">as</span> [<span class="id" title="var">GT</span>|<span class="id" title="var">LE</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="keyword">context</span> <span class="id" title="var">b</span> [ <span class="id" title="var">bal</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span> ?<span class="id" title="var">c</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">bal</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">bal</span> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> (<span class="id" title="var">join</span> <span class="id" title="var">lr</span> <span class="id" title="var">x</span> (<span class="id" title="var">Node</span> <span class="id" title="var">rh</span> <span class="id" title="var">rl</span> <span class="id" title="var">rx</span> <span class="id" title="var">rr</span>))); [ | <span class="id" title="tactic">auto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="tactic">destruct</span> (<span class="id" title="var">gt_le_dec</span> <span class="id" title="var">rh</span> (<span class="id" title="var">lh</span>+2)) <span class="id" title="keyword">as</span> [<span class="id" title="var">GT&acute;</span>|<span class="id" title="var">LE&acute;</span>];<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- <span class="id" title="keyword">context</span> <span class="id" title="var">b</span> [ <span class="id" title="var">bal</span> ?<span class="id" title="var">a</span> ?<span class="id" title="var">b</span> ?<span class="id" title="var">c</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">replace</span> (<span class="id" title="var">bal</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">with</span> (<span class="id" title="var">bal</span> (<span class="id" title="var">join</span> (<span class="id" title="var">Node</span> <span class="id" title="var">lh</span> <span class="id" title="var">ll</span> <span class="id" title="var">lx</span> <span class="id" title="var">lr</span>) <span class="id" title="var">x</span> <span class="id" title="var">rl</span>) <span class="id" title="var">rx</span> <span class="id" title="var">rr</span>); [ | <span class="id" title="tactic">auto</span>]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ] ] ] ]; <span class="id" title="tactic">intros</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">join_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">join</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>) &lt;-&gt; <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">l</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">join_ok</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">l</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">r</span>, <span class="id" title="var">lt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">l</span>, <span class="id" title="var">gt_tree</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>),<br/>
&nbsp;<span class="id" title="var">Ok</span> (<span class="id" title="var">join</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab594"></a><h2 class="section">Extraction of minimum element</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">y</span> <span class="id" title="var">h</span>,<br/>
&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">Node</span> <span class="id" title="var">h</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>) &lt;-&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>)#2 \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>)#1.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">remove_min_ok</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">h</span> `(<span class="id" title="var">Ok</span> (<span class="id" title="var">Node</span> <span class="id" title="var">h</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>)),<br/>
&nbsp;<span class="id" title="var">Ok</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>)#1.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_min_gt_tree</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span> <span class="id" title="var">h</span> `{<span class="id" title="var">Ok</span> (<span class="id" title="var">Node</span> <span class="id" title="var">h</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>)},<br/>
&nbsp;<span class="id" title="var">gt_tree</span> (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>)#2 (<span class="id" title="var">remove_min</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> <span class="id" title="var">r</span>)#1.<br/>
<span class="id" title="keyword">Local</span>&nbsp;<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">remove_min_gt_tree</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab595"></a><h2 class="section">Merging two trees</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">merge_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">merge</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s1</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s2</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">merge_ok</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="keyword">forall</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>)<br/>
&nbsp;`(<span class="id" title="keyword">forall</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span> : <span class="id" title="var">elt</span>, <span class="id" title="var">InT</span> <span class="id" title="var">y1</span> <span class="id" title="var">s1</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y2</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">X.lt</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>),<br/>
&nbsp;<span class="id" title="var">Ok</span> (<span class="id" title="var">merge</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab596"></a><h2 class="section">Deletion</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">remove_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>},<br/>
&nbsp;(<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s</span> /\ ~ <span class="id" title="var">X.eq</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">remove_ok</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="var">remove</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab597"></a><h2 class="section">Concatenation</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">concat_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">y</span>,<br/>
&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">concat</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s1</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s2</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">concat_ok</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="keyword">forall</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>)<br/>
&nbsp;`(<span class="id" title="keyword">forall</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span> : <span class="id" title="var">elt</span>, <span class="id" title="var">InT</span> <span class="id" title="var">y1</span> <span class="id" title="var">s1</span> -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y2</span> <span class="id" title="var">s2</span> -&gt; <span class="id" title="var">X.lt</span> <span class="id" title="var">y1</span> <span class="id" title="var">y2</span>),<br/>
&nbsp;<span class="id" title="var">Ok</span> (<span class="id" title="var">concat</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab598"></a><h2 class="section">Splitting</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_spec1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>},<br/>
&nbsp;(<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">l</span> &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s</span> /\ <span class="id" title="var">X.lt</span> <span class="id" title="var">y</span> <span class="id" title="var">x</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_spec2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>},<br/>
&nbsp;(<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">r</span> &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s</span> /\ <span class="id" title="var">X.lt</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_spec3</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>},<br/>
&nbsp;((<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">b</span> = <span class="id" title="var">true</span> &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">split_ok</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>}, <span class="id" title="var">Ok</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">l</span> /\ <span class="id" title="var">Ok</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">r</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">split_ok1</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">l</span>.<br/>
 
<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">split_ok2</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">r</span>.<br/>
 
<br/>
</div>

<div class="doc">
<a name="lab599"></a><h2 class="section">Intersection</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">destruct_split</span> := <span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="var">H</span> : <span class="id" title="tactic">split</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">s</span> = &lt;&lt; ?<span class="id" title="var">u</span>, ?<span class="id" title="var">v</span>, ?<span class="id" title="var">w</span> &gt;&gt; |- <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ((<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">l</span> = <span class="id" title="var">u</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>);<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ((<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">b</span> = <span class="id" title="var">v</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>);<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> ((<span class="id" title="tactic">split</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>)#<span class="id" title="var">r</span> = <span class="id" title="var">w</span>) <span class="id" title="tactic">by</span> (<span class="id" title="tactic">rewrite</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">auto</span>);<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>; <span class="id" title="tactic">subst</span> <span class="id" title="var">u</span> <span class="id" title="var">w</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inter_spec_ok</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>},<br/>
&nbsp;<span class="id" title="var">Ok</span> (<span class="id" title="var">inter</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) /\ (<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">inter</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s1</span> /\ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">inter_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">y</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>},<br/>
&nbsp;(<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">inter</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s1</span> /\ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s2</span>).<br/>
 
<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">inter_ok</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="var">inter</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>).<br/>
 
<br/>
</div>

<div class="doc">
<a name="lab600"></a><h2 class="section">Difference</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">diff_spec_ok</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>},<br/>
&nbsp;<span class="id" title="var">Ok</span> (<span class="id" title="var">diff</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) /\ (<span class="id" title="keyword">forall</span> <span class="id" title="var">y</span>, <span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">diff</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s1</span> /\ ~<span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s2</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">diff_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">y</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>},<br/>
&nbsp;(<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">diff</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s1</span> /\ ~<span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s2</span>).<br/>
 
<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">diff_ok</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="var">diff</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>).<br/>
 
<br/>
</div>

<div class="doc">
<a name="lab601"></a><h2 class="section">Union</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">union_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> <span class="id" title="var">y</span> `{<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>},<br/>
&nbsp;(<span class="id" title="var">InT</span> <span class="id" title="var">y</span> (<span class="id" title="var">union</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s1</span> \/ <span class="id" title="var">InT</span> <span class="id" title="var">y</span> <span class="id" title="var">s2</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">union_ok</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span> : <span class="id" title="keyword">forall</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s1</span>, <span class="id" title="var">Ok</span> <span class="id" title="var">s2</span>), <span class="id" title="var">Ok</span> (<span class="id" title="var">union</span> <span class="id" title="var">s1</span> <span class="id" title="var">s2</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab602"></a><h1 class="section">Filter</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">filter_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> <span class="id" title="var">f</span>,<br/>
&nbsp;<span class="id" title="var">Proper</span> (<span class="id" title="var">X.eq</span>==&gt;<span class="id" title="var">Logic.eq</span>) <span class="id" title="var">f</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">InT</span> <span class="id" title="var">x</span> (<span class="id" title="var">filter</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>) &lt;-&gt; <span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span> /\ <span class="id" title="var">f</span> <span class="id" title="var">x</span> = <span class="id" title="var">true</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">filter_weak_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">s</span> <span class="id" title="var">x</span> <span class="id" title="var">f</span>,<br/>
&nbsp;<span class="id" title="var">InT</span> <span class="id" title="var">x</span> (<span class="id" title="var">filter</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>) -&gt; <span class="id" title="var">InT</span> <span class="id" title="var">x</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">filter_ok</span> <span class="id" title="var">s</span> <span class="id" title="var">f</span> `(<span class="id" title="var">H</span> : <span class="id" title="var">Ok</span> <span class="id" title="var">s</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="var">filter</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab603"></a><h1 class="section">Partition</h1>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">partition_spec1&acute;</span> <span class="id" title="var">s</span> <span class="id" title="var">f</span> : (<span class="id" title="var">partition</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>)#1 = <span class="id" title="var">filter</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">partition_spec2&acute;</span> <span class="id" title="var">s</span> <span class="id" title="var">f</span> :<br/>
&nbsp;(<span class="id" title="var">partition</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>)#2 = <span class="id" title="var">filter</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">negb</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) <span class="id" title="var">s</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">partition_spec1</span> <span class="id" title="var">s</span> <span class="id" title="var">f</span> :<br/>
&nbsp;<span class="id" title="var">Proper</span> (<span class="id" title="var">X.eq</span>==&gt;<span class="id" title="var">Logic.eq</span>) <span class="id" title="var">f</span> -&gt;<br/>
&nbsp;<span class="id" title="var">Equal</span> (<span class="id" title="var">partition</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>)#1 (<span class="id" title="var">filter</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>).<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">partition_spec2</span> <span class="id" title="var">s</span> <span class="id" title="var">f</span> :<br/>
&nbsp;<span class="id" title="var">Proper</span> (<span class="id" title="var">X.eq</span>==&gt;<span class="id" title="var">Logic.eq</span>) <span class="id" title="var">f</span> -&gt;<br/>
&nbsp;<span class="id" title="var">Equal</span> (<span class="id" title="var">partition</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>)#2 (<span class="id" title="var">filter</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">negb</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>)) <span class="id" title="var">s</span>).<br/>
 
<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">partition_ok1</span> <span class="id" title="var">s</span> <span class="id" title="var">f</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="var">partition</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>)#1.<br/>
 
<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">partition_ok2</span> <span class="id" title="var">s</span> <span class="id" title="var">f</span> `(<span class="id" title="var">Ok</span> <span class="id" title="var">s</span>) : <span class="id" title="var">Ok</span> (<span class="id" title="var">partition</span> <span class="id" title="var">f</span> <span class="id" title="var">s</span>)#2.<br/>
 
<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">MakeRaw</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab604"></a><h1 class="section">Encapsulation</h1>


<div class="paragraph"> </div>

   Now, in order to really provide a functor implementing <span class="inlinecode"><span class="id" title="var">S</span></span>, we
   need to encapsulate everything into a type of binary search trees.
   They also happen to be well-balanced, but this has no influence
   on the correctness of operations, so we won't state this here,
   see <span class="inlinecode"><span class="id" title="var">MSetFullAVL</span></span> if you need more than just the MSet interface.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">IntMake</span> (<span class="id" title="var">I</span>:<span class="id" title="var">Int</span>)(<span class="id" title="var">X</span>: <span class="id" title="var">OrderedType</span>) &lt;: <span class="id" title="var">S</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Module</span> <span class="id" title="var">E</span> := <span class="id" title="var">X</span>.<br/>
&nbsp;<span class="id" title="keyword">Module</span> <span class="id" title="var">Raw</span> := <span class="id" title="var">MakeRaw</span> <span class="id" title="var">I</span> <span class="id" title="var">X</span>.<br/>
&nbsp;<span class="id" title="keyword">Include</span> <span class="id" title="var">Raw2Sets</span> <span class="id" title="var">X</span> <span class="id" title="var">Raw</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">IntMake</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Make</span> (<span class="id" title="var">X</span>: <span class="id" title="var">OrderedType</span>) &lt;: <span class="id" title="var">S</span> <span class="id" title="keyword">with</span> <span class="id" title="keyword">Module</span> <span class="id" title="var">E</span> := <span class="id" title="var">X</span><br/>
&nbsp;:=<span class="id" title="var">IntMake</span>(<span class="id" title="var">Z_as_Int</span>)(<span class="id" title="var">X</span>).<br/>
</div>
    <div id="sidebarWrapper">
      <div id="sidebar">
        <div class="block">
          <h2 class="title">Navigation</h2>
          <div class="content">
            <ul class="menu">
              <li class="leaf">Standard Library
                <ul class="menu">
                  <li><a href="index.html">Table of contents</a></li>
                  <li><a href="genindex.html">Index</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="footer">
    <div id="nav-footer">
      <ul class="links-menu-footer">
        <li><a href="mailto:coq-www_@_inria.fr">webmaster</a></li>
        <li><a href="http://validator.w3.org/">xhtml valid</a></li>
        <li><a href="http://jigsaw.w3.org/css-validator/">CSS valid</a></li>
      </ul>
    </div>
  </div>

</div>

</body>
</html>
