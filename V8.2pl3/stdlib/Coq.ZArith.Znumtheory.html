<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>Standard Library | The Coq Proof Assistant</title>

<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<style type="text/css" media="all">@import "/modules/node/node.css";</style>

<style type="text/css" media="all">@import "/modules/system/defaults.css";</style>
<style type="text/css" media="all">@import "/modules/system/system.css";</style>
<style type="text/css" media="all">@import "/modules/user/user.css";</style>

<style type="text/css" media="all">@import "/sites/all/themes/coq/style.css";</style>
<style type="text/css" media="all">@import "/sites/all/themes/coq/coqdoc.css";</style>

</head>

<body>

<div id="container">
<div id="headertop">
<div id="nav">
  <ul class="links-menu">
    <li><a href="http://coq.inria.fr/" class="active">Home</a></li>

    <li><a href="http://coq.inria.fr/about-coq" title="More about coq">About Coq</a></li>    
    <li><a href="http://coq.inria.fr/download">Get Coq</a></li>
    <li><a href="http://coq.inria.fr/documentation">Documentation</a></li>
    <li><a href="http://coq.inria.fr/community">Community</a></li>
  </ul>
</div>
</div>

<div id="header">

<div id="logoWrapper">

<div id="logo"><a href="http://coq.inria.fr/" title="Home"><img src="/files/barron_logo.png" alt="Home" /></a>
</div>
<div id="siteName"><a href="http://coq.inria.fr/" title="Home">The Coq Proof Assistant</a>
</div>

</div>
</div>

<div id="content">

<h1 class="libtitle">Library Coq.ZArith.Znumtheory</h1>

<div class="code">

<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.ZArith.ZArith_base.html#"><span class="id" type="library">ZArith_base</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.2pl2/stdlib/Coq.setoid_ring.ZArithRing.html#"><span class="id" type="library">ZArithRing</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.ZArith.Zcomplements.html#"><span class="id" type="library">Zcomplements</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.ZArith.Zdiv.html#"><span class="id" type="library">Zdiv</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.Arith.Wf_nat.html#"><span class="id" type="library">Wf_nat</span></a>.<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Local</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">Z_scope</span>.<br/>

<br/>
</div>

<div class="doc">
This file contains some notions of number theory upon Z numbers: 

<ul>
<li> a divisibility predicate <span class="inlinecode"><span class="id" type="var">Zdivide</span></span>

</li>
<li> a gcd predicate <span class="inlinecode"><span class="id" type="var">gcd</span></span>

</li>
<li> Euclid algorithm <span class="inlinecode"><span class="id" type="var">euclid</span></span>

</li>
<li> a relatively prime predicate <span class="inlinecode"><span class="id" type="var">rel_prime</span></span>

</li>
<li> a prime predicate <span class="inlinecode"><span class="id" type="var">prime</span></span>

</li>
<li> an efficient <span class="inlinecode"><span class="id" type="var">Zgcd</span></span> function 

</li>
</ul>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
<a name="lab249"></a><h1 class="section">Divisibility</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Zdivide"><span class="id" type="inductive">Zdivide</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Zdivide_intro"><span class="id" type="constructor">Zdivide_intro</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">q</span>:Z, <span class="id" type="var">b</span> = <span class="id" type="var">q</span> * <span class="id" type="var">a</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide"><span class="id" type="inductive">Zdivide</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
Syntax for divisibility 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Notation</span> "( a | b )" := (<a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide"><span class="id" type="inductive">Zdivide</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>) (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 0) : <span class="id" type="var">Z_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Results concerning divisibility
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_refl"><span class="id" type="lemma">Zdivide_refl</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zone_divide"><span class="id" type="lemma">Zone_divide</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>:Z, (1 | <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_0"><span class="id" type="lemma">Zdivide_0</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>:Z, (<span class="id" type="var">a</span> | 0).<br/>

<br/>
<span class="id" type="keyword">Hint</span> <span class="id" type="keyword">Resolve</span> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_refl"><span class="id" type="lemma">Zdivide_refl</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zone_divide"><span class="id" type="lemma">Zone_divide</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_0"><span class="id" type="lemma">Zdivide_0</span></a>: <span class="id" type="var">zarith</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zmult_divide_compat_l"><span class="id" type="lemma">Zmult_divide_compat_l</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">c</span> * <span class="id" type="var">a</span> | <span class="id" type="var">c</span> * <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zmult_divide_compat_r"><span class="id" type="lemma">Zmult_divide_compat_r</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">a</span> * <span class="id" type="var">c</span> | <span class="id" type="var">b</span> * <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Hint</span> <span class="id" type="keyword">Resolve</span> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zmult_divide_compat_l"><span class="id" type="lemma">Zmult_divide_compat_l</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zmult_divide_compat_r"><span class="id" type="lemma">Zmult_divide_compat_r</span></a>: <span class="id" type="var">zarith</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_plus_r"><span class="id" type="lemma">Zdivide_plus_r</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">c</span>) -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span> + <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_opp_r"><span class="id" type="lemma">Zdivide_opp_r</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">a</span> | - <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_opp_r_rev"><span class="id" type="lemma">Zdivide_opp_r_rev</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (<span class="id" type="var">a</span> | - <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_opp_l"><span class="id" type="lemma">Zdivide_opp_l</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (- <span class="id" type="var">a</span> | <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_opp_l_rev"><span class="id" type="lemma">Zdivide_opp_l_rev</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (- <span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_minus_l"><span class="id" type="lemma">Zdivide_minus_l</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">c</span>) -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span> - <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_mult_l"><span class="id" type="lemma">Zdivide_mult_l</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span> * <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_mult_r"><span class="id" type="lemma">Zdivide_mult_r</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">c</span>) -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span> * <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_factor_r"><span class="id" type="lemma">Zdivide_factor_r</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">a</span> * <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_factor_l"><span class="id" type="lemma">Zdivide_factor_l</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span> * <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Hint</span> <span class="id" type="keyword">Resolve</span> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_plus_r"><span class="id" type="lemma">Zdivide_plus_r</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_opp_r"><span class="id" type="lemma">Zdivide_opp_r</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_opp_r_rev"><span class="id" type="lemma">Zdivide_opp_r_rev</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_opp_l"><span class="id" type="lemma">Zdivide_opp_l</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_opp_l_rev"><span class="id" type="lemma">Zdivide_opp_l_rev</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_minus_l"><span class="id" type="lemma">Zdivide_minus_l</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_mult_l"><span class="id" type="lemma">Zdivide_mult_l</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_mult_r"><span class="id" type="lemma">Zdivide_mult_r</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_factor_r"><span class="id" type="lemma">Zdivide_factor_r</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zdivide_factor_l"><span class="id" type="lemma">Zdivide_factor_l</span></a>: <span class="id" type="var">zarith</span>.<br/>

<br/>
</div>

<div class="doc">
Auxiliary result. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zmult_one"><span class="id" type="lemma">Zmult_one</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>:Z, <span class="id" type="var">x</span> &gt;= 0 -&gt; <span class="id" type="var">x</span> * <span class="id" type="var">y</span> = 1 -&gt; <span class="id" type="var">x</span> = 1.<br/>

<br/>
</div>

<div class="doc">
Only <span class="inlinecode">1</span> and <span class="inlinecode">-1</span> divide <span class="inlinecode">1</span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_1"><span class="id" type="lemma">Zdivide_1</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>:Z, (<span class="id" type="var">x</span> | 1) -&gt; <span class="id" type="var">x</span> = 1 \/ <span class="id" type="var">x</span> = -1.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" type="var">a</span></span> divides <span class="inlinecode"><span class="id" type="var">b</span></span> and <span class="inlinecode"><span class="id" type="var">b</span></span> divides <span class="inlinecode"><span class="id" type="var">a</span></span> then <span class="inlinecode"><span class="id" type="var">a</span></span> is <span class="inlinecode"><span class="id" type="var">b</span></span> or <span class="inlinecode">-b</span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_antisym"><span class="id" type="lemma">Zdivide_antisym</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">b</span> | <span class="id" type="var">a</span>) -&gt; <span class="id" type="var">a</span> = <span class="id" type="var">b</span> \/ <span class="id" type="var">a</span> = - <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zdivide_trans"><span class="id" type="lemma">Zdivide_trans</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">b</span> | <span class="id" type="var">c</span>) -&gt;  (<span class="id" type="var">a</span> | <span class="id" type="var">c</span>).<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" type="var">a</span></span> divides <span class="inlinecode"><span class="id" type="var">b</span></span> and <span class="inlinecode"><span class="id" type="var">b</span>&lt;&gt;0</span> then <span class="inlinecode">|a| &lt;= |b|</span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_bounds"><span class="id" type="lemma">Zdivide_bounds</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; <span class="id" type="var">b</span> &lt;&gt; 0 -&gt; <a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">a</span> &lt;= <a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" type="var">Zdivide</span></span> can be expressed using <span class="inlinecode"><span class="id" type="var">Zmod</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zmod_divide"><span class="id" type="lemma">Zmod_divide</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, <span class="id" type="var">b</span> &gt; 0 -&gt; <span class="id" type="var">a</span> <span class="id" type="var">mod</span> <span class="id" type="var">b</span> = 0 -&gt; (<span class="id" type="var">b</span> | <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_mod"><span class="id" type="lemma">Zdivide_mod</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, <span class="id" type="var">b</span> &gt; 0 -&gt; (<span class="id" type="var">b</span> | <span class="id" type="var">a</span>) -&gt; <span class="id" type="var">a</span> <span class="id" type="var">mod</span> <span class="id" type="var">b</span> = 0.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" type="var">Zdivide</span></span> is hence decidable 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_dec"><span class="id" type="lemma">Zdivide_dec</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, {(<span class="id" type="var">a</span> | <span class="id" type="var">b</span>)} + {~ (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>)}.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zdivide_Zdiv_eq"><span class="id" type="lemma">Zdivide_Zdiv_eq</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;0 &lt; <span class="id" type="var">a</span> -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt;  <span class="id" type="var">b</span> = <span class="id" type="var">a</span> * (<span class="id" type="var">b</span> / <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zdivide_Zdiv_eq_2"><span class="id" type="lemma">Zdivide_Zdiv_eq_2</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;0 &lt; <span class="id" type="var">a</span> -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">c</span> * <span class="id" type="var">b</span>)/a = <span class="id" type="var">c</span> * (<span class="id" type="var">b</span> / <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zdivide_Zabs_l"><span class="id" type="lemma">Zdivide_Zabs_l</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, (<a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt;  (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zdivide_Zabs_inv_l"><span class="id" type="lemma">Zdivide_Zabs_inv_l</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt;  (<a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">a</span> | <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zdivide_le"><span class="id" type="lemma">Zdivide_le</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;0 &lt;= <span class="id" type="var">a</span> -&gt; 0 &lt; <span class="id" type="var">b</span> -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt;  <span class="id" type="var">a</span> &lt;= <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zdivide_Zdiv_lt_pos"><span class="id" type="lemma">Zdivide_Zdiv_lt_pos</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;1 &lt; <span class="id" type="var">a</span> -&gt; 0 &lt; <span class="id" type="var">b</span> -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">b</span>) -&gt;  0 &lt; <span class="id" type="var">b</span> / <span class="id" type="var">a</span> &lt; <span class="id" type="var">b</span> .<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zmod_div_mod"><span class="id" type="lemma">Zmod_div_mod</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> <span class="id" type="var">a</span>, 0 &lt; <span class="id" type="var">n</span> -&gt; 0 &lt; <span class="id" type="var">m</span> -&gt;<br/>
&nbsp;(<span class="id" type="var">n</span> | <span class="id" type="var">m</span>) -&gt; <span class="id" type="var">a</span> <span class="id" type="var">mod</span> <span class="id" type="var">n</span> = (<span class="id" type="var">a</span> <span class="id" type="var">mod</span> <span class="id" type="var">m</span>) <span class="id" type="var">mod</span> <span class="id" type="var">n</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zmod_divide_minus"><span class="id" type="lemma">Zmod_divide_minus</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, 0 &lt; <span class="id" type="var">b</span> -&gt; <br/>
&nbsp;<span class="id" type="var">a</span> <span class="id" type="var">mod</span> <span class="id" type="var">b</span> = <span class="id" type="var">c</span> -&gt; (<span class="id" type="var">b</span> | <span class="id" type="var">a</span> - <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zdivide_mod_minus"><span class="id" type="lemma">Zdivide_mod_minus</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, 0 &lt;= <span class="id" type="var">c</span> &lt; <span class="id" type="var">b</span> -&gt; <br/>
&nbsp;(<span class="id" type="var">b</span> | <span class="id" type="var">a</span> - <span class="id" type="var">c</span>) -&gt; <span class="id" type="var">a</span> <span class="id" type="var">mod</span> <span class="id" type="var">b</span> = <span class="id" type="var">c</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab250"></a><h1 class="section">Greatest common divisor (gcd).</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
There is no unicity of the gcd; hence we define the predicate <span class="inlinecode"><span class="id" type="var">gcd</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span></span> 
     expressing that <span class="inlinecode"><span class="id" type="var">d</span></span> is a gcd of <span class="inlinecode"><span class="id" type="var">a</span></span> and <span class="inlinecode"><span class="id" type="var">b</span></span>. 
     (We show later that the <span class="inlinecode"><span class="id" type="var">gcd</span></span> is actually unique if we discard its sign.) 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>:Z) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="Zis_gcd_intro"><span class="id" type="constructor">Zis_gcd_intro</span></a> :<br/>
&nbsp;&nbsp;(<span class="id" type="var">d</span> | <span class="id" type="var">a</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id" type="var">d</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="keyword">forall</span> <span class="id" type="var">x</span>:Z, (<span class="id" type="var">x</span> | <span class="id" type="var">a</span>) -&gt; (<span class="id" type="var">x</span> | <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">x</span> | <span class="id" type="var">d</span>)) -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>.<br/>

<br/>
</div>

<div class="doc">
Trivial properties of <span class="inlinecode"><span class="id" type="var">gcd</span></span> 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_sym"><span class="id" type="lemma">Zis_gcd_sym</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">b</span> <span class="id" type="var">a</span> <span class="id" type="var">d</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_0"><span class="id" type="lemma">Zis_gcd_0</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> 0 <span class="id" type="var">a</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_1"><span class="id" type="lemma">Zis_gcd_1</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> 1 1.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_refl"><span class="id" type="lemma">Zis_gcd_refl</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">a</span> <span class="id" type="var">a</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_minus"><span class="id" type="lemma">Zis_gcd_minus</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> (- <span class="id" type="var">b</span>) <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">b</span> <span class="id" type="var">a</span> <span class="id" type="var">d</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_opp"><span class="id" type="lemma">Zis_gcd_opp</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">b</span> <span class="id" type="var">a</span> (- <span class="id" type="var">d</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_0_abs"><span class="id" type="lemma">Zis_gcd_0_abs</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> 0 <span class="id" type="var">a</span> (<a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Hint</span> <span class="id" type="keyword">Resolve</span> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd_sym"><span class="id" type="lemma">Zis_gcd_sym</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd_0"><span class="id" type="lemma">Zis_gcd_0</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd_minus"><span class="id" type="lemma">Zis_gcd_minus</span></a> <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd_opp"><span class="id" type="lemma">Zis_gcd_opp</span></a>: <span class="id" type="var">zarith</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zis_gcd_unique"><span class="id" type="lemma">Zis_gcd_unique</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt;  <span class="id" type="var">c</span> = <span class="id" type="var">d</span> \/ <span class="id" type="var">c</span> = (- <span class="id" type="var">d</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab251"></a><h1 class="section">Extended Euclid algorithm.</h1>

</div>
<div class="code">

<br/>
</div>

<div class="doc">
Euclid's algorithm to compute the <span class="inlinecode"><span class="id" type="var">gcd</span></span> mainly relies on
    the following property. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_for_euclid"><span class="id" type="lemma">Zis_gcd_for_euclid</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> <span class="id" type="var">q</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">b</span> (<span class="id" type="var">a</span> - <span class="id" type="var">q</span> * <span class="id" type="var">b</span>) <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_for_euclid2"><span class="id" type="lemma">Zis_gcd_for_euclid2</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> <span class="id" type="var">q</span> <span class="id" type="var">r</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">r</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">b</span> (<span class="id" type="var">b</span> * <span class="id" type="var">q</span> + <span class="id" type="var">r</span>) <span class="id" type="var">d</span>.<br/>

<br/>
</div>

<div class="doc">
We implement the extended version of Euclid's algorithm,
    i.e. the one computing Bezout's coefficients as it computes
    the <span class="inlinecode"><span class="id" type="var">gcd</span></span>. We follow the algorithm given in Knuth's
    "Art of Computer Programming", vol 2, page 325. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Section</span> <a name="extended_euclid_algorithm"><span class="id" type="section">extended_euclid_algorithm</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Variables</span> <a name="extended_euclid_algorithm.a"><span class="id" type="variable">a</span></a> <a name="extended_euclid_algorithm.b"><span class="id" type="variable">b</span></a> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>.<br/>

<br/>
</div>

<div class="doc">
The specification of Euclid's algorithm is the existence of
      <span class="inlinecode"><span class="id" type="var">u</span></span>, <span class="inlinecode"><span class="id" type="var">v</span></span> and <span class="inlinecode"><span class="id" type="var">d</span></span> such that <span class="inlinecode"><span class="id" type="var">ua</span>+vb=d</span> and <span class="inlinecode">(<span class="id" type="var">gcd</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>)</span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Inductive</span> <a name="Euclid"><span class="id" type="inductive">Euclid</span></a> : <span class="id" type="keyword">Set</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a name="Euclid_intro"><span class="id" type="constructor">Euclid_intro</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span> <span class="id" type="var">d</span>:Z, <span class="id" type="var">u</span> * <span class="id" type="var">a</span> + <span class="id" type="var">v</span> * <span class="id" type="var">b</span> = <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Euclid"><span class="id" type="inductive">Euclid</span></a>.<br/>

<br/>
</div>

<div class="doc">
The recursive part of Euclid's algorithm uses well-founded
      recursion of non-negative integers. It maintains 6 integers
      <span class="inlinecode"><span class="id" type="var">u1</span>,u2,u3,v1,v2,v3</span> such that the following invariant holds:
      <span class="inlinecode"><span class="id" type="var">u1</span>*a+u2*b=u3</span> and <span class="inlinecode"><span class="id" type="var">v1</span>*a+v2*b=v3</span> and <span class="inlinecode"><span class="id" type="var">gcd</span>(<span class="id" type="var">u2</span>,v3)=gcd(a,b)</span>. 
      
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="euclid_rec"><span class="id" type="lemma">euclid_rec</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">v3</span>:Z,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= <span class="id" type="var">v3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">u1</span> <span class="id" type="var">u2</span> <span class="id" type="var">u3</span> <span class="id" type="var">v1</span> <span class="id" type="var">v2</span>:Z,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">u1</span> * <span class="id" type="var">a</span> + <span class="id" type="var">u2</span> * <span class="id" type="var">b</span> = <span class="id" type="var">u3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">v1</span> * <span class="id" type="var">a</span> + <span class="id" type="var">v2</span> * <span class="id" type="var">b</span> = <span class="id" type="var">v3</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">forall</span> <span class="id" type="var">d</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">u3</span> <span class="id" type="var">v3</span> <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>) -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Euclid"><span class="id" type="inductive">Euclid</span></a>.<br/>

<br/>
</div>

<div class="doc">
We get Euclid's algorithm by applying <span class="inlinecode"><span class="id" type="var">euclid_rec</span></span> on
      <span class="inlinecode">1,0,a,0,1,b</span> when <span class="inlinecode"><span class="id" type="var">b</span>&gt;=0</span> and <span class="inlinecode">1,0,a,0,-1,-b</span> when <span class="inlinecode"><span class="id" type="var">b</span>&lt;0</span>. 
</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" type="keyword">Lemma</span> <a name="euclid"><span class="id" type="lemma">euclid</span></a> : <a class="idref" href="Coq.ZArith.Znumtheory.html#Euclid"><span class="id" type="inductive">Euclid</span></a>.<br/>

<br/>
<span class="id" type="keyword">End</span> <a class="idref" href="Coq.ZArith.Znumtheory.html#extended_euclid_algorithm"><span class="id" type="section">extended_euclid_algorithm</span></a>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zis_gcd_uniqueness_apart_sign"><span class="id" type="lemma">Zis_gcd_uniqueness_apart_sign</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> <span class="id" type="var">d'</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d'</span> -&gt; <span class="id" type="var">d</span> = <span class="id" type="var">d'</span> \/ <span class="id" type="var">d</span> = - <span class="id" type="var">d'</span>.<br/>

<br/>
</div>

<div class="doc">
<a name="lab252"></a><h1 class="section">Bezout's coefficients</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="Bezout"><span class="id" type="inductive">Bezout</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>:Z) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="Bezout_intro"><span class="id" type="constructor">Bezout_intro</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">u</span> <span class="id" type="var">v</span>:Z, <span class="id" type="var">u</span> * <span class="id" type="var">a</span> + <span class="id" type="var">v</span> * <span class="id" type="var">b</span> = <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Bezout"><span class="id" type="inductive">Bezout</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>.<br/>

<br/>
</div>

<div class="doc">
Existence of Bezout's coefficients for the <span class="inlinecode"><span class="id" type="var">gcd</span></span> of <span class="inlinecode"><span class="id" type="var">a</span></span> and <span class="inlinecode"><span class="id" type="var">b</span></span> 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_bezout"><span class="id" type="lemma">Zis_gcd_bezout</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Bezout"><span class="id" type="inductive">Bezout</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span>.<br/>

<br/>
</div>

<div class="doc">
gcd of <span class="inlinecode"><span class="id" type="var">ca</span></span> and <span class="inlinecode"><span class="id" type="var">cb</span></span> is <span class="inlinecode"><span class="id" type="var">c</span> <span class="id" type="var">gcd</span>(<span class="id" type="var">a</span>,b)</span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_mult"><span class="id" type="lemma">Zis_gcd_mult</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">d</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> (<span class="id" type="var">c</span> * <span class="id" type="var">a</span>) (<span class="id" type="var">c</span> * <span class="id" type="var">b</span>) (<span class="id" type="var">c</span> * <span class="id" type="var">d</span>).<br/>

<br/>
</div>

<div class="doc">
<a name="lab253"></a><h1 class="section">Relative primality</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="rel_prime"><span class="id" type="definition">rel_prime</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z) : <span class="id" type="keyword">Prop</span> := <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> 1.<br/>

<br/>
</div>

<div class="doc">
Bezout's theorem: <span class="inlinecode"><span class="id" type="var">a</span></span> and <span class="inlinecode"><span class="id" type="var">b</span></span> are relatively prime if and
    only if there exist <span class="inlinecode"><span class="id" type="var">u</span></span> and <span class="inlinecode"><span class="id" type="var">v</span></span> such that <span class="inlinecode"><span class="id" type="var">ua</span>+vb = 1</span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="rel_prime_bezout"><span class="id" type="lemma">rel_prime_bezout</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Bezout"><span class="id" type="inductive">Bezout</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> 1.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="bezout_rel_prime"><span class="id" type="lemma">bezout_rel_prime</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#Bezout"><span class="id" type="inductive">Bezout</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> 1 -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
Gauss's theorem: if <span class="inlinecode"><span class="id" type="var">a</span></span> divides <span class="inlinecode"><span class="id" type="var">bc</span></span> and if <span class="inlinecode"><span class="id" type="var">a</span></span> and <span class="inlinecode"><span class="id" type="var">b</span></span> are
    relatively prime, then <span class="inlinecode"><span class="id" type="var">a</span></span> divides <span class="inlinecode"><span class="id" type="var">c</span></span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Gauss"><span class="id" type="lemma">Gauss</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">b</span> * <span class="id" type="var">c</span>) -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt; (<span class="id" type="var">a</span> | <span class="id" type="var">c</span>).<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" type="var">a</span></span> is relatively prime to <span class="inlinecode"><span class="id" type="var">b</span></span> and <span class="inlinecode"><span class="id" type="var">c</span></span>, then it is to <span class="inlinecode"><span class="id" type="var">bc</span></span> 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="rel_prime_mult"><span class="id" type="lemma">rel_prime_mult</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">c</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> (<span class="id" type="var">b</span> * <span class="id" type="var">c</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="rel_prime_cross_prod"><span class="id" type="lemma">rel_prime_cross_prod</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span>:Z,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">c</span> <span class="id" type="var">d</span> -&gt; <span class="id" type="var">b</span> &gt; 0 -&gt; <span class="id" type="var">d</span> &gt; 0 -&gt; <span class="id" type="var">a</span> * <span class="id" type="var">d</span> = <span class="id" type="var">b</span> * <span class="id" type="var">c</span> -&gt; <span class="id" type="var">a</span> = <span class="id" type="var">c</span> /\ <span class="id" type="var">b</span> = <span class="id" type="var">d</span>.<br/>

<br/>
</div>

<div class="doc">
After factorization by a gcd, the original numbers are relatively prime. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_rel_prime"><span class="id" type="lemma">Zis_gcd_rel_prime</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">g</span>:Z,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">b</span> &gt; 0 -&gt; <span class="id" type="var">g</span> &gt;= 0 -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">g</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> (<span class="id" type="var">a</span> / <span class="id" type="var">g</span>) (<span class="id" type="var">b</span> / <span class="id" type="var">g</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="rel_prime_sym"><span class="id" type="lemma">rel_prime_sym</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">b</span> <span class="id" type="var">a</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="rel_prime_div"><span class="id" type="lemma">rel_prime_div</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> <span class="id" type="var">r</span>, <br/>
&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">p</span> <span class="id" type="var">q</span> -&gt; (<span class="id" type="var">r</span> | <span class="id" type="var">p</span>) -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">r</span> <span class="id" type="var">q</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="rel_prime_1"><span class="id" type="lemma">rel_prime_1</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> 1 <span class="id" type="var">n</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="not_rel_prime_0"><span class="id" type="lemma">not_rel_prime_0</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span>, 1 &lt; <span class="id" type="var">n</span> -&gt; ~ <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> 0 <span class="id" type="var">n</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="rel_prime_mod"><span class="id" type="lemma">rel_prime_mod</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span>, 0 &lt; <span class="id" type="var">q</span> -&gt; <br/>
&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">p</span> <span class="id" type="var">q</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> (<span class="id" type="var">p</span> <span class="id" type="var">mod</span> <span class="id" type="var">q</span>) <span class="id" type="var">q</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="rel_prime_mod_rev"><span class="id" type="lemma">rel_prime_mod_rev</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span>, 0 &lt; <span class="id" type="var">q</span> -&gt; <br/>
&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> (<span class="id" type="var">p</span> <span class="id" type="var">mod</span> <span class="id" type="var">q</span>) <span class="id" type="var">q</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">p</span> <span class="id" type="var">q</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zrel_prime_neq_mod_0"><span class="id" type="lemma">Zrel_prime_neq_mod_0</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, 1 &lt; <span class="id" type="var">b</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt; <span class="id" type="var">a</span> <span class="id" type="var">mod</span> <span class="id" type="var">b</span> &lt;&gt; 0.<br/>

<br/>
</div>

<div class="doc">
<a name="lab254"></a><h1 class="section">Primality</h1>

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Inductive</span> <a name="prime"><span class="id" type="inductive">prime</span></a> (<span class="id" type="var">p</span>:Z) : <span class="id" type="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<a name="prime_intro"><span class="id" type="constructor">prime_intro</span></a> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;1 &lt; <span class="id" type="var">p</span> -&gt; (<span class="id" type="keyword">forall</span> <span class="id" type="var">n</span>:Z, 1 &lt;= <span class="id" type="var">n</span> &lt; <span class="id" type="var">p</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">n</span> <span class="id" type="var">p</span>) -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span>.<br/>

<br/>
</div>

<div class="doc">
The sole divisors of a prime number <span class="inlinecode"><span class="id" type="var">p</span></span> are <span class="inlinecode">-1</span>, <span class="inlinecode">1</span>, <span class="inlinecode"><span class="id" type="var">p</span></span> and <span class="inlinecode">-p</span>. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="prime_divisors"><span class="id" type="lemma">prime_divisors</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>:Z,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>:Z, (<span class="id" type="var">a</span> | <span class="id" type="var">p</span>) -&gt; <span class="id" type="var">a</span> = -1 \/ <span class="id" type="var">a</span> = 1 \/ <span class="id" type="var">a</span> = <span class="id" type="var">p</span> \/ <span class="id" type="var">a</span> = - <span class="id" type="var">p</span>.<br/>

<br/>
</div>

<div class="doc">
A prime number is relatively prime with any number it does not divide 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="prime_rel_prime"><span class="id" type="lemma">prime_rel_prime</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>:Z, ~ (<span class="id" type="var">p</span> | <span class="id" type="var">a</span>) -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">p</span> <span class="id" type="var">a</span>.<br/>

<br/>
<span class="id" type="keyword">Hint</span> <span class="id" type="keyword">Resolve</span> <a class="idref" href="Coq.ZArith.Znumtheory.html#prime_rel_prime"><span class="id" type="lemma">prime_rel_prime</span></a>: <span class="id" type="var">zarith</span>.<br/>

<br/>
</div>

<div class="doc">
As a consequence, a prime number is relatively prime with smaller numbers 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="rel_prime_le_prime"><span class="id" type="lemma">rel_prime_le_prime</span></a>:<br/>
&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">p</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> -&gt; 1 &lt;=  <span class="id" type="var">a</span> &lt; <span class="id" type="var">p</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">p</span>.<br/>

<br/>
</div>

<div class="doc">
If a prime <span class="inlinecode"><span class="id" type="var">p</span></span> divides <span class="inlinecode"><span class="id" type="var">ab</span></span> then it divides either <span class="inlinecode"><span class="id" type="var">a</span></span> or <span class="inlinecode"><span class="id" type="var">b</span></span> 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="prime_mult"><span class="id" type="lemma">prime_mult</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>:Z, <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> -&gt; <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>:Z, (<span class="id" type="var">p</span> | <span class="id" type="var">a</span> * <span class="id" type="var">b</span>) -&gt; (<span class="id" type="var">p</span> | <span class="id" type="var">a</span>) \/ (<span class="id" type="var">p</span> | <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="not_prime_0"><span class="id" type="lemma">not_prime_0</span></a>: ~ <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> 0.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="not_prime_1"><span class="id" type="lemma">not_prime_1</span></a>: ~ <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> 1.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="prime_2"><span class="id" type="lemma">prime_2</span></a>: <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> 2.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="prime_3"><span class="id" type="lemma">prime_3</span></a>: <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> 3.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="prime_ge_2"><span class="id" type="lemma">prime_ge_2</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> -&gt;  2 &lt;= <span class="id" type="var">p</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="prime'"><span class="id" type="definition">prime'</span></a> <span class="id" type="var">p</span> := 1&lt;p /\ (<span class="id" type="keyword">forall</span> <span class="id" type="var">n</span>, 1&lt;n&lt;p -&gt; ~ (<span class="id" type="var">n</span>|p)).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="prime_alt"><span class="id" type="lemma">prime_alt</span></a>: <br/>
&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#prime'"><span class="id" type="definition">prime'</span></a> <span class="id" type="var">p</span> &lt;-&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="square_not_prime"><span class="id" type="lemma">square_not_prime</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span>, ~ <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> (<span class="id" type="var">a</span> * <span class="id" type="var">a</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="prime_div_prime"><span class="id" type="lemma">prime_div_prime</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span>, <br/>
&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">q</span> -&gt; (<span class="id" type="var">p</span> | <span class="id" type="var">q</span>) -&gt; <span class="id" type="var">p</span> = <span class="id" type="var">q</span>.<br/>

<br/>
</div>

<div class="doc">
We could obtain a <span class="inlinecode"><span class="id" type="var">Zgcd</span></span> function via Euclid algorithm. But we propose 
  here a binary version of <span class="inlinecode"><span class="id" type="var">Zgcd</span></span>, faster and executable within Coq.

<br/> <br/>
   Algorithm: 

<br/> <br/>
   gcd 0 b = b
   gcd a 0 = a
   gcd (2a) (2b) = 2(gcd a b)
   gcd (2a+1) (2b) = gcd (2a+1) b
   gcd (2a) (2b+1) = gcd a (2b+1)
   gcd (2a+1) (2b+1) = gcd (b-a) (2*a+1)
                    or gcd (a-b) (2*b+1), depending on whether a&lt;b 

</div>
<div class="code">

<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">positive_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="Pgcdn"><span class="id" type="definition">Pgcdn</span></a> (<span class="id" type="var">n</span>: <a class="idref" href="Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Coq.NArith.BinPos.html#positive"><span class="id" type="inductive">positive</span></a>) { <span class="id" type="keyword">struct</span> <span class="id" type="var">n</span> } : <a class="idref" href="Coq.NArith.BinPos.html#positive"><span class="id" type="inductive">positive</span></a> := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#O"><span class="id" type="constructor">O</span></a> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">a</span>,b <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.NArith.BinPos.html#xH"><span class="id" type="constructor">xH</span></a>, <span class="id" type="var">_</span> =&gt; 1 <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <a class="idref" href="Coq.NArith.BinPos.html#xH"><span class="id" type="constructor">xH</span></a> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">b</span> =&gt; <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcdn"><span class="id" type="definition">Pgcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">a</span>, <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">b</span> =&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcdn"><span class="id" type="definition">Pgcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">a</span>, <span class="id" type="var">b</span> =&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcdn"><span class="id" type="definition">Pgcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.NArith.BinPos.html#xI"><span class="id" type="constructor">xI</span></a> <span class="id" type="var">a'</span>, <a class="idref" href="Coq.NArith.BinPos.html#xI"><span class="id" type="constructor">xI</span></a> <span class="id" type="var">b'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Coq.NArith.BinPos.html#Pcompare"><span class="id" type="definition">Pcompare</span></a> <span class="id" type="var">a'</span> <span class="id" type="var">b'</span> <a class="idref" href="Coq.Init.Datatypes.html#Eq"><span class="id" type="constructor">Eq</span></a> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Eq"><span class="id" type="constructor">Eq</span></a> =&gt; <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Lt"><span class="id" type="constructor">Lt</span></a> =&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcdn"><span class="id" type="definition">Pgcdn</span></a>  <span class="id" type="var">n</span> (<span class="id" type="var">b'</span>-a') <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Gt"><span class="id" type="constructor">Gt</span></a> =&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcdn"><span class="id" type="definition">Pgcdn</span></a> <span class="id" type="var">n</span> (<span class="id" type="var">a'</span>-b') <span class="id" type="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Pgcd"><span class="id" type="definition">Pgcd</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span>: <a class="idref" href="Coq.NArith.BinPos.html#positive"><span class="id" type="inductive">positive</span></a>) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcdn"><span class="id" type="definition">Pgcdn</span></a> (<a class="idref" href="Coq.NArith.BinPos.html#Psize"><span class="id" type="definition">Psize</span></a> <span class="id" type="var">a</span> + <a class="idref" href="Coq.NArith.BinPos.html#Psize"><span class="id" type="definition">Psize</span></a> <span class="id" type="var">b</span>)%nat <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="var">Close</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">positive_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Zgcd"><span class="id" type="definition">Zgcd</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>) : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">a</span>,b <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Z0"><span class="id" type="constructor">Z0</span></a>, <span class="id" type="var">_</span> =&gt; <a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">b</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Z0"><span class="id" type="constructor">Z0</span></a> =&gt; <a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">b</span> =&gt; <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcd"><span class="id" type="definition">Pgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">b</span> =&gt; <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcd"><span class="id" type="definition">Pgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">b</span> =&gt; <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcd"><span class="id" type="definition">Pgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">b</span> =&gt; <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcd"><span class="id" type="definition">Pgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zgcd_is_pos"><span class="id" type="lemma">Zgcd_is_pos</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, 0 &lt;= <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zis_gcd_even_odd"><span class="id" type="lemma">Zis_gcd_even_odd</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">g</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">a</span>) (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.NArith.BinPos.html#xI"><span class="id" type="constructor">xI</span></a> <span class="id" type="var">b</span>)) <span class="id" type="var">g</span> -&gt; <br/>
&nbsp;&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">a</span>)) (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.NArith.BinPos.html#xI"><span class="id" type="constructor">xI</span></a> <span class="id" type="var">b</span>)) <span class="id" type="var">g</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Pgcdn_correct"><span class="id" type="lemma">Pgcdn_correct</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, (<a class="idref" href="Coq.NArith.BinPos.html#Psize"><span class="id" type="definition">Psize</span></a> <span class="id" type="var">a</span> + <a class="idref" href="Coq.NArith.BinPos.html#Psize"><span class="id" type="definition">Psize</span></a> <span class="id" type="var">b</span>&lt;=n)%nat -&gt; <br/>
&nbsp;&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">a</span>) (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">b</span>) (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcdn"><span class="id" type="definition">Pgcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Pgcd_correct"><span class="id" type="lemma">Pgcd_correct</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">a</span>) (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">b</span>) (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcd"><span class="id" type="definition">Pgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>)).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zgcd_is_gcd"><span class="id" type="lemma">Zgcd_is_gcd</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zgcd_spec"><span class="id" type="lemma">Zgcd_spec</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, {<span class="id" type="var">z</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a> | <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> /\ 0 &lt;= <span class="id" type="var">z</span>}.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zdivide_Zgcd"><span class="id" type="lemma">Zdivide_Zgcd</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span> <span class="id" type="var">q</span> <span class="id" type="var">r</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;(<span class="id" type="var">p</span> | <span class="id" type="var">q</span>) -&gt; (<span class="id" type="var">p</span> | <span class="id" type="var">r</span>) -&gt; (<span class="id" type="var">p</span> | <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">q</span> <span class="id" type="var">r</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zis_gcd_gcd"><span class="id" type="lemma">Zis_gcd_gcd</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;0 &lt;= <span class="id" type="var">c</span> -&gt;  <a class="idref" href="Coq.ZArith.Znumtheory.html#Zis_gcd"><span class="id" type="inductive">Zis_gcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> = <span class="id" type="var">c</span>.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zgcd_inv_0_l"><span class="id" type="lemma">Zgcd_inv_0_l</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> = 0 -&gt; <span class="id" type="var">x</span> = 0.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zgcd_inv_0_r"><span class="id" type="lemma">Zgcd_inv_0_r</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> = 0 -&gt; <span class="id" type="var">y</span> = 0.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zgcd_div_swap0"><span class="id" type="lemma">Zgcd_div_swap0</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;0 &lt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt;<br/>
&nbsp;0 &lt; <span class="id" type="var">b</span> -&gt;<br/>
&nbsp;(<span class="id" type="var">a</span> / <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>) * <span class="id" type="var">b</span> = <span class="id" type="var">a</span> * (<span class="id" type="var">b</span>/Zgcd <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zgcd_div_swap"><span class="id" type="lemma">Zgcd_div_swap</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>, <br/>
&nbsp;0 &lt; <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> -&gt;<br/>
&nbsp;0 &lt; <span class="id" type="var">b</span> -&gt;<br/>
&nbsp;(<span class="id" type="var">c</span> * <span class="id" type="var">a</span>) / <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> * <span class="id" type="var">b</span> = <span class="id" type="var">c</span> * <span class="id" type="var">a</span> * (<span class="id" type="var">b</span>/Zgcd <span class="id" type="var">a</span> <span class="id" type="var">b</span>).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zgcd_1_rel_prime"><span class="id" type="lemma">Zgcd_1_rel_prime</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <br/>
&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> = 1 &lt;-&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="rel_prime_dec"><span class="id" type="definition">rel_prime_dec</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <br/>
&nbsp;{ <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> }+{ ~ <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> }.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="prime_dec_aux"><span class="id" type="definition">prime_dec_aux</span></a>:<br/>
&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">p</span> <span class="id" type="var">m</span>,<br/>
&nbsp;&nbsp;{ <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span>, 1 &lt; <span class="id" type="var">n</span> &lt; <span class="id" type="var">m</span> -&gt; <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">n</span> <span class="id" type="var">p</span> } +<br/>
&nbsp;&nbsp;{ <span class="id" type="var">exists</span> <span class="id" type="var">n</span>, 1 &lt; <span class="id" type="var">n</span> &lt; <span class="id" type="var">m</span>  /\ ~ <a class="idref" href="Coq.ZArith.Znumtheory.html#rel_prime"><span class="id" type="definition">rel_prime</span></a> <span class="id" type="var">n</span> <span class="id" type="var">p</span> }.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="prime_dec"><span class="id" type="definition">prime_dec</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>, { <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> }+{ ~ <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> }.<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="not_prime_divide"><span class="id" type="lemma">not_prime_divide</span></a>:<br/>
&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">p</span>, 1 &lt; <span class="id" type="var">p</span> -&gt; ~ <a class="idref" href="Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <span class="id" type="var">p</span> -&gt; <span class="id" type="var">exists</span> <span class="id" type="var">n</span>, 1 &lt; <span class="id" type="var">n</span> &lt; <span class="id" type="var">p</span>  /\ (<span class="id" type="var">n</span> | <span class="id" type="var">p</span>).<br/>

<br/>
</div>

<div class="doc">
A Generalized Gcd that also computes Bezout coefficients.
   The algorithm is the same as for Zgcd. 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">positive_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Fixpoint</span> <a name="Pggcdn"><span class="id" type="definition">Pggcdn</span></a> (<span class="id" type="var">n</span>: <a class="idref" href="Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>) (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Coq.NArith.BinPos.html#positive"><span class="id" type="inductive">positive</span></a>) { <span class="id" type="keyword">struct</span> <span class="id" type="var">n</span> } : (<a class="idref" href="Coq.NArith.BinPos.html#positive"><span class="id" type="inductive">positive</span></a>*(positive*positive)) := <br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#O"><span class="id" type="constructor">O</span></a> =&gt; (1,(a,b))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">n</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">a</span>,b <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.NArith.BinPos.html#xH"><span class="id" type="constructor">xH</span></a>, <span class="id" type="var">b</span> =&gt; (1,(1,b)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">a</span>, <a class="idref" href="Coq.NArith.BinPos.html#xH"><span class="id" type="constructor">xH</span></a> =&gt; (1,(a,1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">b</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcdn"><span class="id" type="definition">Pggcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">g</span>,p)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">a</span>, <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">b</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcdn"><span class="id" type="definition">Pggcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">g</span>,(aa, <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">bb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">a</span>, <span class="id" type="var">b</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcdn"><span class="id" type="definition">Pggcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">g</span>,(xO <span class="id" type="var">aa</span>, <span class="id" type="var">bb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.NArith.BinPos.html#xI"><span class="id" type="constructor">xI</span></a> <span class="id" type="var">a'</span>, <a class="idref" href="Coq.NArith.BinPos.html#xI"><span class="id" type="constructor">xI</span></a> <span class="id" type="var">b'</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <a class="idref" href="Coq.NArith.BinPos.html#Pcompare"><span class="id" type="definition">Pcompare</span></a> <span class="id" type="var">a'</span> <span class="id" type="var">b'</span> <a class="idref" href="Coq.Init.Datatypes.html#Eq"><span class="id" type="constructor">Eq</span></a> <span class="id" type="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Eq"><span class="id" type="constructor">Eq</span></a> =&gt; (<span class="id" type="var">a</span>,(1,1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Lt"><span class="id" type="constructor">Lt</span></a> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcdn"><span class="id" type="definition">Pggcdn</span></a> <span class="id" type="var">n</span> (<span class="id" type="var">b'</span>-a') <span class="id" type="var">a</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">ba</span>,aa) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">g</span>,(aa, <span class="id" type="var">aa</span> + <a class="idref" href="Coq.NArith.BinPos.html#xO"><span class="id" type="constructor">xO</span></a> <span class="id" type="var">ba</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Gt"><span class="id" type="constructor">Gt</span></a> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcdn"><span class="id" type="definition">Pggcdn</span></a> <span class="id" type="var">n</span> (<span class="id" type="var">a'</span>-b') <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">ab</span>,bb) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">g</span>,(bb+xO <span class="id" type="var">ab</span>, <span class="id" type="var">bb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Pggcd"><span class="id" type="definition">Pggcd</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span>: <a class="idref" href="Coq.NArith.BinPos.html#positive"><span class="id" type="inductive">positive</span></a>) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcdn"><span class="id" type="definition">Pggcdn</span></a> (<a class="idref" href="Coq.NArith.BinPos.html#Psize"><span class="id" type="definition">Psize</span></a> <span class="id" type="var">a</span> + <a class="idref" href="Coq.NArith.BinPos.html#Psize"><span class="id" type="definition">Psize</span></a> <span class="id" type="var">b</span>)%nat <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">Z_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="Zggcd"><span class="id" type="definition">Zggcd</span></a> (<span class="id" type="var">a</span> <span class="id" type="var">b</span> : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>) : <a class="idref" href="Coq.ZArith.BinInt.html#Z"><span class="id" type="inductive">Z</span></a>*(Z*Z) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">a</span>,b <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Z0"><span class="id" type="constructor">Z0</span></a>, <span class="id" type="var">_</span> =&gt; (<a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">b</span>,(0, <a class="idref" href="Coq.ZArith.BinInt.html#Zsgn"><span class="id" type="definition">Zsgn</span></a> <span class="id" type="var">b</span>)) <br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Z0"><span class="id" type="constructor">Z0</span></a> =&gt; (<a class="idref" href="Coq.ZArith.BinInt.html#Zabs"><span class="id" type="definition">Zabs</span></a> <span class="id" type="var">a</span>,(Zsgn <span class="id" type="var">a</span>, 0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">b</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcd"><span class="id" type="definition">Pggcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">g</span>, (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">aa</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">bb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">b</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcd"><span class="id" type="definition">Pggcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">g</span>, (<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">aa</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">bb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">b</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcd"><span class="id" type="definition">Pggcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">g</span>, (<a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">aa</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">bb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">a</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">b</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcd"><span class="id" type="definition">Pggcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="Coq.ZArith.BinInt.html#Zpos"><span class="id" type="constructor">Zpos</span></a> <span class="id" type="var">g</span>, (<a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">aa</span>, <a class="idref" href="Coq.ZArith.BinInt.html#Zneg"><span class="id" type="constructor">Zneg</span></a> <span class="id" type="var">bb</span>))<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Pggcdn_gcdn"><span class="id" type="lemma">Pggcdn_gcdn</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcdn"><span class="id" type="definition">Pggcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>) = <a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcdn"><span class="id" type="definition">Pgcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Pggcd_gcd"><span class="id" type="lemma">Pggcd_gcd</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <a class="idref" href="Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcd"><span class="id" type="definition">Pggcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>) = <a class="idref" href="Coq.ZArith.Znumtheory.html#Pgcd"><span class="id" type="definition">Pgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zggcd_gcd"><span class="id" type="lemma">Zggcd_gcd</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <a class="idref" href="Coq.Init.Datatypes.html#fst"><span class="id" type="definition">fst</span></a> (<a class="idref" href="Coq.ZArith.Znumtheory.html#Zggcd"><span class="id" type="definition">Zggcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>) = <a class="idref" href="Coq.ZArith.Znumtheory.html#Zgcd"><span class="id" type="definition">Zgcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span>.<br/>

<br/>
<span class="id" type="keyword">Open</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">positive_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Pggcdn_correct_divisors"><span class="id" type="lemma">Pggcdn_correct_divisors</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcdn"><span class="id" type="definition">Pggcdn</span></a> <span class="id" type="var">n</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb):=p <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;(<span class="id" type="var">a</span>=g*aa) /\ (<span class="id" type="var">b</span>=g*bb).<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Pggcd_correct_divisors"><span class="id" type="lemma">Pggcd_correct_divisors</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Pggcd"><span class="id" type="definition">Pggcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb):=p <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;(<span class="id" type="var">a</span>=g*aa) /\ (<span class="id" type="var">b</span>=g*bb).<br/>

<br/>
<span class="id" type="var">Close</span> <span class="id" type="keyword">Scope</span> <span class="id" type="var">positive_scope</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zggcd_correct_divisors"><span class="id" type="lemma">Zggcd_correct_divisors</span></a> : <span class="id" type="keyword">forall</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, <br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">g</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Zggcd"><span class="id" type="definition">Zggcd</span></a> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">aa</span>,bb):=p <span class="id" type="keyword">in</span> <br/>
&nbsp;&nbsp;(<span class="id" type="var">a</span>=g*aa) /\ (<span class="id" type="var">b</span>=g*bb).<br/>

<br/>
<span class="id" type="keyword">Theorem</span> <a name="Zggcd_opp"><span class="id" type="lemma">Zggcd_opp</span></a>: <span class="id" type="keyword">forall</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, <br/>
&nbsp;&nbsp;<a class="idref" href="Coq.ZArith.Znumtheory.html#Zggcd"><span class="id" type="definition">Zggcd</span></a> (-x) <span class="id" type="var">y</span> = <span class="id" type="keyword">let</span> (<span class="id" type="var">p1</span>,p) := <a class="idref" href="Coq.ZArith.Znumtheory.html#Zggcd"><span class="id" type="definition">Zggcd</span></a> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">p2</span>,p3) := <span class="id" type="var">p</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">p1</span>,(-p2,p3)).<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><div id="sidebarWrapper">
<div id="sidebar">

<div class="block">
<h2 class="title">Navigation</h2>
<div class="content">

<ul class="menu">

<li class="leaf">Standard Library
  <ul class="menu">
  <li><a href="index.html">Table of contents</a></li>
  <li><a href="genindex.html">Index</a></li>
  </ul>
</li>

</ul>

</div>
</div>

</div>
</div>


</div>

</div>

<div id="footer">
<div id="nav-footer">
  <ul class="links-menu-footer">
    <li><a href="mailto:www-coq at lix.polytechnique.fr">webmaster</a></li>
    <li><a href="http://validator.w3.org/check?uri=referer">xhtml valid</a></li>
    <li><a href="http://jigsaw.w3.org/css-validator/check/referer">CSS valid</a></li>
  </ul>

</div>
</div>

</div>

</body>
</html>

