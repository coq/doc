<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ltac_pretype (coq-core.Ltac_pretype)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">coq-core</a> &#x00BB; Ltac_pretype</nav><header class="odoc-preamble"><h1>Module <code><span>Ltac_pretype</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#maps-of-pattern-variables">Maps of pattern variables</a></li></ul></nav><div class="odoc-content"><h6 id="maps-of-pattern-variables"><a href="#maps-of-pattern-variables" class="anchor"></a>Maps of pattern variables</h6><p>Type <code>constr_under_binders</code> is for representing the term resulting of a matching. Matching can return terms defined in a some context of named binders; in the context, variable names are ordered by (&lt;) and referred to by index in the term Thanks to the canonical ordering, a matching problem like</p><p><code>match ... with [(fun x y =&gt; ?p,fun y x =&gt; ?p)] =&gt; [forall x y =&gt; p]</code></p><p>will be accepted. Thanks to the reference by index, a matching problem like</p><p><code>match ... with [(fun x =&gt; ?p)] =&gt; [forall x =&gt; p]</code></p><p>will work even if <code>x</code> is also the name of an existing goal variable.</p><p>Note: we do not keep types in the signature. Besides simplicity, the main reason is that it would force to close the signature over binders that occur only in the types of effective binders but not in the term itself (e.g. for a term <code>f x</code> with <code>f:A -&gt; True</code> and <code>x:A</code>).</p><p>On the opposite side, by not keeping the types, we loose opportunity to propagate type informations which otherwise would not be inferable, as e.g. when matching <code>forall x, x = 0</code> with pattern <code>forall x, ?h = 0</code> and using the solution &quot;x|-h:=x&quot; in expression <code>forall x, h = x</code> where nothing tells how the type of x could be inferred. We also loose the ability of typing ltac variables before calling the right-hand-side of ltac matching clauses.</p><div class="odoc-spec"><div class="spec type" id="type-constr_under_binders" class="anchored"><a href="#type-constr_under_binders" class="anchor"></a><code><span><span class="keyword">type</span> constr_under_binders</span><span> = <span><a href="../Names/Id/index.html#type-t">Names.Id.t</a> list</span> * <a href="../EConstr/index.html#type-constr">EConstr.constr</a></span></code></div></div><p>Types of substitutions with or w/o bound variables</p><div class="odoc-spec"><div class="spec type" id="type-patvar_map" class="anchored"><a href="#type-patvar_map" class="anchor"></a><code><span><span class="keyword">type</span> patvar_map</span><span> = <span><a href="../EConstr/index.html#type-constr">EConstr.constr</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-extended_patvar_map" class="anchored"><a href="#type-extended_patvar_map" class="anchor"></a><code><span><span class="keyword">type</span> extended_patvar_map</span><span> = <span><a href="#type-constr_under_binders">constr_under_binders</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-closure" class="anchored"><a href="#type-closure" class="anchor"></a><code><span><span class="keyword">type</span> closure</span><span> = </span><span>{</span></code><table><tr id="type-closure.idents" class="anchored"><td class="def record field"><a href="#type-closure.idents" class="anchor"></a><code><span>idents : <span><a href="../Names/Id/index.html#type-t">Names.Id.t</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span>;</span></code></td></tr><tr id="type-closure.typed" class="anchored"><td class="def record field"><a href="#type-closure.typed" class="anchor"></a><code><span>typed : <span><a href="#type-constr_under_binders">constr_under_binders</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span>;</span></code></td></tr><tr id="type-closure.untyped" class="anchored"><td class="def record field"><a href="#type-closure.untyped" class="anchor"></a><code><span>untyped : <span><a href="#type-closed_glob_constr">closed_glob_constr</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span>;</span></code></td></tr><tr id="type-closure.genargs" class="anchored"><td class="def record field"><a href="#type-closure.genargs" class="anchor"></a><code><span>genargs : <span><a href="../Geninterp/Val/index.html#type-t">Geninterp.Val.t</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span>;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>A globalised term together with a closure representing the value of its free variables. Intended for use when these variables are taken from the Ltac environment.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-closed_glob_constr" class="anchored"><a href="#type-closed_glob_constr" class="anchor"></a><code><span><span class="keyword">and</span> closed_glob_constr</span><span> = </span><span>{</span></code><table><tr id="type-closed_glob_constr.closure" class="anchored"><td class="def record field"><a href="#type-closed_glob_constr.closure" class="anchor"></a><code><span>closure : <a href="#type-closure">closure</a>;</span></code></td></tr><tr id="type-closed_glob_constr.term" class="anchored"><td class="def record field"><a href="#type-closed_glob_constr.term" class="anchor"></a><code><span>term : <a href="../Glob_term/index.html#type-glob_constr">Glob_term.glob_constr</a>;</span></code></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-var_map" class="anchored"><a href="#type-var_map" class="anchor"></a><code><span><span class="keyword">type</span> var_map</span><span> = <span><a href="#type-constr_under_binders">constr_under_binders</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span></span></code></div><div class="spec-doc"><p>Ltac variable maps</p></div></div><div class="odoc-spec"><div class="spec type" id="type-uconstr_var_map" class="anchored"><a href="#type-uconstr_var_map" class="anchor"></a><code><span><span class="keyword">type</span> uconstr_var_map</span><span> = <span><a href="#type-closed_glob_constr">closed_glob_constr</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-unbound_ltac_var_map" class="anchored"><a href="#type-unbound_ltac_var_map" class="anchor"></a><code><span><span class="keyword">type</span> unbound_ltac_var_map</span><span> = <span><a href="../Geninterp/Val/index.html#type-t">Geninterp.Val.t</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span></span></code></div></div><div class="odoc-spec"><div class="spec type" id="type-ltac_var_map" class="anchored"><a href="#type-ltac_var_map" class="anchor"></a><code><span><span class="keyword">type</span> ltac_var_map</span><span> = </span><span>{</span></code><table><tr id="type-ltac_var_map.ltac_constrs" class="anchored"><td class="def record field"><a href="#type-ltac_var_map.ltac_constrs" class="anchor"></a><code><span>ltac_constrs : <a href="#type-var_map">var_map</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Ltac variables bound to constrs</p><span class="comment-delim">*)</span></td></tr><tr id="type-ltac_var_map.ltac_uconstrs" class="anchored"><td class="def record field"><a href="#type-ltac_var_map.ltac_uconstrs" class="anchor"></a><code><span>ltac_uconstrs : <a href="#type-uconstr_var_map">uconstr_var_map</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Ltac variables bound to untyped constrs</p><span class="comment-delim">*)</span></td></tr><tr id="type-ltac_var_map.ltac_idents" class="anchored"><td class="def record field"><a href="#type-ltac_var_map.ltac_idents" class="anchor"></a><code><span>ltac_idents : <span><a href="../Names/Id/index.html#type-t">Names.Id.t</a> <a href="../Names/Id/Map/index.html#type-t">Names.Id.Map.t</a></span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Ltac variables bound to identifiers</p><span class="comment-delim">*)</span></td></tr><tr id="type-ltac_var_map.ltac_genargs" class="anchored"><td class="def record field"><a href="#type-ltac_var_map.ltac_genargs" class="anchor"></a><code><span>ltac_genargs : <a href="#type-unbound_ltac_var_map">unbound_ltac_var_map</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>All Ltac variables (to pass on ltac subterms, and for error reporting)</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div></div></div></body></html>