<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Tac2externals (coq-core.Ltac2_plugin.Tac2externals)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">coq-core</a> &#x00BB; <a href="../index.html">Ltac2_plugin</a> &#x00BB; Tac2externals</nav><header class="odoc-preamble"><h1>Module <code><span>Ltac2_plugin.Tac2externals</span></code></h1><p>Interface for defining external tactics via a high-level spec.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-spec" class="anchored"><a href="#type-spec" class="anchor"></a><code><span><span class="keyword">type</span> <span>(_, _) spec</span></span></code></div><div class="spec-doc"><p>Type <code>('v,'f) spec</code> represents a high-level Ltac2 tactic specification. It indicates how to turn a value of type <code>'f</code> into an Ltac2 tactic, which may involve converting between OCaml and Ltac2 value representations, and also lifting a pure function to the tactic monad. The type parameter <code>'v</code> gives the type of value produced by interpreting the specification.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-tac" class="anchored"><a href="#val-tac" class="anchor"></a><code><span><span class="keyword">val</span> tac : <span><span><span class="type-var">'r</span> <a href="../Tac2ffi/index.html#type-repr">Tac2ffi.repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>, <span><span class="type-var">'r</span> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>tac r</code> is the specification of a tactic (in the tactic monad sense) whose return type is specified (and converted into an Ltac2 value) via <code>r</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-tac'" class="anchored"><a href="#val-tac'" class="anchor"></a><code><span><span class="keyword">val</span> tac' : <span><span>(<span><span class="type-var">'r</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>, <span><span class="type-var">'r</span> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>tac'</code> is similar to <code>tac</code>, but only needs a conversion function.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ret" class="anchored"><a href="#val-ret" class="anchor"></a><code><span><span class="keyword">val</span> ret : <span><span><span class="type-var">'r</span> <a href="../Tac2ffi/index.html#type-repr">Tac2ffi.repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>, <span class="type-var">'r</span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>ret r</code> is the specification of a pure tactic (i.e., a tactic defined as a pure OCaml value, not needing the tactic monad) whose return type is given by <code>r</code> (see <code>tac</code>).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-ret'" class="anchored"><a href="#val-ret'" class="anchor"></a><code><span><span class="keyword">val</span> ret' : <span><span>(<span><span class="type-var">'r</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>, <span class="type-var">'r</span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>ret'</code> is similar to <code>ret</code>, but only needs a conversion function.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-eret" class="anchored"><a href="#val-eret" class="anchor"></a><code><span><span class="keyword">val</span> eret : <span><span><span class="type-var">'r</span> <a href="../Tac2ffi/index.html#type-repr">Tac2ffi.repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>, <span><a href="../../Environ/index.html#type-env">Environ.env</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Evd/index.html#type-evar_map">Evd.evar_map</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>eret</code> is similar to <code>ret</code>, but for tactics that can be implemented with a pure OCaml value, provided extra arguments <code>env</code> and <code>sigma</code>, computed via <code>tclENV</code> and <code>tclEVARMAP</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-eret'" class="anchored"><a href="#val-eret'" class="anchor"></a><code><span><span class="keyword">val</span> eret' : <span><span>(<span><span class="type-var">'r</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>, <span><a href="../../Environ/index.html#type-env">Environ.env</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="../../Evd/index.html#type-evar_map">Evd.evar_map</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>eret'</code> is similar to <code>eret</code>, but only needs a conversion function.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-gret" class="anchored"><a href="#val-gret" class="anchor"></a><code><span><span class="keyword">val</span> gret : <span><span><span class="type-var">'r</span> <a href="../Tac2ffi/index.html#type-repr">Tac2ffi.repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>, <span><a href="../../Proofview/Goal/index.html#type-t">Proofview.Goal.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>gret</code> is similar to <code>ret</code>, but for tactics that can be implemented with a pure OCaml value, provided the current goal <code>g</code> as extra argument. A fatal error is produced when there is not exactly one goal in focus at the point of using an Ltac2 value defined with this specification. Indeed, the value of <code>g</code> is computed using <code>Goal.enter_one</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-gret'" class="anchored"><a href="#val-gret'" class="anchor"></a><code><span><span class="keyword">val</span> gret' : <span><span>(<span><span class="type-var">'r</span> <span class="arrow">&#45;&gt;</span></span> <a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <a href="../../Proofview/index.html#type-tactic">Proofview.tactic</a></span>, <span><a href="../../Proofview/Goal/index.html#type-t">Proofview.Goal.t</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'r</span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>gret'</code> is similar to <code>gret</code>, but only needs a conversion function.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-(@-&gt;)" class="anchored"><a href="#val-(@-&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (@-&gt;) : <span><span><span class="type-var">'a</span> <a href="../Tac2ffi/index.html#type-repr">Tac2ffi.repr</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'t</span>, <span class="type-var">'f</span>)</span> <a href="#type-spec">spec</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'t</span>, <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'f</span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>r @-&gt; s</code> extends the specification <code>s</code> with a closure argument whose type is specified by (and converted from an Ltac2 value via) <code>r</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-(@--&gt;)" class="anchored"><a href="#val-(@--&gt;)" class="anchor"></a><code><span><span class="keyword">val</span> (@--&gt;) : <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>)</span> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">'t</span>, <span class="type-var">'f</span>)</span> <a href="#type-spec">spec</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(<span><a href="../Tac2ffi/index.html#type-valexpr">Tac2ffi.valexpr</a> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'t</span>, <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'f</span>)</span> <a href="#type-spec">spec</a></span></span></code></div><div class="spec-doc"><p><code>(@--&gt;)</code> is similar to <code>(@-&gt;)</code>, but only needs a conversion function.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-define" class="anchored"><a href="#val-define" class="anchor"></a><code><span><span class="keyword">val</span> define : <span><a href="../Tac2expr/index.html#type-ml_tactic_name">Tac2expr.ml_tactic_name</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span>(<span class="type-var">_</span>, <span class="type-var">'f</span>)</span> <a href="#type-spec">spec</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'f</span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>define tac s f</code> defines an external tactic <code>tac</code> by interpreting <code>f</code> with the specification <code>s</code>. The <code>Invalid_argument</code> exception is raised when the given <code>s</code> does not produce a &quot;pure&quot; tactic, that is, something that can be turned into an Ltac2 value (i.e., a closure, or a pure value).</p></div></div></div></body></html>