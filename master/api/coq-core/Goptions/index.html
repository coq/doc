<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Goptions (coq-core.Goptions)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.2"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">coq-core</a> &#x00BB; Goptions</nav><h1>Module <code>Goptions</code></h1><p>This module manages customization parameters at the vernacular level</p><nav class="toc"><ul><li><a href="#tables.">Tables.</a></li><li><a href="#options.">Options.</a></li><li><a href="#special-functions-supposed-to-be-used-only-in-vernacentries.ml">Special functions supposed to be used only in vernacentries.ml</a></li></ul></nav></header><aside><p>Two kinds of things are managed : tables and options value</p><ul><li>Tables are created by applying the <code>MakeTable</code> functor.</li><li>Variables storing options value are created by applying one of the <code>declare_int_option</code>, <code>declare_bool_option</code>, ... functions.</li></ul><p>Each table/option is uniquely identified by a key of type <code>option_name</code> which consists in a list of strings. Note that for parsing constraints, table names must not be made of more than 2 strings while option names can be of arbitrary length.</p><p>The declaration of a table, say of name <code>[&quot;Toto&quot;;&quot;Titi&quot;]</code> automatically makes available the following vernacular commands:</p><p>Add Toto Titi foo. Remove Toto Titi foo. Print Toto Titi. Test Toto Titi.</p><p>The declaration of a non boolean option value, say of name <code>[&quot;Tata&quot;;&quot;Tutu&quot;;&quot;Titi&quot;]</code>, automatically makes available the following vernacular commands:</p><p>Set Tata Tutu Titi val. Print Table Tata Tutu Titi.</p><p>If it is the declaration of a boolean value, the following vernacular commands are made available:</p><p>Set Tata Tutu Titi. Unset Tata Tutu Titi. Print Table Tata Tutu Titi. (** synonym: Test Table Tata Tutu Titi. *)</p><p>All options are synchronized with the document.</p></aside><dl><dt class="spec type" id="type-option_name"><a href="#type-option_name" class="anchor"></a><code><span class="keyword">type</span> option_name</code><code> = <span>string list</span></code></dt><dt class="spec type" id="type-option_locality"><a href="#type-option_locality" class="anchor"></a><code><span class="keyword">type</span> option_locality</code><code> = </code><table class="variant"><tr id="type-option_locality.OptDefault" class="anchored"><td class="def constructor"><a href="#type-option_locality.OptDefault" class="anchor"></a><code>| </code><code><span class="constructor">OptDefault</span></code></td></tr><tr id="type-option_locality.OptLocal" class="anchored"><td class="def constructor"><a href="#type-option_locality.OptLocal" class="anchor"></a><code>| </code><code><span class="constructor">OptLocal</span></code></td></tr><tr id="type-option_locality.OptExport" class="anchored"><td class="def constructor"><a href="#type-option_locality.OptExport" class="anchor"></a><code>| </code><code><span class="constructor">OptExport</span></code></td></tr><tr id="type-option_locality.OptGlobal" class="anchored"><td class="def constructor"><a href="#type-option_locality.OptGlobal" class="anchor"></a><code>| </code><code><span class="constructor">OptGlobal</span></code></td></tr></table></dt></dl><section><header><h6 id="tables."><a href="#tables." class="anchor"></a>Tables.</h6></header><aside><p>The functor <code>MakeStringTable</code> declares a table containing objects of type <code>string</code>; the function <code>member_message</code> say what to print when invoking the &quot;Test Toto Titi foo.&quot; command; at the end <code>title</code> is the table name printed when invoking the &quot;Print Toto Titi.&quot; command; <code>active</code> is roughly the internal version of the vernacular &quot;Test ...&quot;: it tells if a given object is in the table; <code>elements</code> returns the list of elements of the table</p></aside><div class="spec module" id="module-MakeStringTable"><a href="#module-MakeStringTable" class="anchor"></a><code><span class="keyword">module</span> <a href="MakeStringTable/index.html">MakeStringTable</a> : <span class="keyword">functor</span> (<a href="MakeStringTable/argument-1-A/index.html">A</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div><aside><p>The functor <code>MakeRefTable</code> declares a new table of objects of type <code>A.t</code> practically denoted by <code>reference</code>; the encoding function <code>encode : env -&gt; reference -&gt; A.t</code> is typically a globalization function, possibly with some restriction checks; the function <code>member_message</code> say what to print when invoking the &quot;Test Toto Titi foo.&quot; command; at the end <code>title</code> is the table name printed when invoking the &quot;Print Toto Titi.&quot; command; <code>active</code> is roughly the internal version of the vernacular &quot;Test ...&quot;: it tells if a given object is in the table.</p></aside><div class="spec module" id="module-MakeRefTable"><a href="#module-MakeRefTable" class="anchor"></a><code><span class="keyword">module</span> <a href="MakeRefTable/index.html">MakeRefTable</a> : <span class="keyword">functor</span> (<a href="MakeRefTable/argument-1-A/index.html">A</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span>) <span>&#45;&gt;</span> <span class="keyword">sig</span> ... <span class="keyword">end</span></code></div></section><section><header><h6 id="options."><a href="#options." class="anchor"></a>Options.</h6></header><aside><p>These types and function are for declaring a new option of name <code>key</code> and access functions <code>read</code> and <code>write</code>; the parameter <code>name</code> is the option name used when printing the option value (command &quot;Print Toto Titi.&quot;</p><p>The declare_*_option functions are low-level, to be used when implementing complex option workflows, e.g. when setting one option changes the value of another. For most use cases, you should use the helper functions declare_*_option_and_ref.</p></aside><dl><dt class="spec type" id="type-option_sig"><a href="#type-option_sig" class="anchor"></a><code><span class="keyword">type</span> <span>'a option_sig</span></code><code> = </code><code>{</code><table class="record"><tr id="type-option_sig.optdepr" class="anchored"><td class="def field"><a href="#type-option_sig.optdepr" class="anchor"></a><code>optdepr : bool;</code></td><td class="doc"><p>whether the option is DEPRECATED</p></td></tr><tr id="type-option_sig.optkey" class="anchored"><td class="def field"><a href="#type-option_sig.optkey" class="anchor"></a><code>optkey : <a href="index.html#type-option_name">option_name</a>;</code></td><td class="doc"><p>the low-level name of this option</p></td></tr><tr id="type-option_sig.optread" class="anchored"><td class="def field"><a href="#type-option_sig.optread" class="anchor"></a><code>optread : unit <span>&#45;&gt;</span> <span class="type-var">'a</span>;</code></td></tr><tr id="type-option_sig.optwrite" class="anchored"><td class="def field"><a href="#type-option_sig.optwrite" class="anchor"></a><code>optwrite : <span class="type-var">'a</span> <span>&#45;&gt;</span> unit;</code></td></tr></table><code>}</code></dt></dl><aside><p>The <code>preprocess</code> function is triggered before setting the option. It can be used to emit a warning on certain values, and clean-up the final value.</p><p><code>declare_stringopt_option</code> should be preferred to <code>declare_string_option</code> because it supports &quot;Unset&quot;. Only &quot;Warnings&quot; option is declared using the latter.</p></aside><dl><dt class="spec value" id="val-declare_int_option"><a href="#val-declare_int_option" class="anchor"></a><code><span class="keyword">val</span> declare_int_option : <span>?&#8288;preprocess:<span>(<span>int option</span> <span>&#45;&gt;</span> <span>int option</span>)</span></span> <span>&#45;&gt;</span> <span><span>int option</span> <a href="index.html#type-option_sig">option_sig</a></span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-declare_bool_option"><a href="#val-declare_bool_option" class="anchor"></a><code><span class="keyword">val</span> declare_bool_option : <span>?&#8288;preprocess:<span>(bool <span>&#45;&gt;</span> bool)</span></span> <span>&#45;&gt;</span> <span>bool <a href="index.html#type-option_sig">option_sig</a></span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-declare_string_option"><a href="#val-declare_string_option" class="anchor"></a><code><span class="keyword">val</span> declare_string_option : <span>?&#8288;preprocess:<span>(string <span>&#45;&gt;</span> string)</span></span> <span>&#45;&gt;</span> <span>string <a href="index.html#type-option_sig">option_sig</a></span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-declare_stringopt_option"><a href="#val-declare_stringopt_option" class="anchor"></a><code><span class="keyword">val</span> declare_stringopt_option : <span>?&#8288;preprocess:<span>(<span>string option</span> <span>&#45;&gt;</span> <span>string option</span>)</span></span> <span>&#45;&gt;</span> <span><span>string option</span> <a href="index.html#type-option_sig">option_sig</a></span> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-opt_decl"><a href="#type-opt_decl" class="anchor"></a><code><span class="keyword">type</span> <span>'a opt_decl</span></code><code> = <span>depr:bool</span> <span>&#45;&gt;</span> <span>key:<a href="index.html#type-option_name">option_name</a></span> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dd><p>Helpers to declare a reference controlled by an option. Read-only as to avoid races.</p></dd></dl><dl><dt class="spec value" id="val-declare_int_option_and_ref"><a href="#val-declare_int_option_and_ref" class="anchor"></a><code><span class="keyword">val</span> declare_int_option_and_ref : <span><span>(<span>value:int</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> int)</span> <a href="index.html#type-opt_decl">opt_decl</a></span></code></dt><dt class="spec value" id="val-declare_intopt_option_and_ref"><a href="#val-declare_intopt_option_and_ref" class="anchor"></a><code><span class="keyword">val</span> declare_intopt_option_and_ref : <span><span>(unit <span>&#45;&gt;</span> <span>int option</span>)</span> <a href="index.html#type-opt_decl">opt_decl</a></span></code></dt><dt class="spec value" id="val-declare_nat_option_and_ref"><a href="#val-declare_nat_option_and_ref" class="anchor"></a><code><span class="keyword">val</span> declare_nat_option_and_ref : <span><span>(<span>value:int</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> int)</span> <a href="index.html#type-opt_decl">opt_decl</a></span></code></dt><dt class="spec value" id="val-declare_bool_option_and_ref"><a href="#val-declare_bool_option_and_ref" class="anchor"></a><code><span class="keyword">val</span> declare_bool_option_and_ref : <span><span>(<span>value:bool</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> bool)</span> <a href="index.html#type-opt_decl">opt_decl</a></span></code></dt><dt class="spec value" id="val-declare_string_option_and_ref"><a href="#val-declare_string_option_and_ref" class="anchor"></a><code><span class="keyword">val</span> declare_string_option_and_ref : <span><span>(<span>value:string</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> string)</span> <a href="index.html#type-opt_decl">opt_decl</a></span></code></dt><dt class="spec value" id="val-declare_stringopt_option_and_ref"><a href="#val-declare_stringopt_option_and_ref" class="anchor"></a><code><span class="keyword">val</span> declare_stringopt_option_and_ref : <span><span>(unit <span>&#45;&gt;</span> <span>string option</span>)</span> <a href="index.html#type-opt_decl">opt_decl</a></span></code></dt><dt class="spec value" id="val-declare_interpreted_string_option_and_ref"><a href="#val-declare_interpreted_string_option_and_ref" class="anchor"></a><code><span class="keyword">val</span> declare_interpreted_string_option_and_ref : <span><span>(<span>value:<span class="type-var">'a</span></span> <span>&#45;&gt;</span> <span>(string <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> string)</span> <span>&#45;&gt;</span> unit <span>&#45;&gt;</span> <span class="type-var">'a</span>)</span> <a href="index.html#type-opt_decl">opt_decl</a></span></code></dt></dl></section><section><header><h6 id="special-functions-supposed-to-be-used-only-in-vernacentries.ml"><a href="#special-functions-supposed-to-be-used-only-in-vernacentries.ml" class="anchor"></a>Special functions supposed to be used only in vernacentries.ml</h6></header><div class="spec module" id="module-OptionMap"><a href="#module-OptionMap" class="anchor"></a><code><span class="keyword">module</span> <a href="OptionMap/index.html">OptionMap</a> : <a href="../CSig/index.html#module-type-MapS">CSig.MapS</a> <span class="keyword">with</span> <span class="keyword">type</span> <a href="../CSig/module-type-MapS/index.html#type-key">key</a> = <a href="index.html#type-option_name">option_name</a></code></div><dl><dt class="spec type" id="type-table_of_A"><a href="#type-table_of_A" class="anchor"></a><code><span class="keyword">type</span> <span>'a table_of_A</span></code><code> = </code><code>{</code><table class="record"><tr id="type-table_of_A.add" class="anchored"><td class="def field"><a href="#type-table_of_A.add" class="anchor"></a><code>add : <a href="../Environ/index.html#type-env">Environ.env</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit;</code></td></tr><tr id="type-table_of_A.remove" class="anchored"><td class="def field"><a href="#type-table_of_A.remove" class="anchor"></a><code>remove : <a href="../Environ/index.html#type-env">Environ.env</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit;</code></td></tr><tr id="type-table_of_A.mem" class="anchored"><td class="def field"><a href="#type-table_of_A.mem" class="anchor"></a><code>mem : <a href="../Environ/index.html#type-env">Environ.env</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit;</code></td></tr><tr id="type-table_of_A.print" class="anchored"><td class="def field"><a href="#type-table_of_A.print" class="anchor"></a><code>print : unit <span>&#45;&gt;</span> unit;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-get_string_table"><a href="#val-get_string_table" class="anchor"></a><code><span class="keyword">val</span> get_string_table : <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> <span>string <a href="index.html#type-table_of_A">table_of_A</a></span></code></dt><dt class="spec value" id="val-get_ref_table"><a href="#val-get_ref_table" class="anchor"></a><code><span class="keyword">val</span> get_ref_table : <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> <span><a href="../Libnames/index.html#type-qualid">Libnames.qualid</a> <a href="index.html#type-table_of_A">table_of_A</a></span></code></dt><dt class="spec value" id="val-set_int_option_value_gen"><a href="#val-set_int_option_value_gen" class="anchor"></a><code><span class="keyword">val</span> set_int_option_value_gen : <span>?&#8288;locality:<a href="index.html#type-option_locality">option_locality</a></span> <span>&#45;&gt;</span> <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> <span>int option</span> <span>&#45;&gt;</span> unit</code></dt><dd><p>The first argument is a locality flag.</p></dd></dl><dl><dt class="spec value" id="val-set_bool_option_value_gen"><a href="#val-set_bool_option_value_gen" class="anchor"></a><code><span class="keyword">val</span> set_bool_option_value_gen : <span>?&#8288;locality:<a href="index.html#type-option_locality">option_locality</a></span> <span>&#45;&gt;</span> <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-set_string_option_value_gen"><a href="#val-set_string_option_value_gen" class="anchor"></a><code><span class="keyword">val</span> set_string_option_value_gen : <span>?&#8288;locality:<a href="index.html#type-option_locality">option_locality</a></span> <span>&#45;&gt;</span> <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-set_string_option_append_value_gen"><a href="#val-set_string_option_append_value_gen" class="anchor"></a><code><span class="keyword">val</span> set_string_option_append_value_gen : <span>?&#8288;locality:<a href="index.html#type-option_locality">option_locality</a></span> <span>&#45;&gt;</span> <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-unset_option_value_gen"><a href="#val-unset_option_value_gen" class="anchor"></a><code><span class="keyword">val</span> unset_option_value_gen : <span>?&#8288;locality:<a href="index.html#type-option_locality">option_locality</a></span> <span>&#45;&gt;</span> <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-set_int_option_value"><a href="#val-set_int_option_value" class="anchor"></a><code><span class="keyword">val</span> set_int_option_value : <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> <span>int option</span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-set_bool_option_value"><a href="#val-set_bool_option_value" class="anchor"></a><code><span class="keyword">val</span> set_bool_option_value : <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> bool <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-set_string_option_value"><a href="#val-set_string_option_value" class="anchor"></a><code><span class="keyword">val</span> set_string_option_value : <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-print_option_value"><a href="#val-print_option_value" class="anchor"></a><code><span class="keyword">val</span> print_option_value : <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> unit</code></dt></dl><dl><dt class="spec type" id="type-option_value"><a href="#type-option_value" class="anchor"></a><code><span class="keyword">type</span> option_value</code><code> = </code><table class="variant"><tr id="type-option_value.BoolValue" class="anchored"><td class="def constructor"><a href="#type-option_value.BoolValue" class="anchor"></a><code>| </code><code><span class="constructor">BoolValue</span> <span class="keyword">of</span> bool</code></td></tr><tr id="type-option_value.IntValue" class="anchored"><td class="def constructor"><a href="#type-option_value.IntValue" class="anchor"></a><code>| </code><code><span class="constructor">IntValue</span> <span class="keyword">of</span> <span>int option</span></code></td></tr><tr id="type-option_value.StringValue" class="anchored"><td class="def constructor"><a href="#type-option_value.StringValue" class="anchor"></a><code>| </code><code><span class="constructor">StringValue</span> <span class="keyword">of</span> string</code></td></tr><tr id="type-option_value.StringOptValue" class="anchored"><td class="def constructor"><a href="#type-option_value.StringOptValue" class="anchor"></a><code>| </code><code><span class="constructor">StringOptValue</span> <span class="keyword">of</span> <span>string option</span></code></td></tr></table></dt><dt class="spec type" id="type-table_value"><a href="#type-table_value" class="anchor"></a><code><span class="keyword">type</span> table_value</code><code> = </code><table class="variant"><tr id="type-table_value.StringRefValue" class="anchored"><td class="def constructor"><a href="#type-table_value.StringRefValue" class="anchor"></a><code>| </code><code><span class="constructor">StringRefValue</span> <span class="keyword">of</span> string</code></td></tr><tr id="type-table_value.QualidRefValue" class="anchored"><td class="def constructor"><a href="#type-table_value.QualidRefValue" class="anchor"></a><code>| </code><code><span class="constructor">QualidRefValue</span> <span class="keyword">of</span> <a href="../Libnames/index.html#type-qualid">Libnames.qualid</a></code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-set_option_value"><a href="#val-set_option_value" class="anchor"></a><code><span class="keyword">val</span> set_option_value : <span>?&#8288;locality:<a href="index.html#type-option_locality">option_locality</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <a href="index.html#type-option_value">option_value</a> <span>&#45;&gt;</span> <a href="index.html#type-option_value">option_value</a>)</span> <span>&#45;&gt;</span> <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dd><p><code>set_option_value ?locality f name v</code> sets <code>name</code> to the result of applying <code>f</code> to <code>v</code> and <code>name</code>'s current value. Use for behaviour depending on the type of the option, eg erroring when <code>'a</code> doesn't match it. Changing the type will result in errors later so don't do that.</p></dd></dl><dl><dt class="spec type" id="type-option_state"><a href="#type-option_state" class="anchor"></a><code><span class="keyword">type</span> option_state</code><code> = </code><code>{</code><table class="record"><tr id="type-option_state.opt_depr" class="anchored"><td class="def field"><a href="#type-option_state.opt_depr" class="anchor"></a><code>opt_depr : bool;</code></td></tr><tr id="type-option_state.opt_value" class="anchored"><td class="def field"><a href="#type-option_state.opt_value" class="anchor"></a><code>opt_value : <a href="index.html#type-option_value">option_value</a>;</code></td></tr></table><code>}</code></dt><dd><p>Summary of an option status</p></dd></dl><dl><dt class="spec value" id="val-get_tables"><a href="#val-get_tables" class="anchor"></a><code><span class="keyword">val</span> get_tables : unit <span>&#45;&gt;</span> <span><a href="index.html#type-option_state">option_state</a> <a href="OptionMap/index.html#type-t">OptionMap.t</a></span></code></dt><dt class="spec value" id="val-print_tables"><a href="#val-print_tables" class="anchor"></a><code><span class="keyword">val</span> print_tables : unit <span>&#45;&gt;</span> <a href="../Pp/index.html#type-t">Pp.t</a></code></dt></dl><dl><dt class="spec type" id="type-iter_table_aux"><a href="#type-iter_table_aux" class="anchor"></a><code><span class="keyword">type</span> iter_table_aux</code><code> = </code><code>{</code><table class="record"><tr id="type-iter_table_aux.aux" class="anchored"><td class="def field"><a href="#type-iter_table_aux.aux" class="anchor"></a><code>aux : a. <span><span class="type-var">'a</span> <a href="index.html#type-table_of_A">table_of_A</a></span> <span>&#45;&gt;</span> <a href="../Environ/index.html#type-env">Environ.env</a> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec value" id="val-iter_table"><a href="#val-iter_table" class="anchor"></a><code><span class="keyword">val</span> iter_table : <a href="index.html#type-iter_table_aux">iter_table_aux</a> <span>&#45;&gt;</span> <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> <span><a href="index.html#type-table_value">table_value</a> list</span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-error_undeclared_key"><a href="#val-error_undeclared_key" class="anchor"></a><code><span class="keyword">val</span> error_undeclared_key : <a href="index.html#type-option_name">option_name</a> <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt></dl></section></div></body></html>