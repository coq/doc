<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Summary (coq-core.Summary)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.1.1"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../index.html">coq-core</a> &#x00BB; Summary</nav><header class="odoc-preamble"><h1>Module <code><span>Summary</span></code></h1></header><div class="odoc-content"><div class="odoc-spec"><div class="spec module" id="module-Stage" class="anchored"><a href="#module-Stage" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Stage/index.html">Stage</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>This module registers the declaration of global tables, which will be kept in synchronization during the various backtracks of the system.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-summary_declaration" class="anchored"><a href="#type-summary_declaration" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a summary_declaration</span></span><span> = </span><span>{</span></code><table><tr id="type-summary_declaration.stage" class="anchored"><td class="def record field"><a href="#type-summary_declaration.stage" class="anchor"></a><code><span>stage : <a href="Stage/index.html#type-t">Stage.t</a>;</span></code></td></tr><tr id="type-summary_declaration.freeze_function" class="anchored"><td class="def record field"><a href="#type-summary_declaration.freeze_function" class="anchor"></a><code><span>freeze_function : <span>marshallable:bool <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>freeze_function <code>true</code> is for marshalling to disk. * e.g. lazy must be forced</p><span class="comment-delim">*)</span></td></tr><tr id="type-summary_declaration.unfreeze_function" class="anchored"><td class="def record field"><a href="#type-summary_declaration.unfreeze_function" class="anchor"></a><code><span>unfreeze_function : <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> unit;</span></code></td></tr><tr id="type-summary_declaration.init_function" class="anchored"><td class="def record field"><a href="#type-summary_declaration.init_function" class="anchor"></a><code><span>init_function : <span>unit <span class="arrow">&#45;&gt;</span></span> unit;</span></code></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>Types of global Coq states. The <code>'a</code> type should be pure and marshallable by the standard OCaml marshalling function.</p></div></div><p>For tables registered during the launch of coqtop, the <code>init_function</code> will be run only once, during an <code>init_summaries</code> done at the end of coqtop initialization. For tables registered later (for instance during a plugin dynlink), <code>init_function</code> is used when unfreezing an earlier frozen state that doesn't contain any value for this table.</p><p>Beware: for tables registered dynamically after the initialization of Coq, their init functions may not be run immediately. It is hence the responsibility of plugins to initialize themselves properly.</p><div class="odoc-spec"><div class="spec value" id="val-declare_summary" class="anchored"><a href="#val-declare_summary" class="anchor"></a><code><span><span class="keyword">val</span> declare_summary : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-summary_declaration">summary_declaration</a></span> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Dyn" class="anchored"><a href="#module-Dyn" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Dyn/index.html">Dyn</a></span><span> : <a href="../Dyn/module-type-S/index.html">Dyn.S</a></span></code></div><div class="spec-doc"><p>We provide safe projection from the summary to the types stored in it.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-declare_summary_tag" class="anchored"><a href="#val-declare_summary_tag" class="anchor"></a><code><span><span class="keyword">val</span> declare_summary_tag : <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-summary_declaration">summary_declaration</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <a href="Dyn/index.html#type-tag">Dyn.tag</a></span></span></code></div></div><p>All-in-one reference declaration + summary registration. It behaves just as OCaml's standard <code>ref</code> function, except that a <code>declare_summary</code> is done, with <code>name</code> as string. The <code>init_function</code> restores the reference to its initial value. The <code>freeze_function</code> can be overridden The <code>stage</code> argument defaults to <code>Interp</code> and should be changed to <code>Synterp</code> for references which are read from and written to during the syntactic interpretation.</p><div class="odoc-spec"><div class="spec value" id="val-ref" class="anchored"><a href="#val-ref" class="anchor"></a><code><span><span class="keyword">val</span> ref : 
  <span>?stage:<a href="Stage/index.html#type-t">Stage.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?freeze:<span>( <span>marshallable:bool <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>name:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="xref-unresolved">Stdlib</span>.ref</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-ref_tag" class="anchored"><a href="#val-ref_tag" class="anchor"></a><code><span><span class="keyword">val</span> ref_tag : 
  <span>?stage:<a href="Stage/index.html#type-t">Stage.t</a> <span class="arrow">&#45;&gt;</span></span>
  <span>?freeze:<span>( <span>marshallable:bool <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span> )</span> <span class="arrow">&#45;&gt;</span></span>
  <span>name:string <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span>
  <span><span class="type-var">'a</span> <span class="xref-unresolved">Stdlib</span>.ref</span> * <span><span class="type-var">'a</span> <a href="Dyn/index.html#type-tag">Dyn.tag</a></span></span></code></div></div><div class="odoc-spec"><div class="spec module" id="module-Local" class="anchored"><a href="#module-Local" class="anchor"></a><code><span><span class="keyword">module</span> <a href="Local/index.html">Local</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-declare_ml_modules_summary" class="anchored"><a href="#val-declare_ml_modules_summary" class="anchor"></a><code><span><span class="keyword">val</span> declare_ml_modules_summary : 
  <span><span><span><span>(<span>string option</span> * string)</span> list</span> <a href="#type-summary_declaration">summary_declaration</a></span> <span class="arrow">&#45;&gt;</span></span>
  unit</span></code></div><div class="spec-doc"><p>Special summary for ML modules. This summary entry is special because its unfreeze may load ML code and hence add summary entries. Thus is has to be recognizable, and handled properly.</p><p>The args correspond to Mltop.PluginSpec.t , that is to say, the optional legacy plugin name, and the findlib name for the plugin.</p></div></div><p>For global tables registered statically before the end of coqtop launch, the following empty <code>init_function</code> could be used.</p><div class="odoc-spec"><div class="spec value" id="val-nop" class="anchored"><a href="#val-nop" class="anchor"></a><code><span><span class="keyword">val</span> nop : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><p>The type <code>frozen</code> is a snapshot of the states of all the registered tables of the system.</p><div class="odoc-spec"><div class="spec type" id="type-frozen" class="anchored"><a href="#type-frozen" class="anchor"></a><code><span><span class="keyword">type</span> frozen</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-empty_frozen" class="anchored"><a href="#val-empty_frozen" class="anchor"></a><code><span><span class="keyword">val</span> empty_frozen : <a href="#type-frozen">frozen</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-freeze_summaries" class="anchored"><a href="#val-freeze_summaries" class="anchor"></a><code><span><span class="keyword">val</span> freeze_summaries : <span>marshallable:bool <span class="arrow">&#45;&gt;</span></span> <a href="#type-frozen">frozen</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-freeze_staged_summaries" class="anchored"><a href="#val-freeze_staged_summaries" class="anchor"></a><code><span><span class="keyword">val</span> freeze_staged_summaries : <span><a href="Stage/index.html#type-t">Stage.t</a> <span class="arrow">&#45;&gt;</span></span> <span>marshallable:bool <span class="arrow">&#45;&gt;</span></span> <a href="#type-frozen">frozen</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-unfreeze_summaries" class="anchored"><a href="#val-unfreeze_summaries" class="anchor"></a><code><span><span class="keyword">val</span> unfreeze_summaries : <span>?partial:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-frozen">frozen</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-init_summaries" class="anchored"><a href="#val-init_summaries" class="anchor"></a><code><span><span class="keyword">val</span> init_summaries : <span>unit <span class="arrow">&#45;&gt;</span></span> unit</span></code></div></div><p>Typed projection of the summary. Experimental API, use with CARE</p><div class="odoc-spec"><div class="spec value" id="val-modify_summary" class="anchored"><a href="#val-modify_summary" class="anchor"></a><code><span><span class="keyword">val</span> modify_summary : <span><a href="#type-frozen">frozen</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="Dyn/index.html#type-tag">Dyn.tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="type-var">'a</span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-frozen">frozen</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-project_from_summary" class="anchored"><a href="#val-project_from_summary" class="anchor"></a><code><span><span class="keyword">val</span> project_from_summary : <span><a href="#type-frozen">frozen</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="Dyn/index.html#type-tag">Dyn.tag</a></span> <span class="arrow">&#45;&gt;</span></span> <span class="type-var">'a</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-remove_from_summary" class="anchored"><a href="#val-remove_from_summary" class="anchor"></a><code><span><span class="keyword">val</span> remove_from_summary : <span><a href="#type-frozen">frozen</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="Dyn/index.html#type-tag">Dyn.tag</a></span> <span class="arrow">&#45;&gt;</span></span> <a href="#type-frozen">frozen</a></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-dump" class="anchored"><a href="#val-dump" class="anchor"></a><code><span><span class="keyword">val</span> dump : <span>unit <span class="arrow">&#45;&gt;</span></span> <span><span>(int * string)</span> list</span></span></code></div><div class="spec-doc"><p>Debug</p></div></div></div></body></html>