<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/node/node.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/defaults.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/system.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/user/user.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/style.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/coqdoc.css" />

<title>Standard Library | The Coq Proof Assistant</title>

</head>

<body>

<div id="container">
  <div id="headertop">
    <div id="nav">
      <ul class="links-menu">
        <li><a href="//coq.inria.fr/" class="active">Home</a></li>
        <li><a href="//coq.inria.fr/about-coq" title="More about coq">About Coq</a></li>
        <li><a href="//coq.inria.fr/download">Get Coq</a></li>
        <li><a href="//coq.inria.fr/documentation">Documentation</a></li>
        <li><a href="//coq.inria.fr/community">Community</a></li>
      </ul>
    </div>
  </div>

  <div id="header">
    <div id="logoWrapper">
      <div id="logo"><a href="//coq.inria.fr/" title="Home"><img src="//coq.inria.fr/files/barron_logo.png" alt="Home" /></a>
      </div>
      <div id="siteName"><a href="//coq.inria.fr/" title="Home">The Coq Proof Assistant</a>
      </div>
    </div>
  </div>

  <div id="content">

<h1 class="libtitle">Library Coq.PArith.BinPosDef</h1>

<div class="code">

<br/>
</div>

<div class="doc">
<a id="lab969"></a><h1 class="section">Binary positive numbers, operations</h1>

<div class="paragraph"> </div>

 Initial development by Pierre Cr√©gut, CNET, Lannion, France 
<div class="paragraph"> </div>

 The type <span class="inlinecode"><span class="id" title="var">positive</span></span> and its constructors <span class="inlinecode"><span class="id" title="var">xI</span></span> and <span class="inlinecode"><span class="id" title="var">xO</span></span> and <span class="inlinecode"><span class="id" title="var">xH</span></span>
    are now defined in <span class="inlinecode"><span class="id" title="var">BinNums.v</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">BinNums</span>.<br/>

<br/>
</div>

<div class="doc">
Postfix notation for positive numbers, which allows mimicking
    the position of bits in a big-endian representation.
    For instance, we can write <span class="inlinecode">1~1~0</span> instead of <span class="inlinecode">(<span class="id" title="var">xO</span></span> <span class="inlinecode">(<span class="id" title="var">xI</span></span> <span class="inlinecode"><span class="id" title="var">xH</span>))</span>
    for the number 6 (which is 110 in binary notation).

</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Notation</span> &quot;p ~ 1" := (<span class="id" title="var">xI</span> <span class="id" title="var">p</span>)<br/>
&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 7, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="var">format</span> "p '~' '1'") : <span class="id" title="var">positive_scope</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;p ~ 0" := (<span class="id" title="var">xO</span> <span class="id" title="var">p</span>)<br/>
&nbsp;(<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 7, <span class="id" title="tactic">left</span> <span class="id" title="keyword">associativity</span>, <span class="id" title="var">format</span> "p '~' '0'") : <span class="id" title="var">positive_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">positive_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Pos</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">t</span> := <span class="id" title="var">positive</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab970"></a><h1 class="section">Operations over positive numbers</h1>

<div class="paragraph"> </div>

<a id="lab971"></a><h2 class="section">Successor</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">succ</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; (<span class="id" title="var">succ</span> <span class="id" title="var">p</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">p</span>~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; 1~0<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab972"></a><h2 class="section">Addition</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">add</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; (<span class="id" title="var">add_carry</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; (<span class="id" title="var">add</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, 1 =&gt; (<span class="id" title="var">succ</span> <span class="id" title="var">p</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; (<span class="id" title="var">add</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; (<span class="id" title="var">add</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, 1 =&gt; <span class="id" title="var">p</span>~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~1 =&gt; (<span class="id" title="var">succ</span> <span class="id" title="var">q</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">q</span>~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, 1 =&gt; 1~0<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">add_carry</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; (<span class="id" title="var">add_carry</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; (<span class="id" title="var">add_carry</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, 1 =&gt; (<span class="id" title="var">succ</span> <span class="id" title="var">p</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; (<span class="id" title="var">add_carry</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; (<span class="id" title="var">add</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, 1 =&gt; (<span class="id" title="var">succ</span> <span class="id" title="var">p</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~1 =&gt; (<span class="id" title="var">succ</span> <span class="id" title="var">q</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~0 =&gt; (<span class="id" title="var">succ</span> <span class="id" title="var">q</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, 1 =&gt; 1~1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;+" := <span class="id" title="var">add</span> : <span class="id" title="var">positive_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab973"></a><h2 class="section">Operation <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode">2*<span class="id" title="var">x</span>-1</span></h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">pred_double</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">p</span>~0~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; (<span class="id" title="var">pred_double</span> <span class="id" title="var">p</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; 1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab974"></a><h2 class="section">Predecessor</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pred</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">p</span>~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">pred_double</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; 1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab975"></a><h2 class="section">The predecessor of a positive number can be seen as a <span class="inlinecode"><span class="id" title="var">N</span></span></h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pred_N</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">p</span>~0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">pred_double</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="id" title="var">N0</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab976"></a><h2 class="section">An auxiliary type for subtraction</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Inductive</span> <span class="id" title="var">mask</span> : <span class="id" title="keyword">Set</span> :=<br/>
| <span class="id" title="var">IsNul</span> : <span class="id" title="var">mask</span><br/>
| <span class="id" title="var">IsPos</span> : <span class="id" title="var">positive</span> -&gt; <span class="id" title="var">mask</span><br/>
| <span class="id" title="var">IsNeg</span> : <span class="id" title="var">mask</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab977"></a><h2 class="section">Operation <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode">2*<span class="id" title="var">x</span>+1</span></h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">succ_double_mask</span> (<span class="id" title="var">x</span>:<span class="id" title="var">mask</span>) : <span class="id" title="var">mask</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsNul</span> =&gt; <span class="id" title="var">IsPos</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsNeg</span> =&gt; <span class="id" title="var">IsNeg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsPos</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">IsPos</span> <span class="id" title="var">p</span>~1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab978"></a><h2 class="section">Operation <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode">2*<span class="id" title="var">x</span></span></h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">double_mask</span> (<span class="id" title="var">x</span>:<span class="id" title="var">mask</span>) : <span class="id" title="var">mask</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsNul</span> =&gt; <span class="id" title="var">IsNul</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsNeg</span> =&gt; <span class="id" title="var">IsNeg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsPos</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">IsPos</span> <span class="id" title="var">p</span>~0<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab979"></a><h2 class="section">Operation <span class="inlinecode"><span class="id" title="var">x</span></span> <span class="inlinecode">-&gt;</span> <span class="inlinecode">2*<span class="id" title="var">x</span>-2</span></h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">double_pred_mask</span> <span class="id" title="var">x</span> : <span class="id" title="var">mask</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">IsPos</span> <span class="id" title="var">p</span>~0~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">IsPos</span> (<span class="id" title="var">pred_double</span> <span class="id" title="var">p</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="id" title="var">IsNul</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab980"></a><h2 class="section">Predecessor with mask</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pred_mask</span> (<span class="id" title="var">p</span> : <span class="id" title="var">mask</span>) : <span class="id" title="var">mask</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsPos</span> 1 =&gt; <span class="id" title="var">IsNul</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsPos</span> <span class="id" title="var">q</span> =&gt; <span class="id" title="var">IsPos</span> (<span class="id" title="var">pred</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsNul</span> =&gt; <span class="id" title="var">IsNeg</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsNeg</span> =&gt; <span class="id" title="var">IsNeg</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab981"></a><h2 class="section">Subtraction, result as a mask</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">sub_mask</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">positive</span>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">y</span>} : <span class="id" title="var">mask</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">double_mask</span> (<span class="id" title="var">sub_mask</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">succ_double_mask</span> (<span class="id" title="var">sub_mask</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, 1 =&gt; <span class="id" title="var">IsPos</span> <span class="id" title="var">p</span>~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">succ_double_mask</span> (<span class="id" title="var">sub_mask_carry</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">double_mask</span> (<span class="id" title="var">sub_mask</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, 1 =&gt; <span class="id" title="var">IsPos</span> (<span class="id" title="var">pred_double</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, 1 =&gt; <span class="id" title="var">IsNul</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">IsNeg</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
<br/>
<span class="id" title="keyword">with</span> <span class="id" title="var">sub_mask_carry</span> (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">positive</span>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">y</span>} : <span class="id" title="var">mask</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">succ_double_mask</span> (<span class="id" title="var">sub_mask_carry</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">double_mask</span> (<span class="id" title="var">sub_mask</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, 1 =&gt; <span class="id" title="var">IsPos</span> (<span class="id" title="var">pred_double</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">double_mask</span> (<span class="id" title="var">sub_mask_carry</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">succ_double_mask</span> (<span class="id" title="var">sub_mask_carry</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, 1 =&gt; <span class="id" title="var">double_pred_mask</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">IsNeg</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab982"></a><h2 class="section">Subtraction, result as a positive, returning 1 if <span class="inlinecode"><span class="id" title="var">x</span>&lt;=<span class="id" title="var">y</span></span></h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sub</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">sub_mask</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">IsPos</span> <span class="id" title="var">z</span> =&gt; <span class="id" title="var">z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;-" := <span class="id" title="var">sub</span> : <span class="id" title="var">positive_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab983"></a><h2 class="section">Multiplication</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">mul</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">y</span> + (<span class="id" title="var">mul</span> <span class="id" title="var">p</span> <span class="id" title="var">y</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; (<span class="id" title="var">mul</span> <span class="id" title="var">p</span> <span class="id" title="var">y</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;*" := <span class="id" title="var">mul</span> : <span class="id" title="var">positive_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab984"></a><h2 class="section">Iteration over a positive number</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iter</span> {<span class="id" title="var">A</span>} (<span class="id" title="var">f</span>:<span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>) : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">positive</span> -&gt; <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="var">iter_fix</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xH</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xO</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">iter_fix</span> (<span class="id" title="var">iter_fix</span> <span class="id" title="var">x</span> <span class="id" title="var">n'</span>) <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xI</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">f</span> (<span class="id" title="var">iter_fix</span> (<span class="id" title="var">iter_fix</span> <span class="id" title="var">x</span> <span class="id" title="var">n'</span>) <span class="id" title="var">n'</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab985"></a><h2 class="section">Power</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">pow</span> (<span class="id" title="var">x</span>:<span class="id" title="var">positive</span>) := <span class="id" title="var">iter</span> (<span class="id" title="var">mul</span> <span class="id" title="var">x</span>) 1.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;^" := <span class="id" title="var">pow</span> : <span class="id" title="var">positive_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab986"></a><h2 class="section">Square</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">square</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; (<span class="id" title="var">square</span> <span class="id" title="var">p</span> + <span class="id" title="var">p</span>)~0~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; (<span class="id" title="var">square</span> <span class="id" title="var">p</span>)~0~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; 1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab987"></a><h2 class="section">Division by 2 rounded below but for 1</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">div2</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Division by 2 rounded up 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">div2_up</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| 1 =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">succ</span> <span class="id" title="var">p</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab988"></a><h2 class="section">Number of digits in a positive number</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">size_nat</span> <span class="id" title="var">p</span> : <span class="id" title="var">nat</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="id" title="var">S</span> <span class="id" title="var">O</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">size_nat</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">size_nat</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Same, with positive output 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">size</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">succ</span> (<span class="id" title="var">size</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">succ</span> (<span class="id" title="var">size</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab989"></a><h2 class="section">Comparison on binary positive numbers</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compare_cont</span> (<span class="id" title="var">r</span>:<span class="id" title="var">comparison</span>) (<span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">positive</span>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">y</span>} : <span class="id" title="var">comparison</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">compare_cont</span> <span class="id" title="var">r</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">compare_cont</span> <span class="id" title="var">Gt</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, 1 =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">compare_cont</span> <span class="id" title="var">Lt</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">compare_cont</span> <span class="id" title="var">r</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, 1 =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, 1 =&gt; <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">compare</span> := <span class="id" title="var">compare_cont</span> <span class="id" title="var">Eq</span>.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;?=" := <span class="id" title="var">compare</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">positive_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">min</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> ?= <span class="id" title="var">p'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="var">Lt</span> | <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">p</span><br/>
&nbsp;| <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">p'</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">max</span> <span class="id" title="var">p</span> <span class="id" title="var">p'</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> ?= <span class="id" title="var">p'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="var">Lt</span> | <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">p'</span><br/>
&nbsp;| <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">p</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab990"></a><h2 class="section">Boolean equality and comparisons</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">eqb</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> {<span class="id" title="keyword">struct</span> <span class="id" title="var">q</span>} :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">eqb</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">eqb</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, 1 =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">leb</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> ?= <span class="id" title="var">y</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">false</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ltb</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> ?= <span class="id" title="var">y</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">true</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Infix</span> &quot;=?" := <span class="id" title="var">eqb</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">positive_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;&lt;=?" := <span class="id" title="var">leb</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">positive_scope</span>.<br/>
<span class="id" title="keyword">Infix</span> &quot;&lt;?" := <span class="id" title="var">ltb</span> (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 70, <span class="id" title="keyword">no</span> <span class="id" title="keyword">associativity</span>) : <span class="id" title="var">positive_scope</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab991"></a><h2 class="section">A Square Root function for positive numbers</h2>

<div class="paragraph"> </div>

 We proceed by blocks of two digits : if p is written qbb'
    then sqrt(p) will be sqrt(q)~0 or sqrt(q)~1.
    For deciding easily in which case we are, we store the remainder
    (as a mask, since it can be null).
    Instead of copy-pasting the following code four times, we
    factorize as an auxiliary function, with f and g being either
    xO or xI depending of the initial digits.
    NB: (sub_mask (g (f 1)) 4) is a hack, morally it's g (f 0).

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sqrtrem_step</span> (<span class="id" title="var">f</span> <span class="id" title="var">g</span>:<span class="id" title="var">positive</span>-&gt;<span class="id" title="var">positive</span>) <span class="id" title="var">p</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">s</span>, <span class="id" title="var">IsPos</span> <span class="id" title="var">r</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s'</span> := <span class="id" title="var">s</span>~0~1 <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">r'</span> := <span class="id" title="var">g</span> (<span class="id" title="var">f</span> <span class="id" title="var">r</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">s'</span> &lt;=? <span class="id" title="var">r'</span> <span class="id" title="keyword">then</span> (<span class="id" title="var">s</span>~1, <span class="id" title="var">sub_mask</span> <span class="id" title="var">r'</span> <span class="id" title="var">s'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> (<span class="id" title="var">s</span>~0, <span class="id" title="var">IsPos</span> <span class="id" title="var">r'</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">s</span>,<span class="id" title="var">_</span>)  =&gt; (<span class="id" title="var">s</span>~0, <span class="id" title="var">sub_mask</span> (<span class="id" title="var">g</span> (<span class="id" title="var">f</span> 1)) 1~0~0)<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">sqrtrem</span> <span class="id" title="var">p</span> : <span class="id" title="var">positive</span> * <span class="id" title="var">mask</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 1 =&gt; (1,<span class="id" title="var">IsNul</span>)<br/>
&nbsp;&nbsp;| 1~0 =&gt; (1,<span class="id" title="var">IsPos</span> 1)<br/>
&nbsp;&nbsp;| 1~1 =&gt; (1,<span class="id" title="var">IsPos</span> 1~0)<br/>
&nbsp;&nbsp;| <span class="id" title="var">p</span>~0~0 =&gt; <span class="id" title="var">sqrtrem_step</span> <span class="id" title="var">xO</span> <span class="id" title="var">xO</span> (<span class="id" title="var">sqrtrem</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">p</span>~0~1 =&gt; <span class="id" title="var">sqrtrem_step</span> <span class="id" title="var">xO</span> <span class="id" title="var">xI</span> (<span class="id" title="var">sqrtrem</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">p</span>~1~0 =&gt; <span class="id" title="var">sqrtrem_step</span> <span class="id" title="var">xI</span> <span class="id" title="var">xO</span> (<span class="id" title="var">sqrtrem</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">p</span>~1~1 =&gt; <span class="id" title="var">sqrtrem_step</span> <span class="id" title="var">xI</span> <span class="id" title="var">xI</span> (<span class="id" title="var">sqrtrem</span> <span class="id" title="var">p</span>)<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">sqrt</span> <span class="id" title="var">p</span> := <span class="id" title="var">fst</span> (<span class="id" title="var">sqrtrem</span> <span class="id" title="var">p</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab992"></a><h2 class="section">Greatest Common Divisor</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">divide</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span> := <span class="id" title="tactic">exists</span> <span class="id" title="var">r</span>, <span class="id" title="var">q</span> = <span class="id" title="var">r</span>*<span class="id" title="var">p</span>.<br/>
<span class="id" title="keyword">Notation</span> &quot;( p | q )" := (<span class="id" title="var">divide</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>) (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0) : <span class="id" title="var">positive_scope</span>.<br/>

<br/>
</div>

<div class="doc">
Instead of the Euclid algorithm, we use here the Stein binary
   algorithm, which is faster for this representation. This algorithm
   is almost structural, but in the last cases we do some recursive
   calls on subtraction, hence the need for a counter.

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">gcdn</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">positive</span>) : <span class="id" title="var">positive</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span>,<span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">_</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, 1 =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>~0, <span class="id" title="var">b</span>~0 =&gt; (<span class="id" title="var">gcdn</span> <span class="id" title="var">n</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>  , <span class="id" title="var">b</span>~0 =&gt; <span class="id" title="var">gcdn</span> <span class="id" title="var">n</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>~0, <span class="id" title="var">_</span>   =&gt; <span class="id" title="var">gcdn</span> <span class="id" title="var">n</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a'</span>~1, <span class="id" title="var">b'</span>~1 =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a'</span> ?= <span class="id" title="var">b'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">gcdn</span> <span class="id" title="var">n</span> (<span class="id" title="var">b'</span>-<span class="id" title="var">a'</span>) <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">gcdn</span> <span class="id" title="var">n</span> (<span class="id" title="var">a'</span>-<span class="id" title="var">b'</span>) <span class="id" title="var">b</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
We'll show later that we need at most (log2(a.b)) loops 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">gcd</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">positive</span>) := <span class="id" title="var">gcdn</span> (<span class="id" title="var">size_nat</span> <span class="id" title="var">a</span> + <span class="id" title="var">size_nat</span> <span class="id" title="var">b</span>)%<span class="id" title="var">nat</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
Generalized Gcd, also computing the division of a and b by the gcd 
</div>
<div class="code">
<span class="id" title="keyword">Set Printing Universes</span>.<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">ggcdn</span> (<span class="id" title="var">n</span> : <span class="id" title="var">nat</span>) (<span class="id" title="var">a</span> <span class="id" title="var">b</span> : <span class="id" title="var">positive</span>) : (<span class="id" title="var">positive</span>*(<span class="id" title="var">positive</span>*<span class="id" title="var">positive</span>)) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; (1,(<span class="id" title="var">a</span>,<span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a</span>,<span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">_</span> =&gt; (1,(1,<span class="id" title="var">b</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, 1 =&gt; (1,(<span class="id" title="var">a</span>,1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>~0, <span class="id" title="var">b</span>~0 =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">g</span>,<span class="id" title="var">p</span>) := <span class="id" title="var">ggcdn</span> <span class="id" title="var">n</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">g</span>~0,<span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">b</span>~0 =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">g</span>,(<span class="id" title="var">aa</span>,<span class="id" title="var">bb</span>)) := <span class="id" title="var">ggcdn</span> <span class="id" title="var">n</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">g</span>,(<span class="id" title="var">aa</span>, <span class="id" title="var">bb</span>~0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a</span>~0, <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">g</span>,(<span class="id" title="var">aa</span>,<span class="id" title="var">bb</span>)) := <span class="id" title="var">ggcdn</span> <span class="id" title="var">n</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">g</span>,(<span class="id" title="var">aa</span>~0, <span class="id" title="var">bb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">a'</span>~1, <span class="id" title="var">b'</span>~1 =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">a'</span> ?= <span class="id" title="var">b'</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> =&gt; (<span class="id" title="var">a</span>,(1,1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">g</span>,(<span class="id" title="var">ba</span>,<span class="id" title="var">aa</span>)) := <span class="id" title="var">ggcdn</span> <span class="id" title="var">n</span> (<span class="id" title="var">b'</span>-<span class="id" title="var">a'</span>) <span class="id" title="var">a</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">g</span>,(<span class="id" title="var">aa</span>, <span class="id" title="var">aa</span> + <span class="id" title="var">ba</span>~0))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">g</span>,(<span class="id" title="var">ab</span>,<span class="id" title="var">bb</span>)) := <span class="id" title="var">ggcdn</span> <span class="id" title="var">n</span> (<span class="id" title="var">a'</span>-<span class="id" title="var">b'</span>) <span class="id" title="var">b</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">g</span>,(<span class="id" title="var">bb</span> + <span class="id" title="var">ab</span>~0, <span class="id" title="var">bb</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">ggcd</span> (<span class="id" title="var">a</span> <span class="id" title="var">b</span>: <span class="id" title="var">positive</span>) := <span class="id" title="var">ggcdn</span> (<span class="id" title="var">size_nat</span> <span class="id" title="var">a</span> + <span class="id" title="var">size_nat</span> <span class="id" title="var">b</span>)%<span class="id" title="var">nat</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
Local copies of the not-yet-available <span class="inlinecode"><span class="id" title="var">N.double</span></span> and <span class="inlinecode"><span class="id" title="var">N.succ_double</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Nsucc_double</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">N0</span> =&gt; <span class="id" title="var">Npos</span> 1<br/>
&nbsp;&nbsp;| <span class="id" title="var">Npos</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">Npos</span> <span class="id" title="var">p</span>~1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Ndouble</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">N0</span> =&gt; <span class="id" title="var">N0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Npos</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">Npos</span> <span class="id" title="var">p</span>~0<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Operation over bits. 
<div class="paragraph"> </div>

 Logical <span class="inlinecode"><span class="id" title="var">or</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">lor</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">positive</span>) : <span class="id" title="var">positive</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">q</span>~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">q</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, 1 =&gt; <span class="id" title="var">p</span>~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, 1 =&gt; <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; (<span class="id" title="var">lor</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; (<span class="id" title="var">lor</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; (<span class="id" title="var">lor</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; (<span class="id" title="var">lor</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)~1<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Logical <span class="inlinecode"><span class="id" title="var">and</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">land</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span> : <span class="id" title="var">positive</span>) : <span class="id" title="var">N</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">N0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Npos</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, 1 =&gt; <span class="id" title="var">N0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, 1 =&gt; <span class="id" title="var">Npos</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Ndouble</span> (<span class="id" title="var">land</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">Ndouble</span> (<span class="id" title="var">land</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Ndouble</span> (<span class="id" title="var">land</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">Nsucc_double</span> (<span class="id" title="var">land</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Logical <span class="inlinecode"><span class="id" title="var">diff</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">ldiff</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span>:<span class="id" title="var">positive</span>) : <span class="id" title="var">N</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Npos</span> 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">N0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>~0, 1 =&gt; <span class="id" title="var">Npos</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, 1 =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">p</span>~0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Ndouble</span> (<span class="id" title="var">ldiff</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">Ndouble</span> (<span class="id" title="var">ldiff</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">Ndouble</span> (<span class="id" title="var">ldiff</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Nsucc_double</span> (<span class="id" title="var">ldiff</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">xor</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">lxor</span> (<span class="id" title="var">p</span> <span class="id" title="var">q</span>:<span class="id" title="var">positive</span>) : <span class="id" title="var">N</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span>, <span class="id" title="var">q</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, 1 =&gt; <span class="id" title="var">N0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">q</span>~1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">q</span>~0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, 1 =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">p</span>~1)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Ndouble</span> (<span class="id" title="var">lxor</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">Nsucc_double</span> (<span class="id" title="var">lxor</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, 1 =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">p</span>~0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~0 =&gt; <span class="id" title="var">Nsucc_double</span> (<span class="id" title="var">lxor</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">q</span>~1 =&gt; <span class="id" title="var">Ndouble</span> (<span class="id" title="var">lxor</span> <span class="id" title="var">p</span> <span class="id" title="var">q</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Shifts. NB: right shift of 1 stays at 1. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">shiftl_nat</span> (<span class="id" title="var">p</span>:<span class="id" title="var">positive</span>) := <span class="id" title="var">nat_rect</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">xO</span>).<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">shiftr_nat</span> (<span class="id" title="var">p</span>:<span class="id" title="var">positive</span>) := <span class="id" title="var">nat_rect</span> <span class="id" title="var">_</span> <span class="id" title="var">p</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">div2</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">shiftl</span> (<span class="id" title="var">p</span>:<span class="id" title="var">positive</span>)(<span class="id" title="var">n</span>:<span class="id" title="var">N</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">N0</span> =&gt; <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Npos</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">iter</span> <span class="id" title="var">xO</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">shiftr</span> (<span class="id" title="var">p</span>:<span class="id" title="var">positive</span>)(<span class="id" title="var">n</span>:<span class="id" title="var">N</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">N0</span> =&gt; <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Npos</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">iter</span> <span class="id" title="var">div2</span> <span class="id" title="var">p</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Checking whether a particular bit is set or not 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">testbit_nat</span> (<span class="id" title="var">p</span>:<span class="id" title="var">positive</span>) : <span class="id" title="var">nat</span> -&gt; <span class="id" title="var">bool</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">testbit_nat</span> <span class="id" title="var">p</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="keyword">fun</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">testbit_nat</span> <span class="id" title="var">p</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
Same, but with index in N 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">testbit</span> (<span class="id" title="var">p</span>:<span class="id" title="var">positive</span>)(<span class="id" title="var">n</span>:<span class="id" title="var">N</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span>, <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">N0</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">N0</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0, <span class="id" title="var">Npos</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">testbit</span> <span class="id" title="var">p</span> (<span class="id" title="var">pred_N</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1, <span class="id" title="var">Npos</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">testbit</span> <span class="id" title="var">p</span> (<span class="id" title="var">pred_N</span> <span class="id" title="var">n</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab993"></a><h2 class="section">From binary positive numbers to Peano natural numbers</h2>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">iter_op</span> {<span class="id" title="var">A</span>}(<span class="id" title="var">op</span>:<span class="id" title="var">A</span>-&gt;<span class="id" title="var">A</span>-&gt;<span class="id" title="var">A</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fix</span> <span class="id" title="var">iter</span> (<span class="id" title="var">p</span>:<span class="id" title="var">positive</span>)(<span class="id" title="var">a</span>:<span class="id" title="var">A</span>) : <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 1 =&gt; <span class="id" title="var">a</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">iter</span> <span class="id" title="var">p</span> (<span class="id" title="var">op</span> <span class="id" title="var">a</span> <span class="id" title="var">a</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">op</span> <span class="id" title="var">a</span> (<span class="id" title="var">iter</span> <span class="id" title="var">p</span> (<span class="id" title="var">op</span> <span class="id" title="var">a</span> <span class="id" title="var">a</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">to_nat</span> (<span class="id" title="var">x</span>:<span class="id" title="var">positive</span>) : <span class="id" title="var">nat</span> := <span class="id" title="var">iter_op</span> <span class="id" title="var">plus</span> <span class="id" title="var">x</span> (<span class="id" title="var">S</span> <span class="id" title="var">O</span>).<br/>
</div>

<div class="doc">
<a id="lab994"></a><h2 class="section">From Peano natural numbers to binary positive numbers</h2>

<div class="paragraph"> </div>

 A version preserving positive numbers, and sending 0 to 1. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">of_nat</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">positive</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">O</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">succ</span> (<span class="id" title="var">of_nat</span> <span class="id" title="var">x</span>)<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">of_succ_nat</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>) : <span class="id" title="var">positive</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; 1<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">succ</span> (<span class="id" title="var">of_succ_nat</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab995"></a><h2 class="section">Conversion with a decimal representation for printing/parsing</h2>

</div>
<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">of_uint_acc</span> (<span class="id" title="var">d</span>:<span class="id" title="var">Decimal.uint</span>)(<span class="id" title="var">acc</span>:<span class="id" title="var">positive</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">d</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.Nil</span> =&gt; <span class="id" title="var">acc</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D0</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D1</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D2</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1~0 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D3</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1~1 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D4</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1~0~0 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D5</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1~0~1 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D6</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1~1~0 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D7</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1~1~1 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D8</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1~0~0~0 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D9</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> (<span class="id" title="var">add</span> 1~0~0~1 (<span class="id" title="var">mul</span> <span class="id" title="var">ten</span> <span class="id" title="var">acc</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">of_uint</span> (<span class="id" title="var">d</span>:<span class="id" title="var">Decimal.uint</span>) : <span class="id" title="var">N</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">d</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.Nil</span> =&gt; <span class="id" title="var">N0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D0</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">of_uint</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D1</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D2</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1~0)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D3</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1~1)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D4</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1~0~0)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D5</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1~0~1)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D6</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1~1~0)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D7</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1~1~1)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D8</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1~0~0~0)<br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.D9</span> <span class="id" title="var">l</span> =&gt; <span class="id" title="var">Npos</span> (<span class="id" title="var">of_uint_acc</span> <span class="id" title="var">l</span> 1~0~0~1)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">of_int</span> (<span class="id" title="var">d</span>:<span class="id" title="var">Decimal.int</span>) : <span class="id" title="var">option</span> <span class="id" title="var">positive</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">d</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.Pos</span> <span class="id" title="var">d</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">of_uint</span> <span class="id" title="var">d</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">N0</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Npos</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Decimal.Neg</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">to_little_uint</span> <span class="id" title="var">p</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| 1 =&gt; <span class="id" title="var">Decimal.D1</span> <span class="id" title="var">Decimal.Nil</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">p</span>~1 =&gt; <span class="id" title="var">Decimal.Little.succ_double</span> (<span class="id" title="var">to_little_uint</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">p</span>~0 =&gt; <span class="id" title="var">Decimal.Little.double</span> (<span class="id" title="var">to_little_uint</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">to_uint</span> <span class="id" title="var">p</span> := <span class="id" title="var">Decimal.rev</span> (<span class="id" title="var">to_little_uint</span> <span class="id" title="var">p</span>).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">to_int</span> <span class="id" title="var">n</span> := <span class="id" title="var">Decimal.Pos</span> (<span class="id" title="var">to_uint</span> <span class="id" title="var">n</span>).<br/>

<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Pos</span>.<br/>

<br/>
</div>

<div class="doc">
Re-export the notation for those who just <span class="inlinecode"><span class="id" title="keyword">Import</span></span> <span class="inlinecode"><span class="id" title="var">BinPosDef</span></span> 
</div>
<div class="code">
</div>
    <div id="sidebarWrapper">
      <div id="sidebar">
        <div class="block">
          <h2 class="title">Navigation</h2>
          <div class="content">
            <ul class="menu">
              <li class="leaf">Standard Library
                <ul class="menu">
                  <li><a href="index.html">Table of contents</a></li>
                  <li><a href="genindex.html">Index</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="footer">
    <div id="nav-footer">
      <ul class="links-menu-footer">
        <li><a href="mailto:coq-www_@_inria.fr">webmaster</a></li>
        <li><a href="http://validator.w3.org/">xhtml valid</a></li>
        <li><a href="http://jigsaw.w3.org/css-validator/">CSS valid</a></li>
      </ul>
    </div>
  </div>

</div>

</body>
</html>
