<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/node/node.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/defaults.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/system.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/user/user.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/style.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/coqdoc.css" />

<title>Standard Library | The Coq Proof Assistant</title>

</head>

<body>

<div id="container">
  <div id="headertop">
    <div id="nav">
      <ul class="links-menu">
        <li><a href="//coq.inria.fr/" class="active">Home</a></li>
        <li><a href="//coq.inria.fr/about-coq" title="More about coq">About Coq</a></li>
        <li><a href="//coq.inria.fr/download">Get Coq</a></li>
        <li><a href="//coq.inria.fr/documentation">Documentation</a></li>
        <li><a href="//coq.inria.fr/community">Community</a></li>
      </ul>
    </div>
  </div>

  <div id="header">
    <div id="logoWrapper">
      <div id="logo"><a href="//coq.inria.fr/" title="Home"><img src="//coq.inria.fr/files/barron_logo.png" alt="Home" /></a>
      </div>
      <div id="siteName"><a href="//coq.inria.fr/" title="Home">The Coq Proof Assistant</a>
      </div>
    </div>
  </div>

  <div id="content">

<h1 class="libtitle">Library Coq.Numbers.NatInt.NZLog</h1>

<div class="code">

<br/>
</div>

<div class="doc">
Base-2 Logarithm 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">NZAxioms</span> <span class="id" title="var">NZMulOrder</span> <span class="id" title="var">NZPow</span>.<br/>

<br/>
</div>

<div class="doc">
Interface of a log2 function, then its specification on naturals 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">Log2</span> (<span class="id" title="keyword">Import</span> <span class="id" title="var">A</span> : <span class="id" title="var">Typ</span>).<br/>
&nbsp;<span class="id" title="keyword">Parameter</span> <span class="id" title="keyword">Inline</span> <span class="id" title="var">log2</span> : <span class="id" title="var">t</span> -&gt; <span class="id" title="var">t</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Log2</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">NZLog2Spec</span> (<span class="id" title="var">A</span> : <span class="id" title="var">NZOrdAxiomsSig'</span>)(<span class="id" title="var">B</span> : <span class="id" title="var">Pow'</span> <span class="id" title="var">A</span>)(<span class="id" title="var">C</span> : <span class="id" title="var">Log2</span> <span class="id" title="var">A</span>).<br/>
&nbsp;<span class="id" title="keyword">Import</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span>.<br/>
&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">log2_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 2^(<span class="id" title="var">log2</span> <span class="id" title="var">a</span>) &lt;= <span class="id" title="var">a</span> &lt; 2^(<span class="id" title="var">S</span> (<span class="id" title="var">log2</span> <span class="id" title="var">a</span>)).<br/>
&nbsp;<span class="id" title="keyword">Axiom</span> <span class="id" title="var">log2_nonpos</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">a</span>&lt;=0 -&gt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span> == 0.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">NZLog2Spec</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">NZLog2</span> (<span class="id" title="var">A</span> : <span class="id" title="var">NZOrdAxiomsSig</span>)(<span class="id" title="var">B</span> : <span class="id" title="var">Pow</span> <span class="id" title="var">A</span>) := <span class="id" title="var">Log2</span> <span class="id" title="var">A</span> &lt;+ <span class="id" title="var">NZLog2Spec</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>.<br/>

<br/>
</div>

<div class="doc">
Derived properties of logarithm 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="keyword">Type</span> <span class="id" title="var">NZLog2Prop</span><br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">A</span> : <span class="id" title="var">NZOrdAxiomsSig'</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">B</span> : <span class="id" title="var">NZPow'</span> <span class="id" title="var">A</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">C</span> : <span class="id" title="var">NZLog2</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">D</span> : <span class="id" title="var">NZMulOrderProp</span> <span class="id" title="var">A</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">E</span> : <span class="id" title="var">NZPowProp</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">D</span>).<br/>

<br/>
</div>

<div class="doc">
log2 is always non-negative 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_nonneg</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0 &lt;= <span class="id" title="var">log2</span> <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
A tactic for proving positivity and non-negativity 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">order_pos</span> :=<br/>
((<span class="id" title="tactic">apply</span> <span class="id" title="var">add_pos_pos</span> || <span class="id" title="tactic">apply</span> <span class="id" title="var">add_nonneg_nonneg</span> ||<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">mul_pos_pos</span> || <span class="id" title="tactic">apply</span> <span class="id" title="var">mul_nonneg_nonneg</span> ||<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">pow_nonneg</span> || <span class="id" title="tactic">apply</span> <span class="id" title="var">pow_pos_nonneg</span> ||<br/>
&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">log2_nonneg</span> || <span class="id" title="tactic">apply</span> (<span class="id" title="var">le_le_succ_r</span> 0));<br/>
&nbsp;<span class="id" title="var">order_pos</span>) <br/>
|| <span class="id" title="var">order'</span>. 
<br/>
</div>

<div class="doc">
The spec of log2 indeed determines it 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_unique</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;=<span class="id" title="var">b</span> -&gt; 2^<span class="id" title="var">b</span>&lt;=<span class="id" title="var">a</span>&lt;2^(<span class="id" title="var">S</span> <span class="id" title="var">b</span>) -&gt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span> == <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
Hence log2 is a morphism. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">log2_wd</span> : <span class="id" title="var">Proper</span> (<span class="id" title="var">eq</span>==&gt;<span class="id" title="var">eq</span>) <span class="id" title="var">log2</span>.<br/>

<br/>
</div>

<div class="doc">
An alternate specification 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_spec_alt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">r</span>,<br/>
&nbsp;<span class="id" title="var">a</span> == 2^(<span class="id" title="var">log2</span> <span class="id" title="var">a</span>) + <span class="id" title="var">r</span> /\ 0 &lt;= <span class="id" title="var">r</span> &lt; 2^(<span class="id" title="var">log2</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_unique'</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">c</span>, 0&lt;=<span class="id" title="var">b</span> -&gt; 0&lt;=<span class="id" title="var">c</span>&lt;2^<span class="id" title="var">b</span> -&gt;<br/>
&nbsp;<span class="id" title="var">a</span> == 2^<span class="id" title="var">b</span> + <span class="id" title="var">c</span> -&gt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span> == <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
log2 is exact on powers of 2 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;=<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2</span> (2^<span class="id" title="var">a</span>) == <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
log2 and predecessors of powers of 2 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_pred_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2</span> (<span class="id" title="var">P</span> (2^<span class="id" title="var">a</span>)) == <span class="id" title="var">P</span> <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
log2 and basic constants 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_1</span> : <span class="id" title="var">log2</span> 1 == 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_2</span> : <span class="id" title="var">log2</span> 2 == 1.<br/>

<br/>
</div>

<div class="doc">
log2 n is strictly positive for 1&lt;n 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_pos</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 1&lt;<span class="id" title="var">a</span> -&gt; 0 &lt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
Said otherwise, log2 is null only below 1 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_null</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">log2</span> <span class="id" title="var">a</span> == 0 &lt;-&gt; <span class="id" title="var">a</span> &lt;= 1.<br/>

<br/>
</div>

<div class="doc">
log2 is a monotone function (but not a strict one) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_le_mono</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span>&lt;=<span class="id" title="var">b</span> -&gt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">log2</span> <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
No reverse result for &lt;=, consider for instance log2 3 &lt;= log2 2 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_lt_cancel</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">log2</span> <span class="id" title="var">a</span> &lt; <span class="id" title="var">log2</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">a</span> &lt; <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
When left side is a power of 2, we have an equivalence for &lt;= 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_le_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; (2^<span class="id" title="var">b</span>&lt;=<span class="id" title="var">a</span> &lt;-&gt; <span class="id" title="var">b</span> &lt;= <span class="id" title="var">log2</span> <span class="id" title="var">a</span>).<br/>

<br/>
</div>

<div class="doc">
When right side is a square, we have an equivalence for &lt; 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_lt_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; (<span class="id" title="var">a</span>&lt;2^<span class="id" title="var">b</span> &lt;-&gt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span> &lt; <span class="id" title="var">b</span>).<br/>

<br/>
</div>

<div class="doc">
Comparing log2 and identity 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_lt_lin</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_le_lin</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;=<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
Log2 and multiplication. 
<div class="paragraph"> </div>

 Due to rounding error, we don't have the usual
    <span class="inlinecode"><span class="id" title="var">log2</span></span> <span class="inlinecode">(<span class="id" title="var">a</span>*<span class="id" title="var">b</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">log2</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">log2</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> but we may be off by 1 at most 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_mul_below</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 0&lt;<span class="id" title="var">b</span> -&gt;<br/>
&nbsp;<span class="id" title="var">log2</span> <span class="id" title="var">a</span> + <span class="id" title="var">log2</span> <span class="id" title="var">b</span> &lt;= <span class="id" title="var">log2</span> (<span class="id" title="var">a</span>*<span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_mul_above</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;=<span class="id" title="var">a</span> -&gt; 0&lt;=<span class="id" title="var">b</span> -&gt;<br/>
&nbsp;<span class="id" title="var">log2</span> (<span class="id" title="var">a</span>*<span class="id" title="var">b</span>) &lt;= <span class="id" title="var">log2</span> <span class="id" title="var">a</span> + <span class="id" title="var">log2</span> <span class="id" title="var">b</span> + 1.<br/>

<br/>
</div>

<div class="doc">
And we can't find better approximations in general.
<ul class="doclist">
<li> The lower bound is exact for powers of 2.
<ul class="doclist">
<li> Concerning the upper bound, for any c&gt;1, take a=b=2^c-1,
      then log2 (a*b) = c+c -1 while (log2 a) = (log2 b) = c-1

</li>
</ul>

</li>
</ul>

<div class="paragraph"> </div>

 At least, we get back the usual equation when we multiply by 2 (or 2^k) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_mul_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 0&lt;=<span class="id" title="var">b</span> -&gt; <span class="id" title="var">log2</span> (<span class="id" title="var">a</span>*2^<span class="id" title="var">b</span>) == <span class="id" title="var">b</span> + <span class="id" title="var">log2</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_double</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2</span> (2*<span class="id" title="var">a</span>) == <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> <span class="id" title="var">a</span>).<br/>

<br/>
</div>

<div class="doc">
Two numbers with same log2 cannot be far away. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_same</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 0&lt;<span class="id" title="var">b</span> -&gt; <span class="id" title="var">log2</span> <span class="id" title="var">a</span> == <span class="id" title="var">log2</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">a</span> &lt; 2*<span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
Log2 and successor :
<ul class="doclist">
<li> the log2 function climbs by at most 1 at a time
<ul class="doclist">
<li> otherwise it stays at the same value

</li>
<li> the +1 steps occur for powers of two

</li>
</ul>

</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_succ_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">log2</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) &lt;= <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_succ_or</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>,<br/>
&nbsp;<span class="id" title="var">log2</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) == <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> <span class="id" title="var">a</span>) \/ <span class="id" title="var">log2</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) == <span class="id" title="var">log2</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_eq_succ_is_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>,<br/>
&nbsp;<span class="id" title="var">log2</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) == <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> <span class="id" title="var">a</span>) -&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">S</span> <span class="id" title="var">a</span> == 2^<span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_eq_succ_iff_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">log2</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) == <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> <span class="id" title="var">a</span>) &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">S</span> <span class="id" title="var">a</span> == 2^<span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_succ_double</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2</span> (2*<span class="id" title="var">a</span>+1) == <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> <span class="id" title="var">a</span>).<br/>

<br/>
</div>

<div class="doc">
Log2 and addition 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_add_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span>~=1 -&gt; <span class="id" title="var">b</span>~=1 -&gt; <span class="id" title="var">log2</span> (<span class="id" title="var">a</span>+<span class="id" title="var">b</span>) &lt;= <span class="id" title="var">log2</span> <span class="id" title="var">a</span> + <span class="id" title="var">log2</span> <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
The sum of two log2 is less than twice the log2 of the sum.
    The large inequality is obvious thanks to monotonicity.
    The strict one requires some more work. This is almost
    a convexity inequality for points <span class="inlinecode">2<span class="id" title="var">a</span></span>, <span class="inlinecode">2<span class="id" title="var">b</span></span> and their middle <span class="inlinecode"><span class="id" title="var">a</span>+<span class="id" title="var">b</span></span> :
    ideally, we would have <span class="inlinecode">2*<span class="id" title="var">log</span>(<span class="id" title="var">a</span>+<span class="id" title="var">b</span>)</span> <span class="inlinecode">&gt;=</span> <span class="inlinecode"><span class="id" title="var">log</span>(2<span class="id" title="var">a</span>)+<span class="id" title="var">log</span>(2<span class="id" title="var">b</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode">2+<span class="id" title="var">log</span></span> <span class="inlinecode"><span class="id" title="var">a</span>+<span class="id" title="var">log</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span>.
    Here, we cannot do better: consider for instance a=2 b=4, then 1+2&lt;2*2

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_log2_lt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 0&lt;<span class="id" title="var">b</span> -&gt;<br/>
&nbsp;<span class="id" title="var">log2</span> <span class="id" title="var">a</span> + <span class="id" title="var">log2</span> <span class="id" title="var">b</span> &lt; 2 * <span class="id" title="var">log2</span> (<span class="id" title="var">a</span>+<span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">NZLog2Prop</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">NZLog2UpProp</span><br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">A</span> : <span class="id" title="var">NZDecOrdAxiomsSig'</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">B</span> : <span class="id" title="var">NZPow'</span> <span class="id" title="var">A</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">C</span> : <span class="id" title="var">NZLog2</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">D</span> : <span class="id" title="var">NZMulOrderProp</span> <span class="id" title="var">A</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">E</span> : <span class="id" title="var">NZPowProp</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">D</span>)<br/>
&nbsp;(<span class="id" title="keyword">Import</span> <span class="id" title="var">F</span> : <span class="id" title="var">NZLog2Prop</span> <span class="id" title="var">A</span> <span class="id" title="var">B</span> <span class="id" title="var">C</span> <span class="id" title="var">D</span> <span class="id" title="var">E</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab407"></a><h1 class="section"><span class="inlinecode"><span class="id" title="var">log2_up</span></span> : a binary logarithm that rounds up instead of down</h1>

<div class="paragraph"> </div>

 For once, we define instead of axiomatizing, thanks to log2 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">compare</span> 1 <span class="id" title="var">a</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> (<span class="id" title="var">P</span> <span class="id" title="var">a</span>))<br/>
&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_eqn0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">a</span>&lt;=1 -&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> == 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_eqn</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 1&lt;<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> == <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> (<span class="id" title="var">P</span> <span class="id" title="var">a</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 1&lt;<span class="id" title="var">a</span> -&gt;<br/>
&nbsp;2^(<span class="id" title="var">P</span> (<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>)) &lt; <span class="id" title="var">a</span> &lt;= 2^(<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_nonpos</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">a</span>&lt;=0 -&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> == 0.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">log2_up_wd</span> : <span class="id" title="var">Proper</span> (<span class="id" title="var">eq</span>==&gt;<span class="id" title="var">eq</span>) <span class="id" title="var">log2_up</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">log2_up</span></span> is always non-negative 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_nonneg</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0 &lt;= <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
The spec of <span class="inlinecode"><span class="id" title="var">log2_up</span></span> indeed determines it 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_unique</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">b</span> -&gt; 2^(<span class="id" title="var">P</span> <span class="id" title="var">b</span>)&lt;<span class="id" title="var">a</span>&lt;=2^<span class="id" title="var">b</span> -&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> == <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">log2_up</span></span> is exact on powers of 2 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;=<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2_up</span> (2^<span class="id" title="var">a</span>) == <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">log2_up</span></span> and successors of powers of 2 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_succ_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;=<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2_up</span> (<span class="id" title="var">S</span> (2^<span class="id" title="var">a</span>)) == <span class="id" title="var">S</span> <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
Basic constants 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_1</span> : <span class="id" title="var">log2_up</span> 1 == 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_2</span> : <span class="id" title="var">log2_up</span> 2 == 1.<br/>

<br/>
</div>

<div class="doc">
Links between log2 and <span class="inlinecode"><span class="id" title="var">log2_up</span></span> 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_log2_log2_up</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">log2</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">le_log2_up_succ_log2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">S</span> (<span class="id" title="var">log2</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_log2_up_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt;<br/>
&nbsp;2^<span class="id" title="var">log2</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">a</span> &lt;= 2^<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_log2_up_exact</span> :<br/>
&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; (<span class="id" title="var">log2</span> <span class="id" title="var">a</span> == <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span> == 2^<span class="id" title="var">b</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">log2_up</span></span> n is strictly positive for 1&lt;n 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_pos</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 1&lt;<span class="id" title="var">a</span> -&gt; 0 &lt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
Said otherwise, <span class="inlinecode"><span class="id" title="var">log2_up</span></span> is null only below 1 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_null</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> == 0 &lt;-&gt; <span class="id" title="var">a</span> &lt;= 1.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">log2_up</span></span> is a monotone function (but not a strict one) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_le_mono</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span>&lt;=<span class="id" title="var">b</span> -&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">log2_up</span> <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
No reverse result for &lt;=, consider for instance log2_up 4 &lt;= log2_up 3 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_lt_cancel</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> &lt; <span class="id" title="var">log2_up</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">a</span> &lt; <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
When left side is a power of 2, we have an equivalence for &lt; 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_lt_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; (2^<span class="id" title="var">b</span>&lt;<span class="id" title="var">a</span> &lt;-&gt; <span class="id" title="var">b</span> &lt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>).<br/>

<br/>
</div>

<div class="doc">
When right side is a square, we have an equivalence for &lt;= 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_le_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; (<span class="id" title="var">a</span>&lt;=2^<span class="id" title="var">b</span> &lt;-&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">b</span>).<br/>

<br/>
</div>

<div class="doc">
Comparing <span class="inlinecode"><span class="id" title="var">log2_up</span></span> and identity 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_lt_lin</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> &lt; <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_le_lin</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;=<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> &lt;= <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">log2_up</span></span> and multiplication. 
<div class="paragraph"> </div>

 Due to rounding error, we don't have the usual
    <span class="inlinecode"><span class="id" title="var">log2_up</span></span> <span class="inlinecode">(<span class="id" title="var">a</span>*<span class="id" title="var">b</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">log2_up</span></span> <span class="inlinecode"><span class="id" title="var">a</span></span> <span class="inlinecode">+</span> <span class="inlinecode"><span class="id" title="var">log2_up</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span> but we may be off by 1 at most 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_mul_above</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;=<span class="id" title="var">a</span> -&gt; 0&lt;=<span class="id" title="var">b</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">log2_up</span> (<span class="id" title="var">a</span>*<span class="id" title="var">b</span>) &lt;= <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> + <span class="id" title="var">log2_up</span> <span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_mul_below</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 0&lt;<span class="id" title="var">b</span> -&gt;<br/>
&nbsp;<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> + <span class="id" title="var">log2_up</span> <span class="id" title="var">b</span> &lt;= <span class="id" title="var">S</span> (<span class="id" title="var">log2_up</span> (<span class="id" title="var">a</span>*<span class="id" title="var">b</span>)).<br/>

<br/>
</div>

<div class="doc">
And we can't find better approximations in general.
<ul class="doclist">
<li> The upper bound is exact for powers of 2.
<ul class="doclist">
<li> Concerning the lower bound, for any c&gt;1, take a=b=2^c+1,
      then <span class="inlinecode"><span class="id" title="var">log2_up</span></span> <span class="inlinecode">(<span class="id" title="var">a</span>*<span class="id" title="var">b</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">c</span>+<span class="id" title="var">c</span></span> <span class="inlinecode">+1</span> while <span class="inlinecode">(<span class="id" title="var">log2_up</span></span> <span class="inlinecode"><span class="id" title="var">a</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode">(<span class="id" title="var">log2_up</span></span> <span class="inlinecode"><span class="id" title="var">b</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode"><span class="id" title="var">c</span>+1</span>

</li>
</ul>

</li>
</ul>

<div class="paragraph"> </div>

 At least, we get back the usual equation when we multiply by 2 (or 2^k) 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_mul_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 0&lt;=<span class="id" title="var">b</span> -&gt;<br/>
&nbsp;<span class="id" title="var">log2_up</span> (<span class="id" title="var">a</span>*2^<span class="id" title="var">b</span>) == <span class="id" title="var">b</span> + <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_double</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt; <span class="id" title="var">log2_up</span> (2*<span class="id" title="var">a</span>) == <span class="id" title="var">S</span> (<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>).<br/>

<br/>
</div>

<div class="doc">
Two numbers with same <span class="inlinecode"><span class="id" title="var">log2_up</span></span> cannot be far away. 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_same</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 0&lt;<span class="id" title="var">b</span> -&gt; <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> == <span class="id" title="var">log2_up</span> <span class="id" title="var">b</span> -&gt; <span class="id" title="var">a</span> &lt; 2*<span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">log2_up</span></span> and successor :
<ul class="doclist">
<li> the <span class="inlinecode"><span class="id" title="var">log2_up</span></span> function climbs by at most 1 at a time
<ul class="doclist">
<li> otherwise it stays at the same value

</li>
<li> the +1 steps occur after powers of two

</li>
</ul>

</li>
</ul>

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_succ_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, <span class="id" title="var">log2_up</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) &lt;= <span class="id" title="var">S</span> (<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_succ_or</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>,<br/>
&nbsp;<span class="id" title="var">log2_up</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) == <span class="id" title="var">S</span> (<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>) \/ <span class="id" title="var">log2_up</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) == <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_eq_succ_is_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>,<br/>
&nbsp;<span class="id" title="var">log2_up</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) == <span class="id" title="var">S</span> (<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>) -&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span> == 2^<span class="id" title="var">b</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_eq_succ_iff_pow2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt;<br/>
&nbsp;(<span class="id" title="var">log2_up</span> (<span class="id" title="var">S</span> <span class="id" title="var">a</span>) == <span class="id" title="var">S</span> (<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span>) &lt;-&gt; <span class="id" title="tactic">exists</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span> == 2^<span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_succ_double</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span>, 0&lt;<span class="id" title="var">a</span> -&gt;<br/>
&nbsp;<span class="id" title="var">log2_up</span> (2*<span class="id" title="var">a</span>+1) == 2 + <span class="id" title="var">log2</span> <span class="id" title="var">a</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">log2_up</span></span> and addition 
</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_up_add_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">a</span>~=1 -&gt; <span class="id" title="var">b</span>~=1 -&gt;<br/>
&nbsp;<span class="id" title="var">log2_up</span> (<span class="id" title="var">a</span>+<span class="id" title="var">b</span>) &lt;= <span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> + <span class="id" title="var">log2_up</span> <span class="id" title="var">b</span>.<br/>

<br/>
</div>

<div class="doc">
The sum of two <span class="inlinecode"><span class="id" title="var">log2_up</span></span> is less than twice the <span class="inlinecode"><span class="id" title="var">log2_up</span></span> of the sum.
    The large inequality is obvious thanks to monotonicity.
    The strict one requires some more work. This is almost
    a convexity inequality for points <span class="inlinecode">2<span class="id" title="var">a</span></span>, <span class="inlinecode">2<span class="id" title="var">b</span></span> and their middle <span class="inlinecode"><span class="id" title="var">a</span>+<span class="id" title="var">b</span></span> :
    ideally, we would have <span class="inlinecode">2*<span class="id" title="var">log</span>(<span class="id" title="var">a</span>+<span class="id" title="var">b</span>)</span> <span class="inlinecode">&gt;=</span> <span class="inlinecode"><span class="id" title="var">log</span>(2<span class="id" title="var">a</span>)+<span class="id" title="var">log</span>(2<span class="id" title="var">b</span>)</span> <span class="inlinecode">=</span> <span class="inlinecode">2+<span class="id" title="var">log</span></span> <span class="inlinecode"><span class="id" title="var">a</span>+<span class="id" title="var">log</span></span> <span class="inlinecode"><span class="id" title="var">b</span></span>.
    Here, we cannot do better: consider for instance a=3 b=5, then 2+3&lt;2*3

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">add_log2_up_lt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0&lt;<span class="id" title="var">a</span> -&gt; 0&lt;<span class="id" title="var">b</span> -&gt;<br/>
&nbsp;<span class="id" title="var">log2_up</span> <span class="id" title="var">a</span> + <span class="id" title="var">log2_up</span> <span class="id" title="var">b</span> &lt; 2 * <span class="id" title="var">log2_up</span> (<span class="id" title="var">a</span>+<span class="id" title="var">b</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">NZLog2UpProp</span>.<br/>

<br/>
</div>
    <div id="sidebarWrapper">
      <div id="sidebar">
        <div class="block">
          <h2 class="title">Navigation</h2>
          <div class="content">
            <ul class="menu">
              <li class="leaf">Standard Library
                <ul class="menu">
                  <li><a href="index.html">Table of contents</a></li>
                  <li><a href="genindex.html">Index</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="footer">
    <div id="nav-footer">
      <ul class="links-menu-footer">
        <li><a href="mailto:coq-www_@_inria.fr">webmaster</a></li>
        <li><a href="http://validator.w3.org/">xhtml valid</a></li>
        <li><a href="http://jigsaw.w3.org/css-validator/">CSS valid</a></li>
      </ul>
    </div>
  </div>

</div>

</body>
</html>
