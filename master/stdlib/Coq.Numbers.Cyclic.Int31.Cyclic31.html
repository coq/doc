<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/node/node.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/defaults.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/system.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/user/user.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/style.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/coqdoc.css" />

<title>Standard Library | The Coq Proof Assistant</title>

</head>

<body>

<div id="container">
  <div id="headertop">
    <div id="nav">
      <ul class="links-menu">
        <li><a href="//coq.inria.fr/" class="active">Home</a></li>
        <li><a href="//coq.inria.fr/about-coq" title="More about coq">About Coq</a></li>
        <li><a href="//coq.inria.fr/download">Get Coq</a></li>
        <li><a href="//coq.inria.fr/documentation">Documentation</a></li>
        <li><a href="//coq.inria.fr/community">Community</a></li>
      </ul>
    </div>
  </div>

  <div id="header">
    <div id="logoWrapper">
      <div id="logo"><a href="//coq.inria.fr/" title="Home"><img src="//coq.inria.fr/files/barron_logo.png" alt="Home" /></a>
      </div>
      <div id="siteName"><a href="//coq.inria.fr/" title="Home">The Coq Proof Assistant</a>
      </div>
    </div>
  </div>

  <div id="content">

<h1 class="libtitle">Library Coq.Numbers.Cyclic.Int31.Cyclic31</h1>

<div class="code">

<br/>
</div>

<div class="doc">
This library has been deprecated since Coq version 8.10. 
<div class="paragraph"> </div>

<a id="lab255"></a><h1 class="section">Int31 numbers defines indeed a cyclic structure : Z/(2^31)Z</h1>

<div class="paragraph"> </div>


<div class="paragraph"> </div>

Author: Arnaud Spiwack (+ Pierre Letouzey)

</div>
<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Min</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Int31</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Znumtheory</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Zgcd_alt</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Zpow_facts</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">CyclicAxioms</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Lia</span>.<br/>

<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">nat_scope</span>.<br/>
<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">int31_scope</span>.<br/>

<br/>
<span class="id" title="keyword">Local Hint Resolve</span> <span class="id" title="var">Z.lt_gt</span> <span class="id" title="var">Z.div_pos</span> : <span class="id" title="var">zarith</span>.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Basics</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab256"></a><h1 class="section">Basic results about <span class="inlinecode"><span class="id" title="var">iszero</span></span>, <span class="inlinecode"><span class="id" title="var">shiftl</span></span>, <span class="inlinecode"><span class="id" title="var">shiftr</span></span></h1>

</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iszero_eq0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">iszero</span> <span class="id" title="var">x</span> = <span class="id" title="var">true</span> -&gt; <span class="id" title="var">x</span>=0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iszero_not_eq0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">iszero</span> <span class="id" title="var">x</span> = <span class="id" title="var">false</span> -&gt; <span class="id" title="var">x</span>&lt;&gt;0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sneakl_shiftr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> = <span class="id" title="var">sneakl</span> (<span class="id" title="var">firstr</span> <span class="id" title="var">x</span>) (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sneakr_shiftl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> = <span class="id" title="var">sneakr</span> (<span class="id" title="var">firstl</span> <span class="id" title="var">x</span>) (<span class="id" title="var">shiftl</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">twice_zero</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">twice</span> <span class="id" title="var">x</span> = 0 &lt;-&gt; <span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span> = 1.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">twice_or_twice_plus_one</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">x</span> = <span class="id" title="var">twice</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>) \/ <span class="id" title="var">x</span> = <span class="id" title="var">twice_plus_one</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab257"></a><h1 class="section">Iterated shift to the right</h1>

</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> := <span class="id" title="var">nat_rect</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">shiftr</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftr_S</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">shiftr</span> (<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftr_S_tail</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">nshiftr</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>) <span class="id" title="var">n</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftr_n_0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <span class="id" title="var">nshiftr</span> 0 <span class="id" title="var">n</span> = 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftr_size</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> <span class="id" title="var">size</span> = 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftr_above_size</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span>, <span class="id" title="var">size</span>&lt;=<span class="id" title="var">k</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> <span class="id" title="var">k</span> = 0.<br/>

<br/>
</div>

<div class="doc">
<a id="lab258"></a><h1 class="section">Iterated shift to the left</h1>

</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> := <span class="id" title="var">nat_rect</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">shiftl</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftl_S</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">shiftl</span> (<span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftl_S_tail</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) = <span class="id" title="var">nshiftl</span> (<span class="id" title="var">shiftl</span> <span class="id" title="var">x</span>) <span class="id" title="var">n</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftl_n_0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span>, <span class="id" title="var">nshiftl</span> 0 <span class="id" title="var">n</span> = 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftl_size</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> <span class="id" title="var">size</span> = 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftl_above_size</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span>, <span class="id" title="var">size</span>&lt;=<span class="id" title="var">k</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> <span class="id" title="var">k</span> = 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">firstr_firstl</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstr</span> <span class="id" title="var">x</span> = <span class="id" title="var">firstl</span> (<span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> (<span class="id" title="var">pred</span> <span class="id" title="var">size</span>)).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">firstl_firstr</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">firstr</span> (<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">pred</span> <span class="id" title="var">size</span>)).<br/>

<br/>
</div>

<div class="doc">
More advanced results about <span class="inlinecode"><span class="id" title="var">nshiftr</span></span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftr_predsize_0_firstl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">pred</span> <span class="id" title="var">size</span>) = 0 -&gt; <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftr_0_propagates</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span>, <span class="id" title="var">n</span> &lt;= <span class="id" title="var">p</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> = 0 -&gt; <span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> <span class="id" title="var">p</span> = 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nshiftr_0_firstl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">n</span> &lt; <span class="id" title="var">size</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> = 0 -&gt; <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab259"></a><h1 class="section">Some induction principles over <span class="inlinecode"><span class="id" title="var">int31</span></span></h1>

<div class="paragraph"> </div>

 Not used for the moment. Are they really useful ? 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">int31_ind_sneakl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">P</span> : <span class="id" title="var">int31</span>-&gt;<span class="id" title="keyword">Prop</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">P</span> 0 -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">sneakl</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">int31_ind_twice</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">P</span> : <span class="id" title="var">int31</span>-&gt;<span class="id" title="keyword">Prop</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">P</span> 0 -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">twice</span> <span class="id" title="var">x</span>)) -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span> -&gt; <span class="id" title="var">P</span> (<span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span>)) -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">P</span> <span class="id" title="var">x</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab260"></a><h1 class="section">Some generic results about <span class="inlinecode"><span class="id" title="var">recr</span></span></h1>

</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">Recr</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">recr</span></span> satisfies the fixpoint equation used for its definition. 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Variable</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">case0</span>:<span class="id" title="var">A</span>)(<span class="id" title="var">caserec</span>:<span class="id" title="var">digits</span>-&gt;<span class="id" title="var">int31</span>-&gt;<span class="id" title="var">A</span>-&gt;<span class="id" title="var">A</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">recr_aux_eqn</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">iszero</span> <span class="id" title="var">x</span> = <span class="id" title="var">false</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">recr_aux</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> <span class="id" title="var">x</span> =<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">caserec</span> (<span class="id" title="var">firstr</span> <span class="id" title="var">x</span>) (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>) (<span class="id" title="var">recr_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>)).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">recr_aux_converges</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span>, <span class="id" title="var">n</span> &lt;= <span class="id" title="var">size</span> -&gt; <span class="id" title="var">n</span> &lt;= <span class="id" title="var">p</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">recr_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> (<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">size</span> - <span class="id" title="var">n</span>)) =<br/>
&nbsp;&nbsp;<span class="id" title="var">recr_aux</span> <span class="id" title="var">p</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> (<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">size</span> - <span class="id" title="var">n</span>)).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">recr_eqn</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">iszero</span> <span class="id" title="var">x</span> = <span class="id" title="var">false</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">recr</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> <span class="id" title="var">x</span> =<br/>
&nbsp;&nbsp;<span class="id" title="var">caserec</span> (<span class="id" title="var">firstr</span> <span class="id" title="var">x</span>) (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>) (<span class="id" title="var">recr</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>)).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">recr</span></span> is usually equivalent to a variant <span class="inlinecode"><span class="id" title="var">recrbis</span></span>
     written without <span class="inlinecode"><span class="id" title="var">iszero</span></span> check. 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">recrbis_aux</span> (<span class="id" title="var">n</span>:<span class="id" title="var">nat</span>)(<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">case0</span>:<span class="id" title="var">A</span>)(<span class="id" title="var">caserec</span>:<span class="id" title="var">digits</span>-&gt;<span class="id" title="var">int31</span>-&gt;<span class="id" title="var">A</span>-&gt;<span class="id" title="var">A</span>)<br/>
&nbsp;(<span class="id" title="var">i</span>:<span class="id" title="var">int31</span>) : <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; <span class="id" title="var">case0</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">next</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">si</span> := <span class="id" title="var">shiftr</span> <span class="id" title="var">i</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">caserec</span> (<span class="id" title="var">firstr</span> <span class="id" title="var">i</span>) <span class="id" title="var">si</span> (<span class="id" title="var">recrbis_aux</span> <span class="id" title="var">next</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> <span class="id" title="var">si</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">recrbis</span> := <span class="id" title="var">recrbis_aux</span> <span class="id" title="var">size</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Hypothesis</span> <span class="id" title="var">case0_caserec</span> : <span class="id" title="var">caserec</span> <span class="id" title="var">D0</span> 0 <span class="id" title="var">case0</span> = <span class="id" title="var">case0</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">recrbis_aux_equiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">recrbis_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> <span class="id" title="var">x</span> = <span class="id" title="var">recr_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">recrbis_equiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">recrbis</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> <span class="id" title="var">x</span> = <span class="id" title="var">recr</span> <span class="id" title="var">A</span> <span class="id" title="var">case0</span> <span class="id" title="var">caserec</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Recr</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab261"></a><h1 class="section">Incrementation</h1>

</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">Incr</span>.<br/>

<br/>
</div>

<div class="doc">
Variant of <span class="inlinecode"><span class="id" title="var">incr</span></span> via <span class="inlinecode"><span class="id" title="var">recrbis</span></span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">Incr</span> (<span class="id" title="var">b</span> : <span class="id" title="var">digits</span>) (<span class="id" title="var">si</span> <span class="id" title="keyword">rec</span> : <span class="id" title="var">int31</span>) :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">D0</span> =&gt; <span class="id" title="var">sneakl</span> <span class="id" title="var">D1</span> <span class="id" title="var">si</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">D1</span> =&gt; <span class="id" title="var">sneakl</span> <span class="id" title="var">D0</span> <span class="id" title="keyword">rec</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">incrbis_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> := <span class="id" title="var">recrbis_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">_</span> <span class="id" title="var">In</span> <span class="id" title="var">Incr</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">incrbis_aux_equiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">incrbis_aux</span> <span class="id" title="var">size</span> <span class="id" title="var">x</span> = <span class="id" title="var">incr</span> <span class="id" title="var">x</span>.<br/>

<br/>
</div>

<div class="doc">
Recursive equations satisfied by <span class="inlinecode"><span class="id" title="var">incr</span></span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">incr_eqn1</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstr</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span> -&gt; <span class="id" title="var">incr</span> <span class="id" title="var">x</span> = <span class="id" title="var">twice_plus_one</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">incr_eqn2</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstr</span> <span class="id" title="var">x</span> = <span class="id" title="var">D1</span> -&gt; <span class="id" title="var">incr</span> <span class="id" title="var">x</span> = <span class="id" title="var">twice</span> (<span class="id" title="var">incr</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>)).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">incr_twice</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">incr</span> (<span class="id" title="var">twice</span> <span class="id" title="var">x</span>) = <span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">incr_twice_plus_one_firstl</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span> -&gt; <span class="id" title="var">incr</span> (<span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span>) = <span class="id" title="var">twice</span> (<span class="id" title="var">incr</span> <span class="id" title="var">x</span>).<br/>

<br/>
</div>

<div class="doc">
The previous result is actually true even without the
     constraint on <span class="inlinecode"><span class="id" title="var">firstl</span></span>, but this is harder to prove
     (see later). 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Incr</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab262"></a><h1 class="section">Conversion to <span class="inlinecode"><span class="id" title="var">Z</span></span> : the <span class="inlinecode"><span class="id" title="var">phi</span></span> function</h1>

</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">Phi</span>.<br/>

<br/>
</div>

<div class="doc">
Variant of <span class="inlinecode"><span class="id" title="var">phi</span></span> via <span class="inlinecode"><span class="id" title="var">recrbis</span></span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Let</span> <span class="id" title="var">Phi</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">b</span> (<span class="id" title="var">_</span>:<span class="id" title="var">int31</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">b</span> <span class="id" title="keyword">with</span> <span class="id" title="var">D0</span> =&gt; <span class="id" title="var">Z.double</span> | <span class="id" title="var">D1</span> =&gt; <span class="id" title="var">Z.succ_double</span> <span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">phibis_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> := <span class="id" title="var">recrbis_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">_</span> <span class="id" title="var">Z0</span> <span class="id" title="var">Phi</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phibis_aux_equiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">phibis_aux</span> <span class="id" title="var">size</span> <span class="id" title="var">x</span> = <span class="id" title="var">phi</span> <span class="id" title="var">x</span>.<br/>

<br/>
</div>

<div class="doc">
Recursive equations satisfied by <span class="inlinecode"><span class="id" title="var">phi</span></span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_eqn1</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstr</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">phi</span> <span class="id" title="var">x</span> = <span class="id" title="var">Z.double</span> (<span class="id" title="var">phi</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>)).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_eqn2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstr</span> <span class="id" title="var">x</span> = <span class="id" title="var">D1</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">phi</span> <span class="id" title="var">x</span> = <span class="id" title="var">Z.succ_double</span> (<span class="id" title="var">phi</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>)).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_twice_firstl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">phi</span> (<span class="id" title="var">twice</span> <span class="id" title="var">x</span>) = <span class="id" title="var">Z.double</span> (<span class="id" title="var">phi</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_twice_plus_one_firstl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">phi</span> (<span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span>) = <span class="id" title="var">Z.succ_double</span> (<span class="id" title="var">phi</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Phi</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">phi</span></span> <span class="inlinecode"><span class="id" title="var">x</span></span> is positive and lower than <span class="inlinecode">2^31</span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phibis_aux_pos</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, (0 &lt;= <span class="id" title="var">phibis_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>)%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phibis_aux_bounded</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">n</span> &lt;= <span class="id" title="var">size</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="var">phibis_aux</span> <span class="id" title="var">n</span> (<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">size</span>-<span class="id" title="var">n</span>)) &lt; 2 ^ (<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">n</span>))%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_nonneg</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, (0 &lt;= <span class="id" title="var">phi</span> <span class="id" title="var">x</span>)%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Hint Resolve</span> <span class="id" title="var">phi_nonneg</span> : <span class="id" title="var">zarith</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_bounded</span>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, (0 &lt;= <span class="id" title="var">phi</span> <span class="id" title="var">x</span> &lt; 2 ^ (<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>))%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phibis_aux_lowerbound</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstr</span> (<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>) = <span class="id" title="var">D1</span> -&gt;<br/>
&nbsp;&nbsp;(2 ^ <span class="id" title="var">Z.of_nat</span> <span class="id" title="var">n</span> &lt;= <span class="id" title="var">phibis_aux</span> (<span class="id" title="var">S</span> <span class="id" title="var">n</span>) <span class="id" title="var">x</span>)%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_lowerbound</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">D1</span> -&gt; (2^(<span class="id" title="var">Z.of_nat</span> (<span class="id" title="var">pred</span> <span class="id" title="var">size</span>)) &lt;= <span class="id" title="var">phi</span> <span class="id" title="var">x</span>)%<span class="id" title="var">Z</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab263"></a><h1 class="section">Equivalence modulo <span class="inlinecode">2^<span class="id" title="var">n</span></span></h1>

</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">EqShiftL</span>.<br/>

<br/>
</div>

<div class="doc">
After killing <span class="inlinecode"><span class="id" title="var">n</span></span> bits at the left, are the numbers equal ?
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">EqShiftL</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span> = <span class="id" title="var">nshiftl</span> <span class="id" title="var">y</span> <span class="id" title="var">n</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_zero</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">EqShiftL</span> <span class="id" title="var">O</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> &lt;-&gt; <span class="id" title="var">x</span> = <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_size</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">size</span>&lt;=<span class="id" title="var">k</span> -&gt; <span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_le</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">k'</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">k</span> &lt;= <span class="id" title="var">k'</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">EqShiftL</span> <span class="id" title="var">k'</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_firstr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">k</span> &lt; <span class="id" title="var">size</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">firstr</span> <span class="id" title="var">x</span> = <span class="id" title="var">firstr</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_twice</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> (<span class="id" title="var">twice</span> <span class="id" title="var">x</span>) (<span class="id" title="var">twice</span> <span class="id" title="var">y</span>) &lt;-&gt; <span class="id" title="var">EqShiftL</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab264"></a><h1 class="section">From int31 to list of digits.</h1>

<div class="paragraph"> </div>

 Lower (=rightmost) bits comes first. 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">i2l</span> := <span class="id" title="var">recrbis</span> <span class="id" title="var">_</span> <span class="id" title="var">nil</span> (<span class="id" title="keyword">fun</span> <span class="id" title="var">d</span> <span class="id" title="var">_</span> <span class="id" title="keyword">rec</span> =&gt; <span class="id" title="var">d</span>::<span class="id" title="keyword">rec</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">i2l_length</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">length</span> (<span class="id" title="var">i2l</span> <span class="id" title="var">x</span>) = <span class="id" title="var">size</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">lshiftl</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">nil</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">d</span>::<span class="id" title="var">l</span> =&gt; <span class="id" title="var">sneakl</span> <span class="id" title="var">d</span> (<span class="id" title="var">lshiftl</span> <span class="id" title="var">l</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">l2i</span> <span class="id" title="var">l</span> := <span class="id" title="var">lshiftl</span> <span class="id" title="var">l</span> <span class="id" title="keyword">On</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">l2i_i2l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">l2i</span> (<span class="id" title="var">i2l</span> <span class="id" title="var">x</span>) = <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">i2l_sneakr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">i2l</span> (<span class="id" title="var">sneakr</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span>) = <span class="id" title="var">tail</span> (<span class="id" title="var">i2l</span> <span class="id" title="var">x</span>) ++ <span class="id" title="var">d</span>::<span class="id" title="var">nil</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">i2l_sneakl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">i2l</span> (<span class="id" title="var">sneakl</span> <span class="id" title="var">d</span> <span class="id" title="var">x</span>) = <span class="id" title="var">d</span> :: <span class="id" title="var">removelast</span> (<span class="id" title="var">i2l</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">i2l_l2i</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>, <span class="id" title="var">length</span> <span class="id" title="var">l</span> = <span class="id" title="var">size</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">i2l</span> (<span class="id" title="var">l2i</span> <span class="id" title="var">l</span>) = <span class="id" title="var">l</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">cstlist</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>)(<span class="id" title="var">a</span>:<span class="id" title="var">A</span>) <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; <span class="id" title="var">nil</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">a</span>::<span class="id" title="var">cstlist</span> <span class="id" title="var">_</span> <span class="id" title="var">a</span> <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">i2l_nshiftl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">n</span>&lt;=<span class="id" title="var">size</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">i2l</span> (<span class="id" title="var">nshiftl</span> <span class="id" title="var">x</span> <span class="id" title="var">n</span>) = <span class="id" title="var">cstlist</span> <span class="id" title="var">_</span> <span class="id" title="var">D0</span> <span class="id" title="var">n</span> ++ <span class="id" title="var">firstn</span> (<span class="id" title="var">size</span>-<span class="id" title="var">n</span>) (<span class="id" title="var">i2l</span> <span class="id" title="var">x</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">i2l</span></span> can be used to define a relation equivalent to <span class="inlinecode"><span class="id" title="var">EqShiftL</span></span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_i2l</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>  &lt;-&gt; <span class="id" title="var">firstn</span> (<span class="id" title="var">size</span>-<span class="id" title="var">k</span>) (<span class="id" title="var">i2l</span> <span class="id" title="var">x</span>) = <span class="id" title="var">firstn</span> (<span class="id" title="var">size</span>-<span class="id" title="var">k</span>) (<span class="id" title="var">i2l</span> <span class="id" title="var">y</span>).<br/>

<br/>
</div>

<div class="doc">
This equivalence allows proving easily the following delicate
     result 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_twice_plus_one</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> (<span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span>) (<span class="id" title="var">twice_plus_one</span> <span class="id" title="var">y</span>) &lt;-&gt; <span class="id" title="var">EqShiftL</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>) <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_shiftr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> (<span class="id" title="var">S</span> <span class="id" title="var">k</span>) (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>) (<span class="id" title="var">shiftr</span> <span class="id" title="var">y</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_incrbis</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">n</span>&lt;=<span class="id" title="var">size</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="var">n</span>+<span class="id" title="var">k</span>=<span class="id" title="var">S</span> <span class="id" title="var">size</span>)%<span class="id" title="var">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> <span class="id" title="var">k</span> (<span class="id" title="var">incrbis_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>) (<span class="id" title="var">incrbis_aux</span> <span class="id" title="var">n</span> <span class="id" title="var">y</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">EqShiftL_incr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> 1 <span class="id" title="var">x</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">EqShiftL</span> 1 (<span class="id" title="var">incr</span> <span class="id" title="var">x</span>) (<span class="id" title="var">incr</span> <span class="id" title="var">y</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">EqShiftL</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab265"></a><h1 class="section">More equations about <span class="inlinecode"><span class="id" title="var">incr</span></span></h1>

</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">incr_twice_plus_one</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">incr</span> (<span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span>) = <span class="id" title="var">twice</span> (<span class="id" title="var">incr</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">incr_firstr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstr</span> (<span class="id" title="var">incr</span> <span class="id" title="var">x</span>) &lt;&gt; <span class="id" title="var">firstr</span> <span class="id" title="var">x</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">incr_inv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">incr</span> <span class="id" title="var">x</span> = <span class="id" title="var">twice_plus_one</span> <span class="id" title="var">y</span> -&gt; <span class="id" title="var">x</span> = <span class="id" title="var">twice</span> <span class="id" title="var">y</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab266"></a><h1 class="section">Conversion from <span class="inlinecode"><span class="id" title="var">Z</span></span> : the <span class="inlinecode"><span class="id" title="var">phi_inv</span></span> function</h1>

<div class="paragraph"> </div>

 First, recursive equations 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_inv_double_plus_one</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi_inv</span> (<span class="id" title="var">Z.succ_double</span> <span class="id" title="var">z</span>) = <span class="id" title="var">twice_plus_one</span> (<span class="id" title="var">phi_inv</span> <span class="id" title="var">z</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_inv_double</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi_inv</span> (<span class="id" title="var">Z.double</span> <span class="id" title="var">z</span>) = <span class="id" title="var">twice</span> (<span class="id" title="var">phi_inv</span> <span class="id" title="var">z</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_inv_incr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">z</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">phi_inv</span> (<span class="id" title="var">Z.succ</span> <span class="id" title="var">z</span>) = <span class="id" title="var">incr</span> (<span class="id" title="var">phi_inv</span> <span class="id" title="var">z</span>).<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">phi_inv</span></span> <span class="inlinecode"><span class="id" title="var">o</span></span> <span class="inlinecode"><span class="id" title="var">inv</span></span>, the always-exact and easy-to-prove trip :
     from int31 to Z and then back to int31. 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_inv_phi_aux</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span>, <span class="id" title="var">n</span> &lt;= <span class="id" title="var">size</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi_inv</span> (<span class="id" title="var">phibis_aux</span> <span class="id" title="var">n</span> (<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">size</span>-<span class="id" title="var">n</span>))) =<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">nshiftr</span> <span class="id" title="var">x</span> (<span class="id" title="var">size</span>-<span class="id" title="var">n</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_inv_phi</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">phi_inv</span> (<span class="id" title="var">phi</span> <span class="id" title="var">x</span>) = <span class="id" title="var">x</span>.<br/>

<br/>
</div>

<div class="doc">
The other composition <span class="inlinecode"><span class="id" title="var">phi</span></span> <span class="inlinecode"><span class="id" title="var">o</span></span> <span class="inlinecode"><span class="id" title="var">phi_inv</span></span> is harder to prove correct.
     In particular, an overflow can happen, so a modulo is needed.
     For the moment, we proceed via several steps, the first one
     being a detour to <span class="inlinecode"><span class="id" title="var">positive_to_in31</span></span>. 
<div class="paragraph"> </div>

<a id="lab267"></a><h1 class="section"><span class="inlinecode"><span class="id" title="var">positive_to_int31</span></span></h1>

<div class="paragraph"> </div>

 A variant of <span class="inlinecode"><span class="id" title="var">p2i</span></span> with <span class="inlinecode"><span class="id" title="var">twice</span></span> and <span class="inlinecode"><span class="id" title="var">twice_plus_one</span></span> instead of
     <span class="inlinecode">2*<span class="id" title="var">i</span></span> and <span class="inlinecode">2*<span class="id" title="var">i</span>+1</span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">p2ibis</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> : (<span class="id" title="var">N</span>*<span class="id" title="var">int31</span>)%<span class="id" title="keyword">type</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; (<span class="id" title="var">Npos</span> <span class="id" title="var">p</span>, <span class="id" title="keyword">On</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xO</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">r</span>,<span class="id" title="var">i</span>) := <span class="id" title="var">p2ibis</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">r</span>, <span class="id" title="var">twice</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xI</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">r</span>,<span class="id" title="var">i</span>) := <span class="id" title="var">p2ibis</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">r</span>, <span class="id" title="var">twice_plus_one</span> <span class="id" title="var">i</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xH</span> =&gt; (<span class="id" title="var">N0</span>, <span class="id" title="var">In</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">p2ibis_bounded</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">nshiftr</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">p2ibis</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>)) <span class="id" title="var">n</span> = 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">p2ibis_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>, (<span class="id" title="var">n</span>&lt;=<span class="id" title="var">size</span>)%<span class="id" title="var">nat</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Zpos</span> <span class="id" title="var">p</span> = (<span class="id" title="var">Z.of_N</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">p2ibis</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>)))*2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">n</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">p2ibis</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>)).<br/>

<br/>
</div>

<div class="doc">
We now prove that this <span class="inlinecode"><span class="id" title="var">p2ibis</span></span> is related to <span class="inlinecode"><span class="id" title="var">phi_inv_positive</span></span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_inv_positive_p2ibis</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>, (<span class="id" title="var">n</span>&lt;=<span class="id" title="var">size</span>)%<span class="id" title="var">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">EqShiftL</span> (<span class="id" title="var">size</span>-<span class="id" title="var">n</span>) (<span class="id" title="var">phi_inv_positive</span> <span class="id" title="var">p</span>) (<span class="id" title="var">snd</span> (<span class="id" title="var">p2ibis</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>)).<br/>

<br/>
</div>

<div class="doc">
This gives the expected result about <span class="inlinecode"><span class="id" title="var">phi</span></span> <span class="inlinecode"><span class="id" title="var">o</span></span> <span class="inlinecode"><span class="id" title="var">phi_inv</span></span>, at least
     for the positive case. 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_phi_inv_positive</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">phi</span> (<span class="id" title="var">phi_inv_positive</span> <span class="id" title="var">p</span>) = (<span class="id" title="var">Zpos</span> <span class="id" title="var">p</span>) <span class="id" title="var">mod</span> (2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>)).<br/>

<br/>
</div>

<div class="doc">
Moreover, <span class="inlinecode"><span class="id" title="var">p2ibis</span></span> is also related with <span class="inlinecode"><span class="id" title="var">p2i</span></span> and hence with
    <span class="inlinecode"><span class="id" title="var">positive_to_int31</span></span>. 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">double_twice_firstl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="var">Twon</span>*<span class="id" title="var">x</span> = <span class="id" title="var">twice</span> <span class="id" title="var">x</span>)%<span class="id" title="var">int31</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">double_twice_plus_one_firstl</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> = <span class="id" title="var">D0</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="var">Twon</span>*<span class="id" title="var">x</span>+<span class="id" title="var">In</span> = <span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span>)%<span class="id" title="var">int31</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">p2i_p2ibis</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>, (<span class="id" title="var">n</span>&lt;=<span class="id" title="var">size</span>)%<span class="id" title="var">nat</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">p2i</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> = <span class="id" title="var">p2ibis</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">positive_to_int31_phi_inv_positive</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">snd</span> (<span class="id" title="var">positive_to_int31</span> <span class="id" title="var">p</span>) = <span class="id" title="var">phi_inv_positive</span> <span class="id" title="var">p</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">positive_to_int31_spec</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Zpos</span> <span class="id" title="var">p</span> = (<span class="id" title="var">Z.of_N</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">positive_to_int31</span> <span class="id" title="var">p</span>)))*2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>) +<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">positive_to_int31</span> <span class="id" title="var">p</span>)).<br/>

<br/>
</div>

<div class="doc">
Thanks to the result about <span class="inlinecode"><span class="id" title="var">phi</span></span> <span class="inlinecode"><span class="id" title="var">o</span></span> <span class="inlinecode"><span class="id" title="var">phi_inv_positive</span></span>, we can
     now establish easily the most general results about
     <span class="inlinecode"><span class="id" title="var">phi</span></span> <span class="inlinecode"><span class="id" title="var">o</span></span> <span class="inlinecode"><span class="id" title="var">twice</span></span> and so one. 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_twice</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi</span> (<span class="id" title="var">twice</span> <span class="id" title="var">x</span>) = (<span class="id" title="var">Z.double</span> (<span class="id" title="var">phi</span> <span class="id" title="var">x</span>)) <span class="id" title="var">mod</span> 2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_twice_plus_one</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi</span> (<span class="id" title="var">twice_plus_one</span> <span class="id" title="var">x</span>) = (<span class="id" title="var">Z.succ_double</span> (<span class="id" title="var">phi</span> <span class="id" title="var">x</span>)) <span class="id" title="var">mod</span> 2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_incr</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi</span> (<span class="id" title="var">incr</span> <span class="id" title="var">x</span>) = (<span class="id" title="var">Z.succ</span> (<span class="id" title="var">phi</span> <span class="id" title="var">x</span>)) <span class="id" title="var">mod</span> 2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>).<br/>

<br/>
</div>

<div class="doc">
With the previous results, we can deal with <span class="inlinecode"><span class="id" title="var">phi</span></span> <span class="inlinecode"><span class="id" title="var">o</span></span> <span class="inlinecode"><span class="id" title="var">phi_inv</span></span> even
    in the negative case 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_phi_inv_negative</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">p</span>, <span class="id" title="var">phi</span> (<span class="id" title="var">incr</span> (<span class="id" title="var">complement_negative</span> <span class="id" title="var">p</span>)) = (<span class="id" title="var">Zneg</span> <span class="id" title="var">p</span>) <span class="id" title="var">mod</span> 2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_phi_inv</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">z</span>, <span class="id" title="var">phi</span> (<span class="id" title="var">phi_inv</span> <span class="id" title="var">z</span>) = <span class="id" title="var">z</span> <span class="id" title="var">mod</span> 2 ^ (<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>).<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Basics</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">int31_ops</span> : <span class="id" title="var">ZnZ.Ops</span> <span class="id" title="var">int31</span> :=<br/>
{<br/>
&nbsp;<span class="id" title="var">digits</span>      := 31%<span class="id" title="var">positive</span>; <br/>
&nbsp;<span class="id" title="var">zdigits</span>     := 31; <br/>
&nbsp;<span class="id" title="var">to_Z</span>        := <span class="id" title="var">phi</span>; <br/>
&nbsp;<span class="id" title="var">of_pos</span>      := <span class="id" title="var">positive_to_int31</span>; <br/>
&nbsp;<span class="id" title="var">head0</span>       := <span class="id" title="var">head031</span>;  <br/>
&nbsp;<span class="id" title="var">tail0</span>       := <span class="id" title="var">tail031</span>;  <br/>
&nbsp;<span class="id" title="var">zero</span>        := 0;<br/>
&nbsp;<span class="id" title="var">one</span>         := 1;<br/>
&nbsp;<span class="id" title="var">minus_one</span>   := <span class="id" title="var">Tn</span>; <br/>
&nbsp;<span class="id" title="var">compare</span>     := <span class="id" title="var">compare31</span>;<br/>
&nbsp;<span class="id" title="var">eq0</span>         := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">i</span> ?= 0 <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">true</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>;<br/>
&nbsp;<span class="id" title="var">opp_c</span>       := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; 0 -<span class="id" title="var">c</span> <span class="id" title="var">i</span>;<br/>
&nbsp;<span class="id" title="var">opp</span>         := <span class="id" title="var">opp31</span>;<br/>
&nbsp;<span class="id" title="var">opp_carry</span>   := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; 0-<span class="id" title="var">i</span>-1;<br/>
&nbsp;<span class="id" title="var">succ_c</span>      := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="var">i</span> +<span class="id" title="var">c</span> 1;<br/>
&nbsp;<span class="id" title="var">add_c</span>       := <span class="id" title="var">add31c</span>;<br/>
&nbsp;<span class="id" title="var">add_carry_c</span> := <span class="id" title="var">add31carryc</span>;<br/>
&nbsp;<span class="id" title="var">succ</span>        := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="var">i</span> + 1;<br/>
&nbsp;<span class="id" title="var">add</span>         := <span class="id" title="var">add31</span>;<br/>
&nbsp;<span class="id" title="var">add_carry</span>   := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> =&gt; <span class="id" title="var">i</span> + <span class="id" title="var">j</span> + 1;<br/>
&nbsp;<span class="id" title="var">pred_c</span>      := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="var">i</span> -<span class="id" title="var">c</span> 1;<br/>
&nbsp;<span class="id" title="var">sub_c</span>       := <span class="id" title="var">sub31c</span>;<br/>
&nbsp;<span class="id" title="var">sub_carry_c</span> := <span class="id" title="var">sub31carryc</span>;<br/>
&nbsp;<span class="id" title="var">pred</span>        := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="var">i</span> - 1;<br/>
&nbsp;<span class="id" title="var">sub</span>         := <span class="id" title="var">sub31</span>;<br/>
&nbsp;<span class="id" title="var">sub_carry</span>   := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> =&gt; <span class="id" title="var">i</span> - <span class="id" title="var">j</span> - 1;<br/>
&nbsp;<span class="id" title="var">mul_c</span>       := <span class="id" title="var">mul31c</span>;<br/>
&nbsp;<span class="id" title="var">mul</span>         := <span class="id" title="var">mul31</span>;<br/>
&nbsp;<span class="id" title="var">square_c</span>    := <span class="id" title="keyword">fun</span> <span class="id" title="var">x</span> =&gt; <span class="id" title="var">x</span> *<span class="id" title="var">c</span> <span class="id" title="var">x</span>;<br/>
&nbsp;<span class="id" title="var">div21</span>       := <span class="id" title="var">div3121</span>;<br/>
&nbsp;<span class="id" title="var">div_gt</span>      := <span class="id" title="var">div31</span>; <br/>
&nbsp;<span class="id" title="var">div</span>         := <span class="id" title="var">div31</span>;<br/>
&nbsp;<span class="id" title="var">modulo_gt</span>   := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>,<span class="id" title="var">r</span>) := <span class="id" title="var">i</span>/<span class="id" title="var">j</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>;<br/>
&nbsp;<span class="id" title="var">modulo</span>      := <span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>,<span class="id" title="var">r</span>) := <span class="id" title="var">i</span>/<span class="id" title="var">j</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>;<br/>
&nbsp;<span class="id" title="var">gcd_gt</span>      := <span class="id" title="var">gcd31</span>;<br/>
&nbsp;<span class="id" title="var">gcd</span>         := <span class="id" title="var">gcd31</span>;<br/>
&nbsp;<span class="id" title="var">add_mul_div</span> := <span class="id" title="var">addmuldiv31</span>;<br/>
&nbsp;<span class="id" title="var">pos_mod</span>     := <br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> <span class="id" title="var">i</span> =&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> ?= 31 <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">addmuldiv31</span> <span class="id" title="var">p</span> 0 (<span class="id" title="var">addmuldiv31</span> (31-<span class="id" title="var">p</span>) <span class="id" title="var">i</span> 0)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">i</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>;<br/>
&nbsp;<span class="id" title="var">is_even</span>      :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">fun</span> <span class="id" title="var">i</span> =&gt; <span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>,<span class="id" title="var">r</span>) := <span class="id" title="var">i</span>/2 <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">r</span> ?= 0 <span class="id" title="keyword">with</span> <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">true</span> | <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span> <span class="id" title="keyword">end</span>;<br/>
&nbsp;<span class="id" title="var">sqrt2</span>       := <span class="id" title="var">sqrt312</span>;<br/>
&nbsp;<span class="id" title="var">sqrt</span>        := <span class="id" title="var">sqrt31</span>;<br/>
&nbsp;<span class="id" title="var">lor</span>         := <span class="id" title="var">lor31</span>;<br/>
&nbsp;<span class="id" title="var">land</span>        := <span class="id" title="var">land31</span>;<br/>
&nbsp;<span class="id" title="var">lxor</span>        := <span class="id" title="var">lxor31</span><br/>
}.<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">Int31_Specs</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Local Open</span> <span class="id" title="keyword">Scope</span> <span class="id" title="var">Z_scope</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Notation</span> &quot;[| x |]" := (<span class="id" title="var">phi</span> <span class="id" title="var">x</span>)  (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0, <span class="id" title="var">x</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99).<br/>

<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">wB_pos</span> : <span class="id" title="var">wB</span> &gt; 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Notation</span> &quot;[+| c |]" :=<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">interp_carry</span> 1 <span class="id" title="var">wB</span> <span class="id" title="var">phi</span> <span class="id" title="var">c</span>)  (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0, <span class="id" title="var">c</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Notation</span> &quot;[-| c |]" :=<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">interp_carry</span> (-1) <span class="id" title="var">wB</span> <span class="id" title="var">phi</span> <span class="id" title="var">c</span>)  (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0, <span class="id" title="var">c</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Notation</span> &quot;[|| x ||]" :=<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">zn2z_to_Z</span> <span class="id" title="var">wB</span> <span class="id" title="var">phi</span> <span class="id" title="var">x</span>)  (<span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 0, <span class="id" title="var">x</span> <span class="id" title="tactic">at</span> <span class="id" title="keyword">level</span> 99).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_zdigits</span> : [| 31 |] = 31.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_more_than_1_digit</span>: 1 &lt; 31.<br/>
 
<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_0</span>   : [| 0 |] = 0.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_1</span>   : [| 1 |] = 1.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_m1</span> : [| <span class="id" title="var">Tn</span> |] = <span class="id" title="var">wB</span> - 1.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_compare</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">x</span> ?= <span class="id" title="var">y</span>)%<span class="id" title="var">int31</span> = ([|<span class="id" title="var">x</span>|] ?= [|<span class="id" title="var">y</span>|]).<br/>
 
<br/>
</div>

<div class="doc">
Addition 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_add_c</span>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [+|<span class="id" title="var">add31c</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>|] = [|<span class="id" title="var">x</span>|] + [|<span class="id" title="var">y</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_succ_c</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [+|<span class="id" title="var">add31c</span> <span class="id" title="var">x</span> 1|] = [|<span class="id" title="var">x</span>|] + 1.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_add_carry_c</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [+|<span class="id" title="var">add31carryc</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>|] = [|<span class="id" title="var">x</span>|] + [|<span class="id" title="var">y</span>|] + 1.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_add</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [|<span class="id" title="var">x</span>+<span class="id" title="var">y</span>|] = ([|<span class="id" title="var">x</span>|] + [|<span class="id" title="var">y</span>|]) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_add_carry</span> :<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [|<span class="id" title="var">x</span>+<span class="id" title="var">y</span>+1|] = ([|<span class="id" title="var">x</span>|] + [|<span class="id" title="var">y</span>|] + 1) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_succ</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|<span class="id" title="var">x</span>+1|] = ([|<span class="id" title="var">x</span>|] + 1) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
</div>

<div class="doc">
Subtraction 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_sub_c</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [-|<span class="id" title="var">sub31c</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>|] = [|<span class="id" title="var">x</span>|] - [|<span class="id" title="var">y</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_sub_carry_c</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [-|<span class="id" title="var">sub31carryc</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>|] = [|<span class="id" title="var">x</span>|] - [|<span class="id" title="var">y</span>|] - 1.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_sub</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [|<span class="id" title="var">x</span>-<span class="id" title="var">y</span>|] = ([|<span class="id" title="var">x</span>|] - [|<span class="id" title="var">y</span>|]) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_sub_carry</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [|<span class="id" title="var">x</span>-<span class="id" title="var">y</span>-1|] = ([|<span class="id" title="var">x</span>|] - [|<span class="id" title="var">y</span>|] - 1) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_opp_c</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [-|<span class="id" title="var">sub31c</span> 0 <span class="id" title="var">x</span>|] = -[|<span class="id" title="var">x</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_opp</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|0 - <span class="id" title="var">x</span>|] = (-[|<span class="id" title="var">x</span>|]) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_opp_carry</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|0 - <span class="id" title="var">x</span> - 1|] = <span class="id" title="var">wB</span> - [|<span class="id" title="var">x</span>|] - 1.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_pred_c</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [-|<span class="id" title="var">sub31c</span> <span class="id" title="var">x</span> 1|] = [|<span class="id" title="var">x</span>|] - 1.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_pred</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|<span class="id" title="var">x</span>-1|] = ([|<span class="id" title="var">x</span>|] - 1) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
</div>

<div class="doc">
Multiplication 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi2_phi_inv2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [||<span class="id" title="var">phi_inv2</span> <span class="id" title="var">x</span>||] = <span class="id" title="var">x</span> <span class="id" title="var">mod</span> (<span class="id" title="var">wB</span>^2).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_mul_c</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [|| <span class="id" title="var">mul31c</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> ||] = [|<span class="id" title="var">x</span>|] * [|<span class="id" title="var">y</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_mul</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, [|<span class="id" title="var">x</span>*<span class="id" title="var">y</span>|] = ([|<span class="id" title="var">x</span>|] * [|<span class="id" title="var">y</span>|]) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_square_c</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|| <span class="id" title="var">mul31c</span> <span class="id" title="var">x</span> <span class="id" title="var">x</span> ||] = [|<span class="id" title="var">x</span>|] * [|<span class="id" title="var">x</span>|].<br/>

<br/>
</div>

<div class="doc">
Division 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_div21</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">b</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wB</span>/2 &lt;= [|<span class="id" title="var">b</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="var">a1</span>|] &lt; [|<span class="id" title="var">b</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">q</span>,<span class="id" title="var">r</span>) := <span class="id" title="var">div3121</span> <span class="id" title="var">a1</span> <span class="id" title="var">a2</span> <span class="id" title="var">b</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="var">a1</span>|] *<span class="id" title="var">wB</span>+ [|<span class="id" title="var">a2</span>|] = [|<span class="id" title="var">q</span>|] * [|<span class="id" title="var">b</span>|] + [|<span class="id" title="var">r</span>|] /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= [|<span class="id" title="var">r</span>|] &lt; [|<span class="id" title="var">b</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_div</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0 &lt; [|<span class="id" title="var">b</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">q</span>,<span class="id" title="var">r</span>) := <span class="id" title="var">div31</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="var">a</span>|] = [|<span class="id" title="var">q</span>|] * [|<span class="id" title="var">b</span>|] + [|<span class="id" title="var">r</span>|] /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;0 &lt;= [|<span class="id" title="var">r</span>|] &lt; [|<span class="id" title="var">b</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_mod</span> :  <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, 0 &lt; [|<span class="id" title="var">b</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="keyword">let</span> (<span class="id" title="var">_</span>,<span class="id" title="var">r</span>) := (<span class="id" title="var">a</span>/<span class="id" title="var">b</span>)%<span class="id" title="var">int31</span> <span class="id" title="tactic">in</span> <span class="id" title="var">r</span>|] = [|<span class="id" title="var">a</span>|] <span class="id" title="var">mod</span> [|<span class="id" title="var">b</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_gcd</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>,<br/>
&nbsp;&nbsp;[|<span class="id" title="var">gcd31</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>|] = <span class="id" title="var">Zgcdn</span> (2*<span class="id" title="var">size</span>) [|<span class="id" title="var">j</span>|] [|<span class="id" title="var">i</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_gcd</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>, <span class="id" title="var">Zis_gcd</span> [|<span class="id" title="var">a</span>|] [|<span class="id" title="var">b</span>|] [|<span class="id" title="var">gcd31</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iter_int31_iter_nat</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">A</span> <span class="id" title="var">f</span> <span class="id" title="var">i</span> <span class="id" title="var">a</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">iter_int31</span> <span class="id" title="var">i</span> <span class="id" title="var">A</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span> = <span class="id" title="var">iter_nat</span> (<span class="id" title="var">Z.abs_nat</span> [|<span class="id" title="var">i</span>|]) <span class="id" title="var">A</span> <span class="id" title="var">f</span> <span class="id" title="var">a</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">addmuldiv31_alt</span> <span class="id" title="var">n</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; <span class="id" title="var">i</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="var">addmuldiv31_alt</span> <span class="id" title="var">n</span> (<span class="id" title="var">sneakl</span> (<span class="id" title="var">firstl</span> <span class="id" title="var">j</span>) <span class="id" title="var">i</span>) (<span class="id" title="var">shiftl</span> <span class="id" title="var">j</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">addmuldiv31_equiv</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">addmuldiv31</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> = <span class="id" title="var">addmuldiv31_alt</span> (<span class="id" title="var">Z.abs_nat</span> [|<span class="id" title="var">p</span>|]) <span class="id" title="var">x</span> <span class="id" title="var">y</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_add_mul_div</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">p</span>, [|<span class="id" title="var">p</span>|] &lt;= <span class="id" title="var">Zpos</span> 31 -&gt;<br/>
&nbsp;&nbsp;&nbsp;[| <span class="id" title="var">addmuldiv31</span> <span class="id" title="var">p</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> |] =<br/>
&nbsp;&nbsp;&nbsp;([|<span class="id" title="var">x</span>|] * (2 ^ [|<span class="id" title="var">p</span>|]) + [|<span class="id" title="var">y</span>|] / (2 ^ ((<span class="id" title="var">Zpos</span> 31) - [|<span class="id" title="var">p</span>|]))) <span class="id" title="var">mod</span> <span class="id" title="var">wB</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">shift_unshift_mod_2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">n</span> <span class="id" title="var">p</span> <span class="id" title="var">a</span>, 0 &lt;= <span class="id" title="var">p</span> &lt;= <span class="id" title="var">n</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;((<span class="id" title="var">a</span> * 2 ^ (<span class="id" title="var">n</span> - <span class="id" title="var">p</span>)) <span class="id" title="var">mod</span> (2^<span class="id" title="var">n</span>) / 2 ^ (<span class="id" title="var">n</span> - <span class="id" title="var">p</span>)) <span class="id" title="var">mod</span> (2^<span class="id" title="var">n</span>) =<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">a</span> <span class="id" title="var">mod</span> 2 ^ <span class="id" title="var">p</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_pos_mod</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">w</span> <span class="id" title="var">p</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="var">ZnZ.pos_mod</span> <span class="id" title="var">p</span> <span class="id" title="var">w</span>|] = [|<span class="id" title="var">w</span>|] <span class="id" title="var">mod</span> (2 ^ [|<span class="id" title="var">p</span>|]).<br/>

<br/>
</div>

<div class="doc">
Shift operations 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_head00</span>:  <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|<span class="id" title="var">x</span>|] = 0 -&gt; [|<span class="id" title="var">head031</span> <span class="id" title="var">x</span>|] = <span class="id" title="var">Zpos</span> 31.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">head031_alt</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; 0%<span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">firstl</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">D0</span> =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">head031_alt</span> <span class="id" title="var">n</span> (<span class="id" title="var">shiftl</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">D1</span> =&gt; 0%<span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">head031_equiv</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|<span class="id" title="var">head031</span> <span class="id" title="var">x</span>|] = <span class="id" title="var">Z.of_nat</span> (<span class="id" title="var">head031_alt</span> <span class="id" title="var">size</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">phi_nz</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, 0 &lt; [|<span class="id" title="var">x</span>|] &lt;-&gt; <span class="id" title="var">x</span> &lt;&gt; 0%<span class="id" title="var">int31</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_head0</span>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,  0 &lt; [|<span class="id" title="var">x</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wB</span>/ 2 &lt;= 2 ^ ([|<span class="id" title="var">head031</span> <span class="id" title="var">x</span>|]) * [|<span class="id" title="var">x</span>|] &lt; <span class="id" title="var">wB</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_tail00</span>:  <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|<span class="id" title="var">x</span>|] = 0 -&gt; [|<span class="id" title="var">tail031</span> <span class="id" title="var">x</span>|] = <span class="id" title="var">Zpos</span> 31.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">tail031_alt</span> <span class="id" title="var">n</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">O</span> =&gt; 0%<span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S</span> <span class="id" title="var">n</span> =&gt; <span class="id" title="keyword">match</span> <span class="id" title="var">firstr</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">D0</span> =&gt; <span class="id" title="var">S</span> (<span class="id" title="var">tail031_alt</span> <span class="id" title="var">n</span> (<span class="id" title="var">shiftr</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">D1</span> =&gt; 0%<span class="id" title="var">nat</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">tail031_equiv</span> :<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, [|<span class="id" title="var">tail031</span> <span class="id" title="var">x</span>|] = <span class="id" title="var">Z.of_nat</span> (<span class="id" title="var">tail031_alt</span> <span class="id" title="var">size</span> <span class="id" title="var">x</span>).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_tail0</span>  : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, 0 &lt; [|<span class="id" title="var">x</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">exists</span> <span class="id" title="var">y</span>, 0 &lt;= <span class="id" title="var">y</span> /\ [|<span class="id" title="var">x</span>|] = (2 * <span class="id" title="var">y</span> + 1) * (2 ^ [|<span class="id" title="var">tail031</span> <span class="id" title="var">x</span>|]).<br/>

<br/>

<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">quotient_by_2</span> <span class="id" title="var">a</span>: <span class="id" title="var">a</span> - 1 &lt;= (<span class="id" title="var">a</span>/2) + (<span class="id" title="var">a</span>/2).<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt_main_trick</span> <span class="id" title="var">j</span> <span class="id" title="var">k</span>: 0 &lt;= <span class="id" title="var">j</span> -&gt; 0 &lt;= <span class="id" title="var">k</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" title="var">j</span> * <span class="id" title="var">k</span>) + <span class="id" title="var">j</span> &lt;= ((<span class="id" title="var">j</span> + <span class="id" title="var">k</span>)/2 + 1)  ^ 2.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt_main</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>: 0 &lt;= <span class="id" title="var">i</span> -&gt; 0 &lt; <span class="id" title="var">j</span> -&gt; <span class="id" title="var">i</span> &lt; ((<span class="id" title="var">j</span> + (<span class="id" title="var">i</span>/<span class="id" title="var">j</span>))/2 + 1) ^ 2.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt_init</span> <span class="id" title="var">i</span>: 1 &lt; <span class="id" title="var">i</span> -&gt; <span class="id" title="var">i</span> &lt; (<span class="id" title="var">i</span>/2 + 1) ^ 2.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt_test_true</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>: 0 &lt;= <span class="id" title="var">i</span> -&gt; 0 &lt; <span class="id" title="var">j</span> -&gt; <span class="id" title="var">i</span>/<span class="id" title="var">j</span> &gt;= <span class="id" title="var">j</span> -&gt; <span class="id" title="var">j</span> ^ 2 &lt;= <span class="id" title="var">i</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt_test_false</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>: 0 &lt;= <span class="id" title="var">i</span> -&gt; 0 &lt; <span class="id" title="var">j</span> -&gt; <span class="id" title="var">i</span>/<span class="id" title="var">j</span> &lt; <span class="id" title="var">j</span> -&gt;  (<span class="id" title="var">j</span> + (<span class="id" title="var">i</span>/<span class="id" title="var">j</span>))/2 &lt; <span class="id" title="var">j</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt31_step_def</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">sqrt31_step</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span> =<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">i</span>/<span class="id" title="var">j</span>) ?= <span class="id" title="var">j</span>)%<span class="id" title="var">int31</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lt</span> =&gt; <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> (<span class="id" title="var">fst</span> ((<span class="id" title="var">j</span> + <span class="id" title="var">fst</span>(<span class="id" title="var">i</span>/<span class="id" title="var">j</span>))/2))%<span class="id" title="var">int31</span><br/>
&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt;  <span class="id" title="var">j</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">div31_phi</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>: 0 &lt; [|<span class="id" title="var">j</span>|] -&gt; [|<span class="id" title="var">fst</span> (<span class="id" title="var">i</span>/<span class="id" title="var">j</span>)%<span class="id" title="var">int31</span>|] = [|<span class="id" title="var">i</span>|]/[|<span class="id" title="var">j</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt31_step_correct</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>:<br/>
&nbsp;&nbsp;0 &lt; [|<span class="id" title="var">i</span>|] -&gt; 0 &lt; [|<span class="id" title="var">j</span>|] -&gt; [|<span class="id" title="var">i</span>|] &lt; ([|<span class="id" title="var">j</span>|] + 1) ^ 2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;2 * [|<span class="id" title="var">j</span>|] &lt; <span class="id" title="var">wB</span> -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">j1</span> : <span class="id" title="var">int31</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;0 &lt; [|<span class="id" title="var">j1</span>|] &lt; [|<span class="id" title="var">j</span>|] -&gt; [|<span class="id" title="var">i</span>|] &lt; ([|<span class="id" title="var">j1</span>|] + 1) ^ 2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j1</span>|] ^ 2 &lt;= [|<span class="id" title="var">i</span>|] &lt; ([|<span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j1</span>|] + 1) ^ 2) -&gt;<br/>
&nbsp;&nbsp;[|<span class="id" title="var">sqrt31_step</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>|] ^ 2 &lt;= [|<span class="id" title="var">i</span>|] &lt; ([|<span class="id" title="var">sqrt31_step</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>|] + 1) ^ 2.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iter31_sqrt_correct</span> <span class="id" title="var">n</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>: 0 &lt; [|<span class="id" title="var">i</span>|] -&gt; 0 &lt; [|<span class="id" title="var">j</span>|] -&gt;<br/>
&nbsp;&nbsp;[|<span class="id" title="var">i</span>|] &lt; ([|<span class="id" title="var">j</span>|] + 1) ^ 2 -&gt; 2 * [|<span class="id" title="var">j</span>|] &lt; 2 ^ (<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>) -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">j1</span>, 0 &lt; [|<span class="id" title="var">j1</span>|] -&gt; 2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">n</span>) + [|<span class="id" title="var">j1</span>|] &lt;= [|<span class="id" title="var">j</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="var">i</span>|] &lt; ([|<span class="id" title="var">j1</span>|] + 1) ^ 2 -&gt; 2 * [|<span class="id" title="var">j1</span>|] &lt; 2 ^ (<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>) -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j1</span>|] ^ 2 &lt;= [|<span class="id" title="var">i</span>|] &lt; ([|<span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j1</span>|] + 1) ^ 2) -&gt;<br/>
&nbsp;&nbsp;[|<span class="id" title="var">iter31_sqrt</span> <span class="id" title="var">n</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>|] ^ 2 &lt;= [|<span class="id" title="var">i</span>|] &lt; ([|<span class="id" title="var">iter31_sqrt</span> <span class="id" title="var">n</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">i</span> <span class="id" title="var">j</span>|] + 1) ^ 2.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_sqrt</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="var">sqrt31</span> <span class="id" title="var">x</span>|] ^ 2 &lt;= [|<span class="id" title="var">x</span>|] &lt; ([|<span class="id" title="var">sqrt31</span> <span class="id" title="var">x</span>|] + 1) ^ 2.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt312_step_def</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">sqrt312_step</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span> =<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">ih</span> ?= <span class="id" title="var">j</span>)%<span class="id" title="var">int31</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">div3121</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>) ?= <span class="id" title="var">j</span>)%<span class="id" title="var">int31</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Lt</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">m</span> := <span class="id" title="keyword">match</span> <span class="id" title="var">j</span> +<span class="id" title="var">c</span> <span class="id" title="var">fst</span> (<span class="id" title="var">div3121</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">C0</span> <span class="id" title="var">m1</span> =&gt; <span class="id" title="var">fst</span> (<span class="id" title="var">m1</span>/2)%<span class="id" title="var">int31</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">C1</span> <span class="id" title="var">m1</span> =&gt; (<span class="id" title="var">fst</span> (<span class="id" title="var">m1</span>/2) + <span class="id" title="var">v30</span>)%<span class="id" title="var">int31</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt;  <span class="id" title="var">j</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt312_lower_bound</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>:<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi2</span> <span class="id" title="var">ih</span>  <span class="id" title="var">il</span>  &lt; ([|<span class="id" title="var">j</span>|] + 1) ^ 2 -&gt; [|<span class="id" title="var">ih</span>|] &lt;= [|<span class="id" title="var">j</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">div312_phi</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>: (2^30 &lt;= [|<span class="id" title="var">j</span>|] -&gt; [|<span class="id" title="var">ih</span>|] &lt; [|<span class="id" title="var">j</span>|] -&gt;<br/>
&nbsp;&nbsp;[|<span class="id" title="var">fst</span> (<span class="id" title="var">div3121</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>)|] = <span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span>/[|<span class="id" title="var">j</span>|])%<span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">sqrt312_step_correct</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>:<br/>
&nbsp;&nbsp;2 ^ 29 &lt;= [|<span class="id" title="var">ih</span>|] -&gt; 0 &lt; [|<span class="id" title="var">j</span>|] -&gt; <span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> &lt; ([|<span class="id" title="var">j</span>|] + 1) ^ 2 -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">j1</span>, 0 &lt; [|<span class="id" title="var">j1</span>|] &lt; [|<span class="id" title="var">j</span>|] -&gt;  <span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> &lt; ([|<span class="id" title="var">j1</span>|] + 1) ^ 2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j1</span>|] ^ 2 &lt;= <span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> &lt; ([|<span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j1</span>|] + 1) ^ 2) -&gt;<br/>
&nbsp;&nbsp;[|<span class="id" title="var">sqrt312_step</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span>  <span class="id" title="var">j</span>|] ^ 2 &lt;= <span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; ([|<span class="id" title="var">sqrt312_step</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>|] + 1) ^  2.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">iter312_sqrt_correct</span> <span class="id" title="var">n</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>:<br/>
&nbsp;&nbsp;2^29 &lt;= [|<span class="id" title="var">ih</span>|] -&gt;  0 &lt; [|<span class="id" title="var">j</span>|] -&gt; <span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> &lt; ([|<span class="id" title="var">j</span>|] + 1) ^ 2 -&gt;<br/>
&nbsp;&nbsp;(<span class="id" title="keyword">forall</span> <span class="id" title="var">j1</span>, 0 &lt; [|<span class="id" title="var">j1</span>|] -&gt; 2^(<span class="id" title="var">Z.of_nat</span> <span class="id" title="var">n</span>) + [|<span class="id" title="var">j1</span>|] &lt;= [|<span class="id" title="var">j</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> &lt; ([|<span class="id" title="var">j1</span>|] + 1) ^ 2 -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[|<span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j1</span>|] ^ 2 &lt;= <span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> &lt; ([|<span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j1</span>|] + 1) ^ 2)  -&gt;<br/>
&nbsp;&nbsp;[|<span class="id" title="var">iter312_sqrt</span> <span class="id" title="var">n</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>|] ^ 2 &lt;= <span class="id" title="var">phi2</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt; ([|<span class="id" title="var">iter312_sqrt</span> <span class="id" title="var">n</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">ih</span> <span class="id" title="var">il</span> <span class="id" title="var">j</span>|] + 1) ^ 2.<br/>

<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_sqrt2</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">wB</span>/ 4 &lt;= [|<span class="id" title="var">x</span>|] -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">s</span>,<span class="id" title="var">r</span>) := <span class="id" title="var">sqrt312</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[||<span class="id" title="var">WW</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>||] = [|<span class="id" title="var">s</span>|] ^ 2 + [+|<span class="id" title="var">r</span>|] /\<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[+|<span class="id" title="var">r</span>|] &lt;= 2 * [|<span class="id" title="var">s</span>|].<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><span class="id" title="var">iszero</span></span> 
</div>
<div class="code">

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_eq0</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>, <span class="id" title="var">ZnZ.eq0</span> <span class="id" title="var">x</span> = <span class="id" title="var">true</span> -&gt; [|<span class="id" title="var">x</span>|] = 0.<br/>

<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_is_even</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">ZnZ.is_even</span> <span class="id" title="var">x</span> <span class="id" title="keyword">then</span> [|<span class="id" title="var">x</span>|] <span class="id" title="var">mod</span> 2 = 0 <span class="id" title="keyword">else</span> [|<span class="id" title="var">x</span>|] <span class="id" title="var">mod</span> 2 = 1.<br/>

<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">log2_phi_bounded</span> <span class="id" title="var">x</span> : <span class="id" title="var">Z.log2</span> [|<span class="id" title="var">x</span>|] &lt; <span class="id" title="var">Z.of_nat</span> <span class="id" title="var">size</span>.<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_lor</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : [| <span class="id" title="var">ZnZ.lor</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> |] = <span class="id" title="var">Z.lor</span> [|<span class="id" title="var">x</span>|] [|<span class="id" title="var">y</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_land</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : [| <span class="id" title="var">ZnZ.land</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> |] = <span class="id" title="var">Z.land</span> [|<span class="id" title="var">x</span>|] [|<span class="id" title="var">y</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Lemma</span> <span class="id" title="var">spec_lxor</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> : [| <span class="id" title="var">ZnZ.lxor</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> |] = <span class="id" title="var">Z.lxor</span> [|<span class="id" title="var">x</span>|] [|<span class="id" title="var">y</span>|].<br/>

<br/>
&nbsp;<span class="id" title="keyword">Global Instance</span> <span class="id" title="var">int31_specs</span> : <span class="id" title="var">ZnZ.Specs</span> <span class="id" title="var">int31_ops</span> := {<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_to_Z</span>   := <span class="id" title="var">phi_bounded</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_of_pos</span> := <span class="id" title="var">positive_to_int31_spec</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_zdigits</span> := <span class="id" title="var">spec_zdigits</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_more_than_1_digit</span> := <span class="id" title="var">spec_more_than_1_digit</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_0</span>   := <span class="id" title="var">spec_0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_1</span>   := <span class="id" title="var">spec_1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_m1</span>  := <span class="id" title="var">spec_m1</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_compare</span> := <span class="id" title="var">spec_compare</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_eq0</span> := <span class="id" title="var">spec_eq0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_opp_c</span> := <span class="id" title="var">spec_opp_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_opp</span> := <span class="id" title="var">spec_opp</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_opp_carry</span> := <span class="id" title="var">spec_opp_carry</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_succ_c</span> := <span class="id" title="var">spec_succ_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_add_c</span> := <span class="id" title="var">spec_add_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_add_carry_c</span> := <span class="id" title="var">spec_add_carry_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_succ</span> := <span class="id" title="var">spec_succ</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_add</span> := <span class="id" title="var">spec_add</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_add_carry</span> := <span class="id" title="var">spec_add_carry</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_pred_c</span> := <span class="id" title="var">spec_pred_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_sub_c</span> := <span class="id" title="var">spec_sub_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_sub_carry_c</span> := <span class="id" title="var">spec_sub_carry_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_pred</span> := <span class="id" title="var">spec_pred</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_sub</span> := <span class="id" title="var">spec_sub</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_sub_carry</span> := <span class="id" title="var">spec_sub_carry</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_mul_c</span> := <span class="id" title="var">spec_mul_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_mul</span> := <span class="id" title="var">spec_mul</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_square_c</span> := <span class="id" title="var">spec_square_c</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_div21</span> := <span class="id" title="var">spec_div21</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_div_gt</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">spec_div</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_div</span> := <span class="id" title="var">spec_div</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_modulo_gt</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">spec_mod</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_modulo</span> := <span class="id" title="var">spec_mod</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_gcd_gt</span> := <span class="id" title="keyword">fun</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">spec_gcd</span> <span class="id" title="var">a</span> <span class="id" title="var">b</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_gcd</span> := <span class="id" title="var">spec_gcd</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_head00</span> := <span class="id" title="var">spec_head00</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_head0</span> := <span class="id" title="var">spec_head0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_tail00</span> := <span class="id" title="var">spec_tail00</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_tail0</span> := <span class="id" title="var">spec_tail0</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_add_mul_div</span> := <span class="id" title="var">spec_add_mul_div</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_pos_mod</span> := <span class="id" title="var">spec_pos_mod</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_is_even</span> := <span class="id" title="var">spec_is_even</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_sqrt2</span> := <span class="id" title="var">spec_sqrt2</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_sqrt</span> := <span class="id" title="var">spec_sqrt</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_lor</span> := <span class="id" title="var">spec_lor</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_land</span> := <span class="id" title="var">spec_land</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">spec_lxor</span> := <span class="id" title="var">spec_lxor</span> }.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Int31_Specs</span>.<br/>

<br/>
<span class="id" title="keyword">Module</span> <span class="id" title="var">Int31Cyclic</span> &lt;: <span class="id" title="var">CyclicType</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">t</span> := <span class="id" title="var">int31</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">ops</span> := <span class="id" title="var">int31_ops</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">specs</span> := <span class="id" title="var">int31_specs</span>.<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">Int31Cyclic</span>.<br/>
</div>
    <div id="sidebarWrapper">
      <div id="sidebar">
        <div class="block">
          <h2 class="title">Navigation</h2>
          <div class="content">
            <ul class="menu">
              <li class="leaf">Standard Library
                <ul class="menu">
                  <li><a href="index.html">Table of contents</a></li>
                  <li><a href="genindex.html">Index</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="footer">
    <div id="nav-footer">
      <ul class="links-menu-footer">
        <li><a href="mailto:coq-www_@_inria.fr">webmaster</a></li>
        <li><a href="http://validator.w3.org/">xhtml valid</a></li>
        <li><a href="http://jigsaw.w3.org/css-validator/">CSS valid</a></li>
      </ul>
    </div>
  </div>

</div>

</body>
</html>
