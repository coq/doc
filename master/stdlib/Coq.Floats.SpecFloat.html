<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/node/node.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/defaults.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/system.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/user/user.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/style.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/coqdoc.css" />

<title>Standard Library | The Coq Proof Assistant</title>

</head>

<body>

<div id="container">
  <div id="headertop">
    <div id="nav">
      <ul class="links-menu">
        <li><a href="//coq.inria.fr/" class="active">Home</a></li>
        <li><a href="//coq.inria.fr/about-coq" title="More about coq">About Coq</a></li>
        <li><a href="//coq.inria.fr/download">Get Coq</a></li>
        <li><a href="//coq.inria.fr/documentation">Documentation</a></li>
        <li><a href="//coq.inria.fr/community">Community</a></li>
      </ul>
    </div>
  </div>

  <div id="header">
    <div id="logoWrapper">
      <div id="logo"><a href="//coq.inria.fr/" title="Home"><img src="//coq.inria.fr/files/barron_logo.png" alt="Home" /></a>
      </div>
      <div id="siteName"><a href="//coq.inria.fr/" title="Home">The Coq Proof Assistant</a>
      </div>
    </div>
  </div>

  <div id="content">

<h1 class="libtitle">Library Coq.Floats.SpecFloat</h1>

<div class="code">

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span> <span class="id" title="var">FloatClass</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab39"></a><h1 class="section">Specification of floating-point arithmetic</h1>


<div class="paragraph"> </div>

This specification is mostly borrowed from the <span class="inlinecode"><span class="id" title="var">IEEE754.Binary</span></span> module
of the Flocq library (see <a href="http://flocq.gforge.inria.fr/">http://flocq.gforge.inria.fr/</a>) 
<div class="paragraph"> </div>

<a id="lab40"></a><h2 class="section">Inductive specification of floating-point numbers</h2>


<div class="paragraph"> </div>

Similar to <span class="inlinecode"><span class="id" title="var">Flocq.IEEE754.Binary.full_float</span></span>, but with no NaN payload. 
</div>
<div class="code">
<span class="id" title="keyword">Variant</span> <span class="id" title="var">spec_float</span> :=<br/>
&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> (<span class="id" title="var">s</span> : <span class="id" title="var">bool</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">s</span> : <span class="id" title="var">bool</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> (<span class="id" title="var">s</span> : <span class="id" title="var">bool</span>) (<span class="id" title="var">m</span> : <span class="id" title="var">positive</span>) (<span class="id" title="var">e</span> : <span class="id" title="var">Z</span>).<br/>

<br/>
</div>

<div class="doc">
<a id="lab41"></a><h2 class="section">Parameterized definitions</h2>


<div class="paragraph"> </div>

<span class="inlinecode"><span class="id" title="var">prec</span></span> is the number of bits of the mantissa including the implicit one;
<span class="inlinecode"><span class="id" title="var">emax</span></span> is the exponent of the infinities.

<div class="paragraph"> </div>

For instance, Binary64 is defined by <span class="inlinecode"><span class="id" title="var">prec</span></span> <span class="inlinecode">=</span> <span class="inlinecode">53</span> and <span class="inlinecode"><span class="id" title="var">emax</span></span> <span class="inlinecode">=</span> <span class="inlinecode">1024</span>. 
</div>
<div class="code">
<span class="id" title="keyword">Section</span> <span class="id" title="var">FloatOps</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> <span class="id" title="var">prec</span> <span class="id" title="var">emax</span> : <span class="id" title="var">Z</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">emin</span> := (3-<span class="id" title="var">emax</span>-<span class="id" title="var">prec</span>)%<span class="id" title="var">Z</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">fexp</span> <span class="id" title="var">e</span> := <span class="id" title="var">Z.max</span> (<span class="id" title="var">e</span> - <span class="id" title="var">prec</span>) <span class="id" title="var">emin</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">Zdigits2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">digits2_pos</span> (<span class="id" title="var">n</span> : <span class="id" title="var">positive</span>) : <span class="id" title="var">positive</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xH</span> =&gt; <span class="id" title="var">xH</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xO</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">Pos.succ</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xI</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">Pos.succ</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">Zdigits2</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Z0</span> =&gt; <span class="id" title="var">n</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">Zpos</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">Zpos</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Zdigits2</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">ValidBinary</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">canonical_mantissa</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Zeq_bool</span> (<span class="id" title="var">fexp</span> (<span class="id" title="var">Zpos</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">m</span>) + <span class="id" title="var">e</span>)) <span class="id" title="var">e</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">bounded</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">andb</span> (<span class="id" title="var">canonical_mantissa</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span>) (<span class="id" title="var">Zle_bool</span> <span class="id" title="var">e</span> (<span class="id" title="var">emax</span> - <span class="id" title="var">prec</span>)).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">valid_binary</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">_</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span> =&gt; <span class="id" title="var">bounded</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">ValidBinary</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">Iter</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Context</span> {<span class="id" title="var">A</span> : <span class="id" title="keyword">Type</span>}.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Variable</span> (<span class="id" title="var">f</span> : <span class="id" title="var">A</span> -&gt; <span class="id" title="var">A</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">iter_pos</span> (<span class="id" title="var">n</span> : <span class="id" title="var">positive</span>) (<span class="id" title="var">x</span> : <span class="id" title="var">A</span>) {<span class="id" title="keyword">struct</span> <span class="id" title="var">n</span>} : <span class="id" title="var">A</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xI</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">iter_pos</span> <span class="id" title="var">n'</span> (<span class="id" title="var">iter_pos</span> <span class="id" title="var">n'</span> (<span class="id" title="var">f</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xO</span> <span class="id" title="var">n'</span> =&gt; <span class="id" title="var">iter_pos</span> <span class="id" title="var">n'</span> (<span class="id" title="var">iter_pos</span> <span class="id" title="var">n'</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">xH</span> =&gt; <span class="id" title="var">f</span> <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Iter</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Section</span> <span class="id" title="var">Rounding</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Inductive</span> <span class="id" title="var">location</span> := <span class="id" title="var">loc_Exact</span> | <span class="id" title="var">loc_Inexact</span> : <span class="id" title="var">comparison</span> -&gt; <span class="id" title="var">location</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Record</span> <span class="id" title="var">shr_record</span> := { <span class="id" title="var">shr_m</span> : <span class="id" title="var">Z</span> ; <span class="id" title="var">shr_r</span> : <span class="id" title="var">bool</span> ; <span class="id" title="var">shr_s</span> : <span class="id" title="var">bool</span> }.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">shr_1</span> <span class="id" title="var">mrs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">Build_shr_record</span> <span class="id" title="var">m</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span>) := <span class="id" title="var">mrs</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := <span class="id" title="var">orb</span> <span class="id" title="var">r</span> <span class="id" title="var">s</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">m</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Z0</span> =&gt; <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">Z0</span> <span class="id" title="var">false</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">xH</span> =&gt; <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">Z0</span> <span class="id" title="var">true</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> (<span class="id" title="var">xO</span> <span class="id" title="var">p</span>) =&gt; <span class="id" title="var">Build_shr_record</span> (<span class="id" title="var">Zpos</span> <span class="id" title="var">p</span>) <span class="id" title="var">false</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> (<span class="id" title="var">xI</span> <span class="id" title="var">p</span>) =&gt; <span class="id" title="var">Build_shr_record</span> (<span class="id" title="var">Zpos</span> <span class="id" title="var">p</span>) <span class="id" title="var">true</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> <span class="id" title="var">xH</span> =&gt; <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">Z0</span> <span class="id" title="var">true</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> (<span class="id" title="var">xO</span> <span class="id" title="var">p</span>) =&gt; <span class="id" title="var">Build_shr_record</span> (<span class="id" title="var">Zneg</span> <span class="id" title="var">p</span>) <span class="id" title="var">false</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> (<span class="id" title="var">xI</span> <span class="id" title="var">p</span>) =&gt; <span class="id" title="var">Build_shr_record</span> (<span class="id" title="var">Zneg</span> <span class="id" title="var">p</span>) <span class="id" title="var">true</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">loc_of_shr_record</span> <span class="id" title="var">mrs</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">mrs</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">_</span> <span class="id" title="var">false</span> <span class="id" title="var">false</span> =&gt; <span class="id" title="var">loc_Exact</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">_</span> <span class="id" title="var">false</span> <span class="id" title="var">true</span> =&gt; <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">_</span> <span class="id" title="var">true</span> <span class="id" title="var">false</span> =&gt; <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">_</span> <span class="id" title="var">true</span> <span class="id" title="var">true</span> =&gt; <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">shr_record_of_loc</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">loc_Exact</span> =&gt; <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">m</span> <span class="id" title="var">false</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">m</span> <span class="id" title="var">false</span> <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">m</span> <span class="id" title="var">true</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">Build_shr_record</span> <span class="id" title="var">m</span> <span class="id" title="var">true</span> <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">shr</span> <span class="id" title="var">mrs</span> <span class="id" title="var">e</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">p</span> =&gt; (<span class="id" title="var">iter_pos</span> <span class="id" title="var">shr_1</span> <span class="id" title="var">p</span> <span class="id" title="var">mrs</span>, (<span class="id" title="var">e</span> + <span class="id" title="var">n</span>)%<span class="id" title="var">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; (<span class="id" title="var">mrs</span>, <span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">shr_fexp</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span> <span class="id" title="var">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">shr</span> (<span class="id" title="var">shr_record_of_loc</span> <span class="id" title="var">m</span> <span class="id" title="var">l</span>) <span class="id" title="var">e</span> (<span class="id" title="var">fexp</span> (<span class="id" title="var">Zdigits2</span> <span class="id" title="var">m</span> + <span class="id" title="var">e</span>) - <span class="id" title="var">e</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">round_nearest_even</span> <span class="id" title="var">mx</span> <span class="id" title="var">lx</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lx</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">loc_Exact</span> =&gt; <span class="id" title="var">mx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">mx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Eq</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">Z.even</span> <span class="id" title="var">mx</span> <span class="id" title="keyword">then</span> <span class="id" title="var">mx</span> <span class="id" title="keyword">else</span> (<span class="id" title="var">mx</span> + 1)%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">loc_Inexact</span> <span class="id" title="var">Gt</span> =&gt; (<span class="id" title="var">mx</span> + 1)%<span class="id" title="var">Z</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">binary_round_aux</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> <span class="id" title="var">lx</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">mrs'</span>, <span class="id" title="var">e'</span>) := <span class="id" title="var">shr_fexp</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> <span class="id" title="var">lx</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">mrs''</span>, <span class="id" title="var">e''</span>) := <span class="id" title="var">shr_fexp</span> (<span class="id" title="var">round_nearest_even</span> (<span class="id" title="var">shr_m</span> <span class="id" title="var">mrs'</span>) (<span class="id" title="var">loc_of_shr_record</span> <span class="id" title="var">mrs'</span>)) <span class="id" title="var">e'</span> <span class="id" title="var">loc_Exact</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">shr_m</span> <span class="id" title="var">mrs''</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Z0</span> =&gt; <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">m</span> =&gt; <span class="id" title="keyword">if</span> <span class="id" title="var">Zle_bool</span> <span class="id" title="var">e''</span> (<span class="id" title="var">emax</span> - <span class="id" title="var">prec</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">m</span> <span class="id" title="var">e''</span> <span class="id" title="keyword">else</span> <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">shl_align</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> <span class="id" title="var">ex'</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="var">ex'</span> - <span class="id" title="var">ex</span>)%<span class="id" title="var">Z</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> <span class="id" title="var">d</span> =&gt; (<span class="id" title="var">shift_pos</span> <span class="id" title="var">d</span> <span class="id" title="var">mx</span>, <span class="id" title="var">ex'</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; (<span class="id" title="var">mx</span>, <span class="id" title="var">ex</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">binary_round</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">mz</span>, <span class="id" title="var">ez</span>) := <span class="id" title="var">shl_align</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> (<span class="id" title="var">fexp</span> (<span class="id" title="var">Zpos</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">mx</span>) + <span class="id" title="var">ex</span>))<span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binary_round_aux</span> <span class="id" title="var">sx</span> (<span class="id" title="var">Zpos</span> <span class="id" title="var">mz</span>) <span class="id" title="var">ez</span> <span class="id" title="var">loc_Exact</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">binary_normalize</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span> <span class="id" title="var">szero</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">m</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Z0</span> =&gt; <span class="id" title="var">S754_zero</span> <span class="id" title="var">szero</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">m</span> =&gt; <span class="id" title="var">binary_round</span> <span class="id" title="var">false</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> <span class="id" title="var">m</span> =&gt; <span class="id" title="var">binary_round</span> <span class="id" title="var">true</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>
&nbsp;&nbsp;<span class="id" title="keyword">End</span> <span class="id" title="var">Rounding</span>.<br/>

<br/>
</div>

<div class="doc">
<a id="lab42"></a><h2 class="section">Define operations</h2>

</div>
<div class="code">

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFopp</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span> =&gt; <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">negb</span> <span class="id" title="var">sx</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> =&gt; <span class="id" title="var">S754_finite</span> (<span class="id" title="var">negb</span> <span class="id" title="var">sx</span>) <span class="id" title="var">mx</span> <span class="id" title="var">ex</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span> =&gt; <span class="id" title="var">S754_zero</span> (<span class="id" title="var">negb</span> <span class="id" title="var">sx</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFabs</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span> =&gt; <span class="id" title="var">S754_infinity</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> =&gt; <span class="id" title="var">S754_finite</span> <span class="id" title="var">false</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span> =&gt; <span class="id" title="var">S754_zero</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFcompare</span> <span class="id" title="var">f1</span> <span class="id" title="var">f2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">f1</span>, <span class="id" title="var">f2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span> , <span class="id" title="var">_</span> | <span class="id" title="var">_</span>, <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">None</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">s1</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">s2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Some</span> <span class="id" title="keyword">match</span> <span class="id" title="var">s1</span>, <span class="id" title="var">s2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span>, <span class="id" title="var">true</span> =&gt; <span class="id" title="var">Eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span>, <span class="id" title="var">false</span> =&gt; <span class="id" title="var">Eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span>, <span class="id" title="var">false</span> =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span>, <span class="id" title="var">true</span> =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">s</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Some</span> (<span class="id" title="keyword">if</span> <span class="id" title="var">s</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Lt</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Gt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">s</span> =&gt; <span class="id" title="var">Some</span> (<span class="id" title="keyword">if</span> <span class="id" title="var">s</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Gt</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Lt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">s</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Some</span> (<span class="id" title="keyword">if</span> <span class="id" title="var">s</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Lt</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Gt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">s</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Some</span> (<span class="id" title="keyword">if</span> <span class="id" title="var">s</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Gt</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Lt</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Some</span> <span class="id" title="var">Eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">s1</span> <span class="id" title="var">m1</span> <span class="id" title="var">e1</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">s2</span> <span class="id" title="var">m2</span> <span class="id" title="var">e2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Some</span> <span class="id" title="keyword">match</span> <span class="id" title="var">s1</span>, <span class="id" title="var">s2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span>, <span class="id" title="var">false</span> =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span>, <span class="id" title="var">true</span> =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">false</span>, <span class="id" title="var">false</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Z.compare</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">Pcompare</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">Eq</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">true</span>, <span class="id" title="var">true</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Z.compare</span> <span class="id" title="var">e1</span> <span class="id" title="var">e2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">CompOpp</span> (<span class="id" title="var">Pcompare</span> <span class="id" title="var">m1</span> <span class="id" title="var">m2</span> <span class="id" title="var">Eq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFeqb</span> <span class="id" title="var">f1</span> <span class="id" title="var">f2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">SFcompare</span> <span class="id" title="var">f1</span> <span class="id" title="var">f2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFltb</span> <span class="id" title="var">f1</span> <span class="id" title="var">f2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">SFcompare</span> <span class="id" title="var">f1</span> <span class="id" title="var">f2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFleb</span> <span class="id" title="var">f1</span> <span class="id" title="var">f2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">SFcompare</span> <span class="id" title="var">f1</span> <span class="id" title="var">f2</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Some</span> <span class="id" title="var">Le</span> =&gt; <span class="id" title="var">true</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFclassify</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">f</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">NaN</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">false</span> =&gt; <span class="id" title="var">PInf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">true</span> =&gt; <span class="id" title="var">NInf</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">false</span> =&gt; <span class="id" title="var">NZero</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">true</span> =&gt; <span class="id" title="var">PZero</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">false</span> <span class="id" title="var">m</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">m</span> =? <span class="id" title="var">Z.to_pos</span> <span class="id" title="var">prec</span>)%<span class="id" title="var">positive</span> <span class="id" title="keyword">then</span> <span class="id" title="var">PNormal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">PSubn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">true</span> <span class="id" title="var">m</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">m</span> =? <span class="id" title="var">Z.to_pos</span> <span class="id" title="var">prec</span>)%<span class="id" title="var">positive</span> <span class="id" title="keyword">then</span> <span class="id" title="var">NNormal</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">NSubn</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFmul</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span>, <span class="id" title="var">_</span> | <span class="id" title="var">_</span>, <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_zero</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">S754_zero</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_zero</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">my</span> <span class="id" title="var">ey</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binary_round_aux</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>) (<span class="id" title="var">Zpos</span> (<span class="id" title="var">mx</span> * <span class="id" title="var">my</span>)) (<span class="id" title="var">ex</span> + <span class="id" title="var">ey</span>) <span class="id" title="var">loc_Exact</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">cond_Zopp</span> (<span class="id" title="var">b</span> : <span class="id" title="var">bool</span>) <span class="id" title="var">m</span> := <span class="id" title="keyword">if</span> <span class="id" title="var">b</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Z.opp</span> <span class="id" title="var">m</span> <span class="id" title="keyword">else</span> <span class="id" title="var">m</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFadd</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span>, <span class="id" title="var">_</span> | <span class="id" title="var">_</span>, <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sy</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.eqb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> <span class="id" title="keyword">then</span> <span class="id" title="var">x</span> <span class="id" title="keyword">else</span> <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">sy</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.eqb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span> <span class="id" title="keyword">then</span> <span class="id" title="var">x</span> <span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">S754_zero</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">my</span> <span class="id" title="var">ey</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ez</span> := <span class="id" title="var">Z.min</span> <span class="id" title="var">ex</span> <span class="id" title="var">ey</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binary_normalize</span> (<span class="id" title="var">Zplus</span> (<span class="id" title="var">cond_Zopp</span> <span class="id" title="var">sx</span> (<span class="id" title="var">Zpos</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">shl_align</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> <span class="id" title="var">ez</span>)))) (<span class="id" title="var">cond_Zopp</span> <span class="id" title="var">sy</span> (<span class="id" title="var">Zpos</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">shl_align</span> <span class="id" title="var">my</span> <span class="id" title="var">ey</span> <span class="id" title="var">ez</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ez</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFsub</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span>, <span class="id" title="var">_</span> | <span class="id" title="var">_</span>, <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sy</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.eqb</span> <span class="id" title="var">sx</span> (<span class="id" title="var">negb</span> <span class="id" title="var">sy</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">x</span> <span class="id" title="keyword">else</span> <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">negb</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">sy</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Bool.eqb</span> <span class="id" title="var">sx</span> (<span class="id" title="var">negb</span> <span class="id" title="var">sy</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">x</span> <span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">S754_zero</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">my</span> <span class="id" title="var">ey</span> =&gt; <span class="id" title="var">S754_finite</span> (<span class="id" title="var">negb</span> <span class="id" title="var">sy</span>) <span class="id" title="var">my</span> <span class="id" title="var">ey</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">my</span> <span class="id" title="var">ey</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ez</span> := <span class="id" title="var">Z.min</span> <span class="id" title="var">ex</span> <span class="id" title="var">ey</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binary_normalize</span> (<span class="id" title="var">Zminus</span> (<span class="id" title="var">cond_Zopp</span> <span class="id" title="var">sx</span> (<span class="id" title="var">Zpos</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">shl_align</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> <span class="id" title="var">ez</span>)))) (<span class="id" title="var">cond_Zopp</span> <span class="id" title="var">sy</span> (<span class="id" title="var">Zpos</span> (<span class="id" title="var">fst</span> (<span class="id" title="var">shl_align</span> <span class="id" title="var">my</span> <span class="id" title="var">ey</span> <span class="id" title="var">ez</span>)))))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">ez</span> <span class="id" title="var">false</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">new_location_even</span> <span class="id" title="var">nb_steps</span> <span class="id" title="var">k</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Zeq_bool</span> <span class="id" title="var">k</span> 0 <span class="id" title="keyword">then</span> <span class="id" title="var">loc_Exact</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">loc_Inexact</span> (<span class="id" title="var">Z.compare</span> (2 * <span class="id" title="var">k</span>) <span class="id" title="var">nb_steps</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">new_location_odd</span> <span class="id" title="var">nb_steps</span> <span class="id" title="var">k</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Zeq_bool</span> <span class="id" title="var">k</span> 0 <span class="id" title="keyword">then</span> <span class="id" title="var">loc_Exact</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">loc_Inexact</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">Z.compare</span> (2 * <span class="id" title="var">k</span> + 1) <span class="id" title="var">nb_steps</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Lt</span> =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Eq</span> =&gt; <span class="id" title="var">Lt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Gt</span> =&gt; <span class="id" title="var">Gt</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">new_location</span> <span class="id" title="var">nb_steps</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Z.even</span> <span class="id" title="var">nb_steps</span> <span class="id" title="keyword">then</span> <span class="id" title="var">new_location_even</span> <span class="id" title="var">nb_steps</span> <span class="id" title="keyword">else</span> <span class="id" title="var">new_location_odd</span> <span class="id" title="var">nb_steps</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFdiv_core_binary</span> <span class="id" title="var">m1</span> <span class="id" title="var">e1</span> <span class="id" title="var">m2</span> <span class="id" title="var">e2</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">d1</span> := <span class="id" title="var">Zdigits2</span> <span class="id" title="var">m1</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">d2</span> := <span class="id" title="var">Zdigits2</span> <span class="id" title="var">m2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> := <span class="id" title="var">Z.min</span> (<span class="id" title="var">fexp</span> (<span class="id" title="var">d1</span> + <span class="id" title="var">e1</span> - (<span class="id" title="var">d2</span> + <span class="id" title="var">e2</span>))) (<span class="id" title="var">e1</span> - <span class="id" title="var">e2</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := (<span class="id" title="var">e1</span> - <span class="id" title="var">e2</span> - <span class="id" title="var">e'</span>)%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m'</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Z.shiftl</span> <span class="id" title="var">m1</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Z0</span> =&gt; <span class="id" title="var">m1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Z0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">q</span>, <span class="id" title="var">r</span>) := <span class="id" title="var">Z.div_eucl</span> <span class="id" title="var">m'</span> <span class="id" title="var">m2</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">q</span>, <span class="id" title="var">e'</span>, <span class="id" title="var">new_location</span> <span class="id" title="var">m2</span> <span class="id" title="var">r</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFdiv</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span>, <span class="id" title="var">y</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span>, <span class="id" title="var">_</span> | <span class="id" title="var">_</span>, <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_zero</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_infinity</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_zero</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_infinity</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">S754_zero</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">sx</span>, <span class="id" title="var">S754_zero</span> <span class="id" title="var">sy</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span>, <span class="id" title="var">S754_finite</span> <span class="id" title="var">sy</span> <span class="id" title="var">my</span> <span class="id" title="var">ey</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">mz</span>, <span class="id" title="var">ez</span>, <span class="id" title="var">lz</span>) := <span class="id" title="var">SFdiv_core_binary</span> (<span class="id" title="var">Zpos</span> <span class="id" title="var">mx</span>) <span class="id" title="var">ex</span> (<span class="id" title="var">Zpos</span> <span class="id" title="var">my</span>) <span class="id" title="var">ey</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binary_round_aux</span> (<span class="id" title="var">xorb</span> <span class="id" title="var">sx</span> <span class="id" title="var">sy</span>) <span class="id" title="var">mz</span> <span class="id" title="var">ez</span> <span class="id" title="var">lz</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFsqrt_core_binary</span> <span class="id" title="var">m</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">d</span> := <span class="id" title="var">Zdigits2</span> <span class="id" title="var">m</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">e'</span> := <span class="id" title="var">Z.min</span> (<span class="id" title="var">fexp</span> (<span class="id" title="var">Z.div2</span> (<span class="id" title="var">d</span> + <span class="id" title="var">e</span> + 1))) (<span class="id" title="var">Z.div2</span> <span class="id" title="var">e</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">s</span> := (<span class="id" title="var">e</span> - 2 * <span class="id" title="var">e'</span>)%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">m'</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">s</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">Z.shiftl</span> <span class="id" title="var">m</span> <span class="id" title="var">s</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Z0</span> =&gt; <span class="id" title="var">m</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">Z0</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">q</span>, <span class="id" title="var">r</span>) := <span class="id" title="var">Z.sqrtrem</span> <span class="id" title="var">m'</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Zeq_bool</span> <span class="id" title="var">r</span> 0 <span class="id" title="keyword">then</span> <span class="id" title="var">loc_Exact</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span> <span class="id" title="var">loc_Inexact</span> (<span class="id" title="keyword">if</span> <span class="id" title="var">Zle_bool</span> <span class="id" title="var">r</span> <span class="id" title="var">q</span> <span class="id" title="keyword">then</span> <span class="id" title="var">Lt</span> <span class="id" title="keyword">else</span> <span class="id" title="var">Gt</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">q</span>, <span class="id" title="var">e'</span>, <span class="id" title="var">l</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFsqrt</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">false</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">true</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">true</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">S754_nan</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> '(<span class="id" title="var">mz</span>, <span class="id" title="var">ez</span>, <span class="id" title="var">lz</span>) := <span class="id" title="var">SFsqrt_core_binary</span> (<span class="id" title="var">Zpos</span> <span class="id" title="var">mx</span>) <span class="id" title="var">ex</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">binary_round_aux</span> <span class="id" title="var">false</span> <span class="id" title="var">mz</span> <span class="id" title="var">ez</span> <span class="id" title="var">lz</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFnormfr_mantissa</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">f</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">_</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> <span class="id" title="var">Z.eqb</span> <span class="id" title="var">ex</span> (-<span class="id" title="var">prec</span>) <span class="id" title="keyword">then</span> <span class="id" title="var">Npos</span> <span class="id" title="var">mx</span> <span class="id" title="keyword">else</span> 0%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; 0%<span class="id" title="var">N</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFldexp</span> <span class="id" title="var">f</span> <span class="id" title="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">f</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> =&gt; <span class="id" title="var">binary_round</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> (<span class="id" title="var">ex</span>+<span class="id" title="var">e</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">f</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFfrexp</span> <span class="id" title="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">f</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> <span class="id" title="var">ex</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">Z.to_pos</span> <span class="id" title="var">prec</span> &lt;=? <span class="id" title="var">digits2_pos</span> <span class="id" title="var">mx</span>)%<span class="id" title="var">positive</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> <span class="id" title="var">mx</span> (-<span class="id" title="var">prec</span>), (<span class="id" title="var">ex</span>+<span class="id" title="var">prec</span>)%<span class="id" title="var">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">d</span> := (<span class="id" title="var">prec</span> - <span class="id" title="var">Z.pos</span> (<span class="id" title="var">digits2_pos</span> <span class="id" title="var">mx</span>))%<span class="id" title="var">Z</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">S754_finite</span> <span class="id" title="var">sx</span> (<span class="id" title="var">shift_pos</span> (<span class="id" title="var">Z.to_pos</span> <span class="id" title="var">d</span>) <span class="id" title="var">mx</span>) (-<span class="id" title="var">prec</span>), (<span class="id" title="var">ex</span>+<span class="id" title="var">prec</span>-<span class="id" title="var">d</span>)%<span class="id" title="var">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; (<span class="id" title="var">f</span>, (-2*<span class="id" title="var">emax</span>-<span class="id" title="var">prec</span>)%<span class="id" title="var">Z</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFone</span> := <span class="id" title="var">binary_round</span> <span class="id" title="var">false</span> 1 0.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFulp</span> <span class="id" title="var">x</span> := <span class="id" title="var">SFldexp</span> <span class="id" title="var">SFone</span> (<span class="id" title="var">fexp</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">SFfrexp</span> <span class="id" title="var">x</span>))).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFpred_pos</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">_</span> <span class="id" title="var">mx</span> <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">d</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">if</span> (<span class="id" title="var">mx</span>~0 =? <span class="id" title="var">shift_pos</span> (<span class="id" title="var">Z.to_pos</span> <span class="id" title="var">prec</span>) 1)%<span class="id" title="var">positive</span> <span class="id" title="keyword">then</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SFldexp</span> <span class="id" title="var">SFone</span> (<span class="id" title="var">fexp</span> (<span class="id" title="var">snd</span> (<span class="id" title="var">SFfrexp</span> <span class="id" title="var">x</span>) - 1))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">else</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SFulp</span> <span class="id" title="var">x</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">SFsub</span> <span class="id" title="var">x</span> <span class="id" title="var">d</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFmax_float</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">S754_finite</span> <span class="id" title="var">false</span> (<span class="id" title="var">shift_pos</span> (<span class="id" title="var">Z.to_pos</span> <span class="id" title="var">prec</span>) 1 - 1) (<span class="id" title="var">emax</span> - <span class="id" title="var">prec</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFsucc</span> <span class="id" title="var">x</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_zero</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">SFldexp</span> <span class="id" title="var">SFone</span> <span class="id" title="var">emin</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">false</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_infinity</span> <span class="id" title="var">true</span> =&gt; <span class="id" title="var">SFopp</span> <span class="id" title="var">SFmax_float</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_nan</span> =&gt; <span class="id" title="var">x</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">false</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">SFadd</span> <span class="id" title="var">x</span> (<span class="id" title="var">SFulp</span> <span class="id" title="var">x</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">S754_finite</span> <span class="id" title="var">true</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> =&gt; <span class="id" title="var">SFopp</span> (<span class="id" title="var">SFpred_pos</span> (<span class="id" title="var">SFopp</span> <span class="id" title="var">x</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" title="keyword">Definition</span> <span class="id" title="var">SFpred</span> <span class="id" title="var">f</span> := <span class="id" title="var">SFopp</span> (<span class="id" title="var">SFsucc</span> (<span class="id" title="var">SFopp</span> <span class="id" title="var">f</span>)).<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">FloatOps</span>.<br/>
</div>
    <div id="sidebarWrapper">
      <div id="sidebar">
        <div class="block">
          <h2 class="title">Navigation</h2>
          <div class="content">
            <ul class="menu">
              <li class="leaf">Standard Library
                <ul class="menu">
                  <li><a href="index.html">Table of contents</a></li>
                  <li><a href="genindex.html">Index</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="footer">
    <div id="nav-footer">
      <ul class="links-menu-footer">
        <li><a href="mailto:coq-www_@_inria.fr">webmaster</a></li>
        <li><a href="http://validator.w3.org/">xhtml valid</a></li>
        <li><a href="http://jigsaw.w3.org/css-validator/">CSS valid</a></li>
      </ul>
    </div>
  </div>

</div>

</body>
</html>
