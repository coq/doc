<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/node/node.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/defaults.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/system/system.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/modules/user/user.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/style.css" />
<link type="text/css" rel="stylesheet" media="all" href="//coq.inria.fr/sites/all/themes/coq/coqdoc.css" />

<title>Standard Library | The Coq Proof Assistant</title>

</head>

<body>

<div id="container">
  <div id="headertop">
    <div id="nav">
      <ul class="links-menu">
        <li><a href="//coq.inria.fr/" class="active">Home</a></li>
        <li><a href="//coq.inria.fr/about-coq" title="More about coq">About Coq</a></li>
        <li><a href="//coq.inria.fr/download">Get Coq</a></li>
        <li><a href="//coq.inria.fr/documentation">Documentation</a></li>
        <li><a href="//coq.inria.fr/community">Community</a></li>
      </ul>
    </div>
  </div>

  <div id="header">
    <div id="logoWrapper">
      <div id="logo"><a href="//coq.inria.fr/" title="Home"><img src="//coq.inria.fr/files/barron_logo.png" alt="Home" /></a>
      </div>
      <div id="siteName"><a href="//coq.inria.fr/" title="Home">The Coq Proof Assistant</a>
      </div>
    </div>
  </div>

  <div id="content">

<h1 class="libtitle">Library Coq.nsatz.Nsatz</h1>

<div class="code">

<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">List</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Setoid</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">BinPos</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">BinList</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Znumtheory</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Morphisms</span> <span class="id" title="var">Setoid</span> <span class="id" title="var">Bool</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Algebra_syntax</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Ncring</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Ncring_initial</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Ncring_tac</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Export</span> <span class="id" title="var">Integral_domain</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">DiscrR</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">ZArith</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Lia</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Section</span> <span class="id" title="var">nsatz1</span>.<br/>

<br/>
<span class="id" title="keyword">Context</span> {<span class="id" title="var">R</span>:<span class="id" title="keyword">Type</span>}`{<span class="id" title="var">Rid</span>:<span class="id" title="var">Integral_domain</span> <span class="id" title="var">R</span>}.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">psos_r1b</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">R</span>, <span class="id" title="var">x</span> - <span class="id" title="var">y</span> == 0 -&gt; <span class="id" title="var">x</span> == <span class="id" title="var">y</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">psos_r1</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>, <span class="id" title="var">x</span> == <span class="id" title="var">y</span> -&gt; <span class="id" title="var">x</span> - <span class="id" title="var">y</span> == 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">nsatzR_diff</span>: <span class="id" title="keyword">forall</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>:<span class="id" title="var">R</span>, <span class="id" title="var">not</span> (<span class="id" title="var">x</span> == <span class="id" title="var">y</span>) -&gt; <span class="id" title="var">not</span> (<span class="id" title="var">x</span> - <span class="id" title="var">y</span> == 0).<br/>

<br/>
<span class="id" title="keyword">Export</span> <span class="id" title="var">Ring_polynom</span>.<br/>
<span class="id" title="keyword">Export</span> <span class="id" title="var">InitialRing</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PolZ</span> := <span class="id" title="var">Pol</span> <span class="id" title="var">Z</span>.<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PEZ</span> := <span class="id" title="var">PExpr</span> <span class="id" title="var">Z</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">P0Z</span> : <span class="id" title="var">PolZ</span> := <span class="id" title="var">P0</span> (<span class="id" title="var">C</span>:=<span class="id" title="var">Z</span>) 0%<span class="id" title="var">Z</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PolZadd</span> : <span class="id" title="var">PolZ</span> -&gt; <span class="id" title="var">PolZ</span> -&gt; <span class="id" title="var">PolZ</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">Padd</span>  <span class="id" title="var">Z</span> 0%<span class="id" title="var">Z</span> <span class="id" title="var">Z.add</span> <span class="id" title="var">Zeq_bool</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PolZmul</span> : <span class="id" title="var">PolZ</span> -&gt; <span class="id" title="var">PolZ</span> -&gt; <span class="id" title="var">PolZ</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">Pmul</span>  <span class="id" title="var">Z</span> 0%<span class="id" title="var">Z</span> 1%<span class="id" title="var">Z</span> <span class="id" title="var">Z.add</span> <span class="id" title="var">Z.mul</span> <span class="id" title="var">Zeq_bool</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PolZeq</span> := @<span class="id" title="var">Peq</span> <span class="id" title="var">Z</span> <span class="id" title="var">Zeq_bool</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">norm</span> :=<br/>
&nbsp;&nbsp;@<span class="id" title="var">norm_aux</span> <span class="id" title="var">Z</span> 0%<span class="id" title="var">Z</span> 1%<span class="id" title="var">Z</span> <span class="id" title="var">Z.add</span> <span class="id" title="var">Z.mul</span> <span class="id" title="var">Z.sub</span> <span class="id" title="var">Z.opp</span> <span class="id" title="var">Zeq_bool</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">mult_l</span> (<span class="id" title="var">la</span> : <span class="id" title="var">list</span> <span class="id" title="var">PEZ</span>) (<span class="id" title="var">lp</span>: <span class="id" title="var">list</span> <span class="id" title="var">PolZ</span>) : <span class="id" title="var">PolZ</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">la</span>, <span class="id" title="var">lp</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">la</span>, <span class="id" title="var">p</span>::<span class="id" title="var">lp</span> =&gt; <span class="id" title="var">PolZadd</span> (<span class="id" title="var">PolZmul</span> (<span class="id" title="var">norm</span> <span class="id" title="var">a</span>) <span class="id" title="var">p</span>) (<span class="id" title="var">mult_l</span> <span class="id" title="var">la</span> <span class="id" title="var">lp</span>)<br/>
&nbsp;| <span class="id" title="var">_</span>, <span class="id" title="var">_</span> =&gt; <span class="id" title="var">P0Z</span><br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">compute_list</span> (<span class="id" title="var">lla</span>: <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">PEZ</span>)) (<span class="id" title="var">lp</span>:<span class="id" title="var">list</span> <span class="id" title="var">PolZ</span>) :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lla</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| <span class="id" title="var">List.nil</span> =&gt; <span class="id" title="var">lp</span><br/>
&nbsp;| <span class="id" title="var">la</span>::<span class="id" title="var">lla</span> =&gt; <span class="id" title="var">compute_list</span> <span class="id" title="var">lla</span> ((<span class="id" title="var">mult_l</span> <span class="id" title="var">la</span> <span class="id" title="var">lp</span>)::<span class="id" title="var">lp</span>)<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">check</span> (<span class="id" title="var">lpe</span>:<span class="id" title="var">list</span> <span class="id" title="var">PEZ</span>) (<span class="id" title="var">qe</span>:<span class="id" title="var">PEZ</span>) (<span class="id" title="var">certif</span>: <span class="id" title="var">list</span> (<span class="id" title="var">list</span> <span class="id" title="var">PEZ</span>) * <span class="id" title="var">list</span> <span class="id" title="var">PEZ</span>) :=<br/>
&nbsp;<span class="id" title="keyword">let</span> (<span class="id" title="var">lla</span>, <span class="id" title="var">lq</span>) := <span class="id" title="var">certif</span> <span class="id" title="tactic">in</span><br/>
&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">lp</span> := <span class="id" title="var">List.map</span> <span class="id" title="var">norm</span> <span class="id" title="var">lpe</span> <span class="id" title="tactic">in</span><br/>
&nbsp;<span class="id" title="var">PolZeq</span> (<span class="id" title="var">norm</span> <span class="id" title="var">qe</span>) (<span class="id" title="var">mult_l</span> <span class="id" title="var">lq</span> (<span class="id" title="var">compute_list</span> <span class="id" title="var">lla</span> <span class="id" title="var">lp</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PhiR</span> : <span class="id" title="var">list</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">PolZ</span> -&gt; <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;(<span class="id" title="var">Pphi</span> <span class="id" title="var">ring0</span> <span class="id" title="var">add</span> <span class="id" title="var">mul</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">InitialRing.gen_phiZ</span> <span class="id" title="var">ring0</span> <span class="id" title="var">ring1</span> <span class="id" title="var">add</span> <span class="id" title="var">mul</span> <span class="id" title="var">opp</span>)).<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">PEevalR</span> : <span class="id" title="var">list</span> <span class="id" title="var">R</span> -&gt; <span class="id" title="var">PEZ</span> -&gt; <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="var">PEeval</span> <span class="id" title="var">ring0</span> <span class="id" title="var">ring1</span> <span class="id" title="var">add</span> <span class="id" title="var">mul</span> <span class="id" title="var">sub</span> <span class="id" title="var">opp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">gen_phiZ</span> <span class="id" title="var">ring0</span> <span class="id" title="var">ring1</span> <span class="id" title="var">add</span> <span class="id" title="var">mul</span> <span class="id" title="var">opp</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">N.to_nat</span> <span class="id" title="var">pow</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">P0Z_correct</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span>, <span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> <span class="id" title="var">P0Z</span> = 0.<br/>
 
<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rext</span>: <span class="id" title="var">ring_eq_ext</span> <span class="id" title="var">add</span> <span class="id" title="var">mul</span> <span class="id" title="var">opp</span> <span class="id" title="var">_</span>==<span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rset</span> : <span class="id" title="var">Setoid_Theory</span> <span class="id" title="var">R</span> <span class="id" title="var">_</span>==<span class="id" title="var">_</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">Rtheory</span>:<span class="id" title="var">ring_theory</span> <span class="id" title="var">ring0</span> <span class="id" title="var">ring1</span> <span class="id" title="var">add</span> <span class="id" title="var">mul</span> <span class="id" title="var">sub</span> <span class="id" title="var">opp</span> <span class="id" title="var">_</span>==<span class="id" title="var">_</span>.<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">PolZadd_correct</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">P'</span> <span class="id" title="var">P</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> (<span class="id" title="var">PolZadd</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span>) == ((<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> <span class="id" title="var">P</span>) + (<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> <span class="id" title="var">P'</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">PolZmul_correct</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> (<span class="id" title="var">PolZmul</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span>) == ((<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> <span class="id" title="var">P</span>) * (<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> <span class="id" title="var">P'</span>)).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">R_power_theory</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;: <span class="id" title="var">Ring_theory.power_theory</span> <span class="id" title="var">ring1</span> <span class="id" title="var">mul</span> <span class="id" title="var">_</span>==<span class="id" title="var">_</span> <span class="id" title="var">N.to_nat</span> <span class="id" title="var">pow</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">norm_correct</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> (<span class="id" title="var">l</span> : <span class="id" title="var">list</span> <span class="id" title="var">R</span>) (<span class="id" title="var">pe</span> : <span class="id" title="var">PEZ</span>), <span class="id" title="var">PEevalR</span> <span class="id" title="var">l</span> <span class="id" title="var">pe</span> == <span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> (<span class="id" title="var">norm</span> <span class="id" title="var">pe</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">PolZeq_correct</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> <span class="id" title="var">l</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">PolZeq</span> <span class="id" title="var">P</span> <span class="id" title="var">P'</span> = <span class="id" title="var">true</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> <span class="id" title="var">P</span> == <span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> <span class="id" title="var">P'</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">Cond0</span> (<span class="id" title="var">A</span>:<span class="id" title="keyword">Type</span>) (<span class="id" title="var">Interp</span>:<span class="id" title="var">A</span>-&gt;<span class="id" title="var">R</span>) (<span class="id" title="var">l</span>:<span class="id" title="var">list</span> <span class="id" title="var">A</span>) : <span class="id" title="keyword">Prop</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">List.nil</span> =&gt; <span class="id" title="var">True</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">a</span>::<span class="id" title="var">l</span> =&gt; <span class="id" title="var">Interp</span> <span class="id" title="var">a</span> == 0 /\ <span class="id" title="var">Cond0</span> <span class="id" title="var">A</span> <span class="id" title="var">Interp</span> <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">mult_l_correct</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">la</span> <span class="id" title="var">lp</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Cond0</span> <span class="id" title="var">PolZ</span> (<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span>) <span class="id" title="var">lp</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span> (<span class="id" title="var">mult_l</span> <span class="id" title="var">la</span> <span class="id" title="var">lp</span>) == 0.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">compute_list_correct</span> : <span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">lla</span> <span class="id" title="var">lp</span>,<br/>
&nbsp;&nbsp;<span class="id" title="var">Cond0</span> <span class="id" title="var">PolZ</span> (<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span>) <span class="id" title="var">lp</span> -&gt;<br/>
&nbsp;&nbsp;<span class="id" title="var">Cond0</span> <span class="id" title="var">PolZ</span> (<span class="id" title="var">PhiR</span> <span class="id" title="var">l</span>) (<span class="id" title="var">compute_list</span> <span class="id" title="var">lla</span> <span class="id" title="var">lp</span>).<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">check_correct</span> :<br/>
&nbsp;&nbsp;<span class="id" title="keyword">forall</span> <span class="id" title="var">l</span> <span class="id" title="var">lpe</span> <span class="id" title="var">qe</span> <span class="id" title="var">certif</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">check</span> <span class="id" title="var">lpe</span> <span class="id" title="var">qe</span> <span class="id" title="var">certif</span> = <span class="id" title="var">true</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">Cond0</span> <span class="id" title="var">PEZ</span> (<span class="id" title="var">PEevalR</span> <span class="id" title="var">l</span>) <span class="id" title="var">lpe</span> -&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">PEevalR</span> <span class="id" title="var">l</span> <span class="id" title="var">qe</span> == 0.<br/>

<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">R2</span>:= 1 + 1.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">IPR</span> <span class="id" title="var">p</span> {<span class="id" title="keyword">struct</span> <span class="id" title="var">p</span>}: <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">p</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">xH</span> =&gt; <span class="id" title="var">ring1</span><br/>
&nbsp;&nbsp;| <span class="id" title="var">xO</span> <span class="id" title="var">xH</span> =&gt; 1+1<br/>
&nbsp;&nbsp;| <span class="id" title="var">xO</span> <span class="id" title="var">p1</span> =&gt; <span class="id" title="var">R2</span>*(<span class="id" title="var">IPR</span> <span class="id" title="var">p1</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">xI</span> <span class="id" title="var">xH</span> =&gt; 1+(1+1)<br/>
&nbsp;&nbsp;| <span class="id" title="var">xI</span> <span class="id" title="var">p1</span> =&gt; 1+(<span class="id" title="var">R2</span>*(<span class="id" title="var">IPR</span> <span class="id" title="var">p1</span>))<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Definition</span> <span class="id" title="var">IZR1</span> <span class="id" title="var">z</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">z</span> <span class="id" title="keyword">with</span> <span class="id" title="var">Z0</span> =&gt; 0<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zpos</span> <span class="id" title="var">p</span> =&gt; <span class="id" title="var">IPR</span> <span class="id" title="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">Zneg</span> <span class="id" title="var">p</span> =&gt; -(<span class="id" title="var">IPR</span> <span class="id" title="var">p</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Fixpoint</span> <span class="id" title="var">interpret3</span> <span class="id" title="var">t</span> <span class="id" title="var">fv</span> {<span class="id" title="keyword">struct</span> <span class="id" title="var">t</span>}: <span class="id" title="var">R</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">t</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| (<span class="id" title="var">PEadd</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v1</span>  := <span class="id" title="var">interpret3</span> <span class="id" title="var">t1</span> <span class="id" title="var">fv</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v2</span>  := <span class="id" title="var">interpret3</span> <span class="id" title="var">t2</span> <span class="id" title="var">fv</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">v1</span> + <span class="id" title="var">v2</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">PEmul</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v1</span>  := <span class="id" title="var">interpret3</span> <span class="id" title="var">t1</span> <span class="id" title="var">fv</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v2</span>  := <span class="id" title="var">interpret3</span> <span class="id" title="var">t2</span> <span class="id" title="var">fv</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">v1</span> * <span class="id" title="var">v2</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">PEsub</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v1</span>  := <span class="id" title="var">interpret3</span> <span class="id" title="var">t1</span> <span class="id" title="var">fv</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v2</span>  := <span class="id" title="var">interpret3</span> <span class="id" title="var">t2</span> <span class="id" title="var">fv</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">v1</span> - <span class="id" title="var">v2</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">PEopp</span> <span class="id" title="var">t1</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v1</span>  := <span class="id" title="var">interpret3</span> <span class="id" title="var">t1</span> <span class="id" title="var">fv</span> <span class="id" title="tactic">in</span> (-<span class="id" title="var">v1</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">PEpow</span> <span class="id" title="var">t1</span> <span class="id" title="var">t2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">v1</span>  := <span class="id" title="var">interpret3</span> <span class="id" title="var">t1</span> <span class="id" title="var">fv</span> <span class="id" title="tactic">in</span> <span class="id" title="var">pow</span> <span class="id" title="var">v1</span> (<span class="id" title="var">N.to_nat</span> <span class="id" title="var">t2</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">PEc</span> <span class="id" title="var">t1</span>) =&gt; (<span class="id" title="var">IZR1</span> <span class="id" title="var">t1</span>)<br/>
&nbsp;&nbsp;| <span class="id" title="var">PEO</span> =&gt; 0<br/>
&nbsp;&nbsp;| <span class="id" title="var">PEI</span> =&gt; 1<br/>
&nbsp;&nbsp;| (<span class="id" title="var">PEX</span> <span class="id" title="var">_</span> <span class="id" title="var">n</span>) =&gt; <span class="id" title="var">List.nth</span> (<span class="id" title="var">pred</span> (<span class="id" title="var">Pos.to_nat</span> <span class="id" title="var">n</span>)) <span class="id" title="var">fv</span> 0<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">End</span> <span class="id" title="var">nsatz1</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">equality_to_goal</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span>:=<br/>
&nbsp;&nbsp; <span class="id" title="tactic">try</span> (<span class="id" title="tactic">generalize</span> (@<span class="id" title="var">psos_r1</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span> <span class="id" title="var">H</span>); <span class="id" title="tactic">clear</span> <span class="id" title="var">H</span>)<br/>
.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">equalities_to_goal</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;|  <span class="id" title="var">H</span>: (<span class="id" title="var">_</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">y</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="var">equality_to_goal</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;|  <span class="id" title="var">H</span>: (<span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">y</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="var">equality_to_goal</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;|  <span class="id" title="var">H</span>: (<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">y</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="var">equality_to_goal</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;|  <span class="id" title="var">H</span>: (<span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">y</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="var">equality_to_goal</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span><br/>
<br/>
&nbsp;&nbsp;|  <span class="id" title="var">H</span>: (?<span class="id" title="var">x</span> == ?<span class="id" title="var">y</span>) |- <span class="id" title="var">_</span> =&gt; <span class="id" title="var">equality_to_goal</span> <span class="id" title="var">H</span> <span class="id" title="var">x</span> <span class="id" title="var">y</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">parametres_en_tete</span> <span class="id" title="var">fv</span> <span class="id" title="var">lp</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">fv</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (@<span class="id" title="var">nil</span> <span class="id" title="var">_</span>)          =&gt; <span class="id" title="var">lp</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (@<span class="id" title="var">cons</span> <span class="id" title="var">_</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">fv1</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">res</span> := <span class="id" title="var">AddFvTail</span> <span class="id" title="var">x</span> <span class="id" title="var">lp</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">parametres_en_tete</span> <span class="id" title="var">fv1</span> <span class="id" title="var">res</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">append1</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> :=<br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;| (@<span class="id" title="var">nil</span> <span class="id" title="var">_</span>)     =&gt; <span class="id" title="keyword">constr</span>:(<span class="id" title="var">cons</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span>)<br/>
&nbsp;| (<span class="id" title="var">cons</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">l</span>) =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">l'</span> := <span class="id" title="var">append1</span> <span class="id" title="var">a</span> <span class="id" title="var">l</span> <span class="id" title="tactic">in</span> <span class="id" title="keyword">constr</span>:(<span class="id" title="var">cons</span> <span class="id" title="var">x</span> <span class="id" title="var">l'</span>)<br/>
&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">rev</span> <span class="id" title="var">l</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">l</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;|(@<span class="id" title="var">nil</span> <span class="id" title="var">_</span>)      =&gt; <span class="id" title="var">l</span><br/>
&nbsp;&nbsp;&nbsp;| (<span class="id" title="var">cons</span> ?<span class="id" title="var">x</span> ?<span class="id" title="var">l</span>) =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">l'</span> := <span class="id" title="var">rev</span> <span class="id" title="var">l</span> <span class="id" title="tactic">in</span> <span class="id" title="var">append1</span> <span class="id" title="var">x</span> <span class="id" title="var">l'</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">nsatz_call_n</span> <span class="id" title="tactic">info</span> <span class="id" title="var">nparam</span> <span class="id" title="var">p</span> <span class="id" title="var">rr</span> <span class="id" title="var">lp</span> <span class="id" title="var">kont</span> := <br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">ll</span> := <span class="id" title="keyword">constr</span>:(<span class="id" title="var">PEc</span> <span class="id" title="tactic">info</span> :: <span class="id" title="var">PEc</span> <span class="id" title="var">nparam</span> :: <span class="id" title="var">PEpow</span> <span class="id" title="var">p</span> <span class="id" title="var">rr</span> :: <span class="id" title="var">lp</span>) <span class="id" title="tactic">in</span><br/>
<br/>
&nbsp;&nbsp;<span class="id" title="var">nsatz_compute</span> <span class="id" title="var">ll</span>; <br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;| |- (?<span class="id" title="var">c</span>::<span class="id" title="var">PEpow</span> <span class="id" title="var">_</span> ?<span class="id" title="var">r</span>::?<span class="id" title="var">lq0</span>)::?<span class="id" title="var">lci0</span> = <span class="id" title="var">_</span> -&gt; <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span> <span class="id" title="var">_</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">lci</span> := <span class="id" title="tactic">fresh</span> "lci" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lci</span>:=<span class="id" title="var">lci0</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">lq</span> := <span class="id" title="tactic">fresh</span> "lq" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lq</span>:=<span class="id" title="var">lq0</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">kont</span> <span class="id" title="var">c</span> <span class="id" title="var">rr</span> <span class="id" title="var">lq</span> <span class="id" title="var">lci</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">nsatz_call</span> <span class="id" title="var">radicalmax</span> <span class="id" title="tactic">info</span> <span class="id" title="var">nparam</span> <span class="id" title="var">p</span> <span class="id" title="var">lp</span> <span class="id" title="var">kont</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="keyword">rec</span> <span class="id" title="var">try_n</span> <span class="id" title="var">n</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">lazymatch</span> <span class="id" title="var">n</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| 0%<span class="id" title="var">N</span> =&gt; <span class="id" title="tactic">fail</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="keyword">let</span> <span class="id" title="var">r</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">N.sub</span> <span class="id" title="var">radicalmax</span> (<span class="id" title="var">N.pred</span> <span class="id" title="var">n</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nsatz_call_n</span> <span class="id" title="tactic">info</span> <span class="id" title="var">nparam</span> <span class="id" title="var">p</span> <span class="id" title="var">r</span> <span class="id" title="var">lp</span> <span class="id" title="var">kont</span>) ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">n'</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">N.pred</span> <span class="id" title="var">n</span>) <span class="id" title="tactic">in</span> <span class="id" title="var">try_n</span> <span class="id" title="var">n'</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;<span class="id" title="var">try_n</span> <span class="id" title="var">radicalmax</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">lterm_goal</span> <span class="id" title="var">g</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">g</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">b1</span> == ?<span class="id" title="var">b2</span> =&gt; <span class="id" title="keyword">constr</span>:(<span class="id" title="var">b1</span>::<span class="id" title="var">b2</span>::<span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;| ?<span class="id" title="var">b1</span> == ?<span class="id" title="var">b2</span> -&gt; ?<span class="id" title="var">g</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="var">lterm_goal</span> <span class="id" title="var">g</span> <span class="id" title="tactic">in</span> <span class="id" title="keyword">constr</span>:(<span class="id" title="var">b1</span>::<span class="id" title="var">b2</span>::<span class="id" title="var">l</span>)     <br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">reify_goal</span> <span class="id" title="var">l</span> <span class="id" title="var">le</span> <span class="id" title="var">lb</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">le</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nil</span> =&gt; <span class="id" title="tactic">idtac</span><br/>
&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">e</span>::?<span class="id" title="var">le1</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lb</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;?<span class="id" title="var">b</span>::?<span class="id" title="var">lb1</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">x</span> := <span class="id" title="tactic">fresh</span> "B" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">x</span>:= <span class="id" title="var">b</span>) <span class="id" title="tactic">at</span> 1;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">change</span> <span class="id" title="var">x</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">interpret3</span> <span class="id" title="var">e</span> <span class="id" title="var">l</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">clear</span> <span class="id" title="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reify_goal</span> <span class="id" title="var">l</span> <span class="id" title="var">le1</span> <span class="id" title="var">lb1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">get_lpol</span> <span class="id" title="var">g</span> :=<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">g</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;(<span class="id" title="var">interpret3</span> ?<span class="id" title="var">p</span> <span class="id" title="var">_</span>) == <span class="id" title="var">_</span> =&gt; <span class="id" title="keyword">constr</span>:(<span class="id" title="var">p</span>::<span class="id" title="var">nil</span>)<br/>
&nbsp;&nbsp;| (<span class="id" title="var">interpret3</span> ?<span class="id" title="var">p</span> <span class="id" title="var">_</span>) == <span class="id" title="var">_</span> -&gt; ?<span class="id" title="var">g</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">l</span> := <span class="id" title="var">get_lpol</span> <span class="id" title="var">g</span> <span class="id" title="tactic">in</span> <span class="id" title="keyword">constr</span>:(<span class="id" title="var">p</span>::<span class="id" title="var">l</span>)     <br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">nsatz_generic</span> <span class="id" title="var">radicalmax</span> <span class="id" title="tactic">info</span> <span class="id" title="var">lparam</span> <span class="id" title="var">lvar</span> :=<br/>
&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">nparam</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">Z.of_nat</span> (<span class="id" title="var">List.length</span> <span class="id" title="var">lparam</span>)) <span class="id" title="tactic">in</span><br/>
&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;|- ?<span class="id" title="var">g</span> =&gt; <span class="id" title="keyword">let</span> <span class="id" title="var">lb</span> := <span class="id" title="var">lterm_goal</span> <span class="id" title="var">g</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> (<span class="id" title="keyword">match</span> <span class="id" title="var">lvar</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|(@<span class="id" title="var">nil</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lparam</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|(@<span class="id" title="var">nil</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">r</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">list_reifyl</span> (<span class="id" title="var">lterm</span>:=<span class="id" title="var">lb</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="tactic">eval</span> <span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">list_reifyl</span> (<span class="id" title="var">lterm</span>:=<span class="id" title="var">lb</span>)) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|(?<span class="id" title="var">fv</span>, ?<span class="id" title="var">le</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">fv</span> := <span class="id" title="var">parametres_en_tete</span> <span class="id" title="var">fv</span> <span class="id" title="var">lparam</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">r</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" title="var">list_reifyl</span> (<span class="id" title="var">lterm</span>:=<span class="id" title="var">lb</span>) (<span class="id" title="var">lvar</span>:=<span class="id" title="var">fv</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|<span class="id" title="var">_</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">fv</span> := <span class="id" title="var">parametres_en_tete</span> <span class="id" title="var">lvar</span> <span class="id" title="var">lparam</span> <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">r</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">red</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">list_reifyl</span> (<span class="id" title="var">lterm</span>:=<span class="id" title="var">lb</span>) (<span class="id" title="var">lvar</span>:=<span class="id" title="var">fv</span>)) <span class="id" title="tactic">in</span> <span class="id" title="var">r</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span>) <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|(?<span class="id" title="var">fv</span>, ?<span class="id" title="var">le</span>) =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">reify_goal</span> <span class="id" title="var">fv</span> <span class="id" title="var">le</span> <span class="id" title="var">lb</span> ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|- ?<span class="id" title="var">g</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">lp</span> := <span class="id" title="var">get_lpol</span> <span class="id" title="var">g</span> <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">lpol</span> := <span class="id" title="tactic">eval</span> <span class="id" title="tactic">compute</span> <span class="id" title="tactic">in</span> (<span class="id" title="var">List.rev</span> <span class="id" title="var">lp</span>) <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
<br/>
&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">SplitPolyList</span> <span class="id" title="var">kont</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">lpol</span> <span class="id" title="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" title="var">p2</span>::?<span class="id" title="var">lp2</span> =&gt; <span class="id" title="var">kont</span> <span class="id" title="var">p2</span> <span class="id" title="var">lp2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="var">_</span> =&gt; <span class="id" title="tactic">idtac</span> "polynomial not in the ideal"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">end</span> <span class="id" title="tactic">in</span> <br/>
<br/>
&nbsp;&nbsp;<span class="id" title="var">SplitPolyList</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">p</span> <span class="id" title="var">lp</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">p21</span> := <span class="id" title="tactic">fresh</span> "p21" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">lp21</span> := <span class="id" title="tactic">fresh</span> "lp21" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">p21</span>:=<span class="id" title="var">p</span>) ;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">lp21</span>:=<span class="id" title="var">lp</span>);<br/>
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nsatz_call</span> <span class="id" title="var">radicalmax</span> <span class="id" title="tactic">info</span> <span class="id" title="var">nparam</span> <span class="id" title="var">p</span> <span class="id" title="var">lp</span> <span class="id" title="keyword">ltac</span>:(<span class="id" title="keyword">fun</span> <span class="id" title="var">c</span> <span class="id" title="var">r</span> <span class="id" title="var">lq</span> <span class="id" title="var">lci</span> =&gt; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">q</span> := <span class="id" title="tactic">fresh</span> "q" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">set</span> (<span class="id" title="var">q</span> := <span class="id" title="var">PEmul</span> <span class="id" title="var">c</span> (<span class="id" title="var">PEpow</span> <span class="id" title="var">p21</span> <span class="id" title="var">r</span>)); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">Hg</span> := <span class="id" title="tactic">fresh</span> "Hg" <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hg</span>:<span class="id" title="var">check</span> <span class="id" title="var">lp21</span> <span class="id" title="var">q</span> (<span class="id" title="var">lci</span>,<span class="id" title="var">lq</span>) = <span class="id" title="var">true</span>); <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ (<span class="id" title="keyword">vm_compute</span>;<span class="id" title="tactic">reflexivity</span>) || <span class="id" title="tactic">idtac</span> "invalid nsatz certificate"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" title="keyword">let</span> <span class="id" title="var">Hg2</span> := <span class="id" title="tactic">fresh</span> "Hg" <span class="id" title="tactic">in</span> <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">assert</span> (<span class="id" title="var">Hg2</span>: (<span class="id" title="var">interpret3</span> <span class="id" title="var">q</span> <span class="id" title="var">fv</span>) == 0);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[  <span class="id" title="tactic">idtac</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">generalize</span> (@<span class="id" title="var">check_correct</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">fv</span> <span class="id" title="var">lp21</span> <span class="id" title="var">q</span> (<span class="id" title="var">lci</span>,<span class="id" title="var">lq</span>) <span class="id" title="var">Hg</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="keyword">let</span> <span class="id" title="var">cc</span> := <span class="id" title="tactic">fresh</span> "H" <span class="id" title="tactic">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="tactic">idtac</span>; <span class="id" title="tactic">intro</span> <span class="id" title="var">cc</span>; <span class="id" title="tactic">apply</span> <span class="id" title="var">cc</span>; <span class="id" title="tactic">clear</span> <span class="id" title="var">cc</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="tactic">idtac</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> (<span class="id" title="tactic">split</span>;[<span class="id" title="tactic">assumption</span>|<span class="id" title="tactic">idtac</span>]); <span class="id" title="tactic">exact</span> <span class="id" title="var">I</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|   <span class="id" title="tactic">idtac</span>; <br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">apply</span> <span class="id" title="var">Rintegral_domain_pow</span> <span class="id" title="keyword">with</span> (<span class="id" title="var">interpret3</span> <span class="id" title="var">c</span> <span class="id" title="var">fv</span>) (<span class="id" title="var">N.to_nat</span> <span class="id" title="var">r</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="id" title="tactic">idtac</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">integral_domain_one_zero</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> <span class="id" title="var">integral_domain_minus_one_zero</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">trivial</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">integral_domain_one_zero</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">exact</span> <span class="id" title="var">integral_domain_minus_one_zero</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| (<span class="id" title="tactic">solve</span> [<span class="id" title="tactic">simpl</span>; <span class="id" title="tactic">unfold</span> <span class="id" title="var">R2</span>, <span class="id" title="var">equality</span>, <span class="id" title="var">eq_notation</span>, <span class="id" title="var">addition</span>, <span class="id" title="var">add_notation</span>,<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">one</span>, <span class="id" title="var">one_notation</span>, <span class="id" title="var">multiplication</span>, <span class="id" title="var">mul_notation</span>, <span class="id" title="var">zero</span>, <span class="id" title="var">zero_notation</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">discrR</span> || <span class="id" title="var">lia</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| ( <span class="id" title="tactic">idtac</span>) || <span class="id" title="tactic">idtac</span> "could not prove discrimination result"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;]<br/>
) <br/>
)<br/>
<span class="id" title="keyword">end</span> <span class="id" title="keyword">end</span> <span class="id" title="keyword">end</span> .<br/>

<br/>
<span class="id" title="keyword">Ltac</span> <span class="id" title="var">nsatz_default</span>:=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> (@<span class="id" title="var">psos_r1b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- (@<span class="id" title="var">equality</span> ?<span class="id" title="var">r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">equalities_to_goal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nsatz_generic</span> 6%<span class="id" title="var">N</span> 1%<span class="id" title="var">Z</span> (@<span class="id" title="var">nil</span> <span class="id" title="var">r</span>) (@<span class="id" title="var">nil</span> <span class="id" title="var">r</span>)<br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "nsatz" := <span class="id" title="var">nsatz_default</span>.<br/>

<br/>
<span class="id" title="keyword">Tactic Notation</span> "nsatz" "with"<br/>
&nbsp;"radicalmax" ":=" <span class="id" title="keyword">constr</span>(<span class="id" title="var">radicalmax</span>) <br/>
&nbsp;"strategy" ":=" <span class="id" title="keyword">constr</span>(<span class="id" title="tactic">info</span>) <br/>
&nbsp;"parameters" ":=" <span class="id" title="keyword">constr</span>(<span class="id" title="var">lparam</span>)<br/>
&nbsp;"variables" ":=" <span class="id" title="keyword">constr</span>(<span class="id" title="var">lvar</span>):=<br/>
&nbsp;&nbsp;<span class="id" title="tactic">intros</span>;<br/>
&nbsp;&nbsp;<span class="id" title="tactic">try</span> <span class="id" title="tactic">apply</span> (@<span class="id" title="var">psos_r1b</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>);<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="keyword">goal</span> <span class="id" title="keyword">with</span> |- (@<span class="id" title="var">equality</span> ?<span class="id" title="var">r</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span> <span class="id" title="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="tactic">repeat</span> <span class="id" title="var">equalities_to_goal</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" title="var">nsatz_generic</span> <span class="id" title="var">radicalmax</span> <span class="id" title="tactic">info</span> <span class="id" title="var">lparam</span> <span class="id" title="var">lvar</span><br/>
&nbsp;&nbsp;<span class="id" title="keyword">end</span>.<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">Reals</span>.<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">RealField</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Rsth</span> : <span class="id" title="var">Setoid_Theory</span> <span class="id" title="var">R</span> (@<span class="id" title="var">eq</span> <span class="id" title="var">R</span>).<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Rops</span>: (@<span class="id" title="var">Ring_ops</span> <span class="id" title="var">R</span> 0%<span class="id" title="var">R</span> 1%<span class="id" title="var">R</span> <span class="id" title="var">Rplus</span> <span class="id" title="var">Rmult</span> <span class="id" title="var">Rminus</span> <span class="id" title="var">Ropp</span> (@<span class="id" title="var">eq</span> <span class="id" title="var">R</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Rri</span> : (<span class="id" title="var">Ring</span> (<span class="id" title="var">Ro</span>:=<span class="id" title="var">Rops</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Class</span> <span class="id" title="var">can_compute_Z</span> (<span class="id" title="var">z</span> : <span class="id" title="var">Z</span>) := <span class="id" title="var">dummy_can_compute_Z</span> : <span class="id" title="var">True</span>.<br/>
<span class="id" title="keyword">Hint Extern</span> 0 (<span class="id" title="var">can_compute_Z</span> ?<span class="id" title="var">v</span>) =&gt;<br/>
&nbsp;&nbsp;<span class="id" title="keyword">match</span> <span class="id" title="var">isZcst</span> <span class="id" title="var">v</span> <span class="id" title="keyword">with</span> <span class="id" title="var">true</span> =&gt; <span class="id" title="tactic">exact</span> <span class="id" title="var">I</span> <span class="id" title="keyword">end</span> : <span class="id" title="var">typeclass_instances</span>.<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">reify_IZR</span> <span class="id" title="var">z</span> <span class="id" title="var">lvar</span> {<span class="id" title="var">_</span> : <span class="id" title="var">can_compute_Z</span> <span class="id" title="var">z</span>} : <span class="id" title="var">reify</span> (<span class="id" title="var">PEc</span> <span class="id" title="var">z</span>) <span class="id" title="var">lvar</span> (<span class="id" title="var">IZR</span> <span class="id" title="var">z</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">R_one_zero</span>: 1%<span class="id" title="var">R</span> &lt;&gt; 0%<span class="id" title="var">R</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Rcri</span>: (<span class="id" title="var">Cring</span> (<span class="id" title="var">Rr</span>:=<span class="id" title="var">Rri</span>)).<br/>
<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Rdi</span> : (<span class="id" title="var">Integral_domain</span> (<span class="id" title="var">Rcr</span>:=<span class="id" title="var">Rcri</span>)).<br/>
<br/>

<br/>
<span class="id" title="keyword">Require</span> <span class="id" title="keyword">Import</span> <span class="id" title="var">QArith</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Qops</span>: (@<span class="id" title="var">Ring_ops</span> <span class="id" title="var">Q</span> 0%<span class="id" title="var">Q</span> 1%<span class="id" title="var">Q</span> <span class="id" title="var">Qplus</span> <span class="id" title="var">Qmult</span> <span class="id" title="var">Qminus</span> <span class="id" title="var">Qopp</span> <span class="id" title="var">Qeq</span>).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Qri</span> : (<span class="id" title="var">Ring</span> (<span class="id" title="var">Ro</span>:=<span class="id" title="var">Qops</span>)).<br/>
<span class="id" title="keyword">Defined</span>.<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Q_one_zero</span>: <span class="id" title="var">not</span> (<span class="id" title="var">Qeq</span> 1%<span class="id" title="var">Q</span> 0%<span class="id" title="var">Q</span>).<br/>
 
<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Qcri</span>: (<span class="id" title="var">Cring</span> (<span class="id" title="var">Rr</span>:=<span class="id" title="var">Qri</span>)).<br/>
<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Qdi</span> : (<span class="id" title="var">Integral_domain</span> (<span class="id" title="var">Rcr</span>:=<span class="id" title="var">Qcri</span>)).<br/>
<br/>

<br/>
<span class="id" title="keyword">Lemma</span> <span class="id" title="var">Z_one_zero</span>: 1%<span class="id" title="var">Z</span> &lt;&gt; 0%<span class="id" title="var">Z</span>.<br/>
 
<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Zcri</span>: (<span class="id" title="var">Cring</span> (<span class="id" title="var">Rr</span>:=<span class="id" title="var">Zr</span>)).<br/>
<br/>

<br/>
<span class="id" title="keyword">Instance</span> <span class="id" title="var">Zdi</span> : (<span class="id" title="var">Integral_domain</span> (<span class="id" title="var">Rcr</span>:=<span class="id" title="var">Zcri</span>)).<br/>
<br/>

<br/>
</div>
    <div id="sidebarWrapper">
      <div id="sidebar">
        <div class="block">
          <h2 class="title">Navigation</h2>
          <div class="content">
            <ul class="menu">
              <li class="leaf">Standard Library
                <ul class="menu">
                  <li><a href="index.html">Table of contents</a></li>
                  <li><a href="genindex.html">Index</a></li>
                </ul>
              </li>
            </ul>
          </div>
        </div>
      </div>
    </div>

  </div>

  <div id="footer">
    <div id="nav-footer">
      <ul class="links-menu-footer">
        <li><a href="mailto:coq-www_@_inria.fr">webmaster</a></li>
        <li><a href="http://validator.w3.org/">xhtml valid</a></li>
        <li><a href="http://jigsaw.w3.org/css-validator/">CSS valid</a></li>
      </ul>
    </div>
  </div>

</div>

</body>
</html>
