<!DOCTYPE html>
<html >
<head>


<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="shortcut icon" href="/favicon.ico" type="image/x-icon" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/node/node.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/defaults.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/system/system.css" />
<link type="text/css" rel="stylesheet" media="all" href="/modules/user/user.css" />
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/coq/style.css" />
<link type="text/css" rel="stylesheet" media="all" href="/sites/all/themes/coq/coqdoc.css" /><title>Chapter 15  Utilities</title>
</head>
<body >

<div id="container">

<div id="headertop">
<div id="nav">
  <ul class="links-menu">
    <li><a href="/" class="active">Home</a></li>
    <li><a href="/about-coq" title="More about coq">About Coq</a></li>
    <li><a href="/download">Get Coq</a></li>
    <li><a href="/documentation">Documentation</a></li>
    <li><a href="/community">Community</a></li>
  </ul>
</div>
</div>

<div id="header">
<div id="logoWrapper">
  <div id="logo"><a href="/" title="Home"><img src="/files/barron_logo.png" alt="Home" /></a>
  </div>
  <div id="siteName"><a href="/" title="Home">The Coq Proof Assistant</a>
  </div>
</div>
</div>

<div id="content">

<h1 id="Utilities" class="chapter">Chapter 15  Utilities</h1>
<ul>
<li><a href="tools.html#Coqmktop">15.1  Building a toplevel extended with user tactics</a>
</li><li><a href="tools.html#Makefile">15.2  Building a <span style="font-variant:small-caps">Coq</span> project with <span style="font-family:monospace">coq_makefile</span></a>
</li><li><a href="tools.html#Dependencies">15.3  Modules dependencies</a>
</li><li><a href="tools.html#coqdoc">15.4  Documenting <span style="font-variant:small-caps">Coq</span> files with coqdoc</a>
</li><li><a href="tools.html#Latex">15.5  Embedded <span style="font-variant:small-caps">Coq</span> phrases inside L<sup>A</sup>T<sub>E</sub>X documents</a>
</li><li><a href="tools.html#Emacs">15.6  <span style="font-variant:small-caps">Coq</span> and <span style="font-variant:small-caps">GNU Emacs</span></a>
</li><li><a href="tools.html#gallina">15.7  Module specification</a>
</li><li><a href="tools.html#ManPages">15.8  Man pages</a>
</li></ul>
<p>The distribution provides utilities to simplify some tedious works
beside proof development, tactics writing or documentation.</p><h2 id="Coqmktop" class="section">15.1  Building a toplevel extended with user tactics<a id="hevea_default1001"></a></h2>
<p>The native-code version of <span style="font-variant:small-caps">Coq</span> cannot dynamically load user tactics
using <span style="font-variant:small-caps">OCaml</span> code. It is possible to build a toplevel of <span style="font-variant:small-caps">Coq</span>,
with <span style="font-variant:small-caps">OCaml</span> code statically linked, with the tool <span style="font-family:monospace">coqmktop</span>.</p><p>For example, one can build a native-code <span style="font-variant:small-caps">Coq</span> toplevel extended with a tactic
which source is in <span style="font-family:monospace">tactic.ml</span> with the command
</p><pre class="verbatim">     % coqmktop -opt -o mytop.out tactic.cmx
</pre><p>where <span style="font-family:monospace">tactic.ml</span> has been compiled with the native-code
compiler <span style="font-family:monospace">ocamlopt</span>. This command generates an executable
called <span style="font-family:monospace">mytop.out</span>. To use this executable to compile your <span style="font-variant:small-caps">Coq</span>
files, use <span style="font-family:monospace">coqc -image mytop.out</span>.</p><p>A basic example is the native-code version of <span style="font-variant:small-caps">Coq</span> (<span style="font-family:monospace">coqtop.opt</span>),
which can be generated by <span style="font-family:monospace">coqmktop -opt -o coqopt.opt</span>.</p><h5 id="sec671" class="paragraph">Application: how to use the <span style="font-variant:small-caps">OCaml</span> debugger with Coq.<a id="hevea_default1002"></a></h5>
<p>One useful application of <span style="font-family:monospace">coqmktop</span> is to build a <span style="font-variant:small-caps">Coq</span> toplevel in
order to debug your tactics with the <span style="font-variant:small-caps">OCaml</span> debugger.
You need to have configured and compiled <span style="font-variant:small-caps">Coq</span> for debugging
(see the file <span style="font-family:monospace">INSTALL</span> included in the distribution).
Then, you must compile the Caml modules of your tactic with the
option <span style="font-family:monospace">-g</span> (with the bytecode compiler) and build a stand-alone
bytecode toplevel with the following command:</p><blockquote class="quotation">
<span style="font-family:monospace">% coqmktop -g -o coq-debug</span> <em>&lt;your </em><em><span style="font-family:monospace">.cmo</span></em><em> files&gt;</em>
</blockquote><p>To launch the <span style="font-variant:small-caps">OCaml</span> debugger with the image you need to execute it in
an environment which correctly sets the <span style="font-family:monospace">COQLIB</span> variable.
Moreover, you have to indicate the directories in which
<span style="font-family:monospace">ocamldebug</span> should search for Caml modules.</p><p>A possible solution is to use a wrapper around <span style="font-family:monospace">ocamldebug</span>
which detects the executables containing the word <span style="font-family:monospace">coq</span>. In
this case, the debugger is called with the required additional
arguments. In other cases, the debugger is simply called without additional
arguments. Such a wrapper can be found in the <span style="font-family:monospace">dev/</span>
subdirectory of the sources.</p><h2 id="Makefile" class="section">15.2  Building a <span style="font-variant:small-caps">Coq</span> project with <span style="font-family:monospace">coq_makefile</span>

<a id="hevea_default1003"></a>
<a id="hevea_default1004"></a>
<a id="hevea_default1005"></a></h2>
<p>The majority of <span style="font-variant:small-caps">Coq</span> projects are very similar: a collection of <span style="font-family:monospace">.v</span>
files and eventually some <span style="font-family:monospace">.ml</span> ones (a <span style="font-variant:small-caps">Coq</span> plugin). The main piece
of metadata needed in order to build the project are the command
line options to <span style="font-family:monospace">coqc</span> (e.g. <span style="font-family:monospace">-R, -I</span>,
<br>
<span style="font-weight:bold">See also: </span>Section <a href="commands.html#coqoptions">14.3.3</a>). Collecting the list of files and
options is the job of the <span style="font-family:monospace">_CoqProject</span> file.</p><p>A simple example of a <span style="font-family:monospace">_CoqProject</span> file follows:</p><pre class="verbatim">-R theories/ MyCode
theories/foo.v
theories/bar.v
-I src/
src/baz.ml4
src/bazaux.ml
src/qux_plugin.mlpack
</pre><p>Currently, both <span style="font-variant:small-caps">CoqIDE</span> and Proof General (version ≥ 4.3pre) understand
<span style="font-family:monospace">_CoqProject</span> files and invoke <span style="font-variant:small-caps">Coq</span> with the desired options.</p><p>The <span style="font-family:monospace">coq_makefile</span> utility can be used to set up a build infrastructure
for the <span style="font-variant:small-caps">Coq</span> project based on makefiles. The recommended way of
invoking <span style="font-family:monospace">coq_makefile</span> is the following one:</p><pre class="verbatim">coq_makefile -f _CoqProject -o CoqMakefile
</pre><p>Such command generates the following files:
</p><dl class="description"><dt class="dt-description">
	<span style="font-weight:bold"><span style="font-family:monospace">CoqMakefile</span></span></dt><dd class="dd-description"> is a generic makefile for GNU Make that provides targets to build the project (both <span style="font-family:monospace">.v</span> and <span style="font-family:monospace">.ml*</span> files), to install it system-wide in the <span style="font-family:monospace">coq-contrib</span> directory (i.e. where <span style="font-variant:small-caps">Coq</span> is installed) as well as to invoke <span style="font-family:monospace">coqdoc</span> to generate html documentation.<p>	</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">CoqMakefile.conf</span></span></dt><dd class="dd-description"> contains make variables assignments that reflect the contents of the <span style="font-family:monospace">_CoqProject</span> file as well as the path relevant to <span style="font-variant:small-caps">Coq</span>.
</dd></dl><p>An optional file <span style="font-weight:bold"><span style="font-family:monospace">CoqMakefile.local</span></span> can be provided by the user in order to extend <span style="font-family:monospace">CoqMakefile</span>. In particular one can declare custom actions to be performed before or after the build process. Similarly one can customize the install target or even provide new targets. Extension points are documented in paragraph <a href="#coqmakefile%3Alocal">15.2</a>.</p><p>The extensions of the files listed in <span style="font-family:monospace">_CoqProject</span> is
used in order to decide how to build them. In particular:</p><ul class="itemize"><li class="li-itemize">
<span style="font-variant:small-caps">Coq</span> files must use the <span style="font-family:monospace">.v</span> extension
</li><li class="li-itemize"><span style="font-variant:small-caps">OCaml</span> files must use the <span style="font-family:monospace">.ml</span> or <span style="font-family:monospace">.mli</span> extension
</li><li class="li-itemize"><span style="font-variant:small-caps">OCaml</span> files that require pre processing for syntax extensions (like <span style="font-family:monospace">VERNAC EXTEND</span>) must use the <span style="font-family:monospace">.ml4</span> extension
</li><li class="li-itemize">In order to generate a plugin one has to list all <span style="font-variant:small-caps">OCaml</span> modules (i.e. “Baz” for “baz.ml”) in a <span style="font-family:monospace">.mlpack</span> file (or <span style="font-family:monospace">.mllib</span> file).
</li></ul><p>The use of <span style="font-family:monospace">.mlpack</span> files has to be preferred over <span style="font-family:monospace">.mllib</span>
files, since it results in a “packed” plugin: All auxiliary
modules (as <span style="font-family:monospace">Baz</span> and <span style="font-family:monospace">Bazaux</span>) are hidden inside
the plugin’s “name space” (<span style="font-family:monospace">Qux_plugin</span>).
This reduces the chances of begin unable to load two distinct plugins
because of a clash in their auxiliary module names.</p>
<h5 id="sec673" class="paragraph">CoqMakefile.local</h5>
<p> <a id="coqmakefile:local"></a></p><p>The optional file <span style="font-family:monospace">CoqMakefile.local</span> is included by the generated file
<span style="font-family:monospace">CoqMakefile</span>. Such can contain two kinds of directives.</p><dl class="description"><dt class="dt-description">
<span style="font-weight:bold">Variable assignment</span></dt><dd class="dd-description"> to the variables listed in the <span style="font-family:monospace">Parameters</span>
	 section of the generated makefile. Here we describe only few of them.
<dl class="description"><dt class="dt-description">
<span style="font-weight:bold">CAMLPKGS</span></dt><dd class="dd-description"> can be used to specify third party findlib packages, and is
	 passed to the OCaml compiler on building or linking of modules.
Eg: <span style="font-family:monospace">-package yojson</span>.
</dd><dt class="dt-description"><span style="font-weight:bold">CAMLFLAGS</span></dt><dd class="dd-description"> can be used to specify additional flags to the OCaml
	 compiler, like <span style="font-family:monospace">-bin-annot</span> or <span style="font-family:monospace">-w...</span>.
</dd><dt class="dt-description"><span style="font-weight:bold">COQC, COQDEP, COQDOC</span></dt><dd class="dd-description"> can be set in order to use alternative 
	 binaries (e.g. wrappers)
</dd><dt class="dt-description"><span style="font-weight:bold">COQ_SRC_SUBDIRS</span></dt><dd class="dd-description"> can be extended by including other paths in which <span style="font-family:monospace">*.cm*</span> files are searched. For example <span style="font-family:monospace">COQ_SRC_SUBDIRS+=user-contrib/Unicoq</span> lets you build a plugin containing OCaml code that depends on the OCaml code of <span style="font-family:monospace">Unicoq</span>.
</dd></dl>
</dd><dt class="dt-description"><span style="font-weight:bold">Rule extension</span></dt><dd class="dd-description">
The following makefile rules can be extended. For example
<pre class="verbatim">pre-all::
        echo "This line is print before making the all target"
install-extra::
        cp ThisExtraFile /there/it/goes
</pre><dl class="description"><dt class="dt-description">
<span style="font-weight:bold">pre-all::</span></dt><dd class="dd-description"> run before the <span style="font-family:monospace">all</span> target. One can use this
	 to configure the project, or initialize sub modules or check
	 dependencies are met.
</dd><dt class="dt-description"><span style="font-weight:bold">post-all::</span></dt><dd class="dd-description"> run after the <span style="font-family:monospace">all</span> target. One can use this
	 to run a test suite, or compile extracted code.
</dd><dt class="dt-description"><span style="font-weight:bold">install-extra::</span></dt><dd class="dd-description"> run after <span style="font-family:monospace">install</span>. One can use this
	 to install extra files.
</dd><dt class="dt-description"><span style="font-weight:bold">install-doc::</span></dt><dd class="dd-description"> One can use this to install extra doc.
</dd><dt class="dt-description"><span style="font-weight:bold">uninstall::</span></dt><dd class="dd-description"> 
</dd><dt class="dt-description"><span style="font-weight:bold">uninstall-doc::</span></dt><dd class="dd-description">
</dd><dt class="dt-description"><span style="font-weight:bold">clean::</span></dt><dd class="dd-description">
</dd><dt class="dt-description"><span style="font-weight:bold">cleanall::</span></dt><dd class="dd-description">
</dd><dt class="dt-description"><span style="font-weight:bold">archclean::</span></dt><dd class="dd-description">
</dd><dt class="dt-description"><span style="font-weight:bold">merlin-hook::</span></dt><dd class="dd-description"> One can append lines to the generated <span style="font-family:monospace">.merlin</span>
	 file extending this target.
</dd></dl>
</dd></dl>
<h5 id="sec674" class="paragraph">Timing targets and performance testing</h5>
<p> The generated <span style="font-family:monospace">Makefile</span> supports the generation of two kinds
of timing data: per-file build-times, and per-line times for an
individual file.</p><p>The following targets and <span style="font-family:monospace">Makefile</span> variables allow collection
of per-file timing data:
</p><ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">TIMED=1</span> — passing this variable will cause
<span style="font-family:monospace">make</span> to emit a line describing the user-space build-time
and peak memory usage for each file built.<p><span style="font-family:monospace">Note</span>: On Mac OS, this works best if you’ve installed
<span style="font-family:monospace">gnu-time</span>.</p><p><span style="font-family:monospace">Example</span>: For example, the output of <span style="font-family:monospace">make TIMED=1</span>
may look like this:
</p><pre class="verbatim">COQDEP Fast.v
COQDEP Slow.v
COQC Slow.v
Slow (user: 0.34 mem: 395448 ko)
COQC Fast.v
Fast (user: 0.01 mem: 45184 ko)
</pre></li><li class="li-itemize"><span style="font-family:monospace">pretty-timed</span> — this target stores the output of
<span style="font-family:monospace">make TIMED=1</span> into <span style="font-family:monospace">time-of-build.log</span>, and displays
a table of the times, sorted from slowest to fastest, which is also
stored in <span style="font-family:monospace">time-of-build-pretty.log</span>. If you want to
construct the log for targets other than the default one, you can
pass them via the variable <span style="font-family:monospace">TGTS</span>, e.g., <span style="font-family:monospace">make
pretty-timed TGTS="a.vo b.vo"</span>.<p><span style="font-family:monospace">Note</span>: This target requires <span style="font-family:monospace">python</span> to build the table.</p><p><span style="font-family:monospace">Note</span>: This target will <em>append</em> to the timing log; if
you want a fresh start, you must remove the file
<span style="font-family:monospace">time-of-build.log</span> or run <span style="font-family:monospace">make cleanall</span>.</p><p><span style="font-family:monospace">Example</span>: For example, the output of <span style="font-family:monospace">make
pretty-timed</span> may look like this:
</p><pre class="verbatim">COQDEP Fast.v
COQDEP Slow.v
COQC Slow.v
Slow (user: 0.36 mem: 393912 ko)
COQC Fast.v
Fast (user: 0.05 mem: 45992 ko)
Time     | File Name
--------------------
0m00.41s | Total
--------------------
0m00.36s | Slow
0m00.05s | Fast
</pre></li><li class="li-itemize"><span style="font-family:monospace">print-pretty-timed-diff</span> — this target builds a table
of timing changes between two compilations; run <span style="font-family:monospace">make
make-pretty-timed-before</span> to build the log of the “before”
times, and run <span style="font-family:monospace">make make-pretty-timed-after</span> to build the
log of the “after” times. The table is printed on the command
line, and stored in <span style="font-family:monospace">time-of-build-both.log</span>. This target is
most useful for profiling the difference between two commits to a
repo.<p><span style="font-family:monospace">Note</span>: This target requires <span style="font-family:monospace">python</span> to build the table.</p><p><span style="font-family:monospace">Note</span>: The <span style="font-family:monospace">make-pretty-timed-before</span> and
<span style="font-family:monospace">make-pretty-timed-after</span> targets will <em>append</em> to the
timing log; if you want a fresh start, you must remove the files
<span style="font-family:monospace">time-of-build-before.log</span> and
<span style="font-family:monospace">time-of-build-after.log</span> or run <span style="font-family:monospace">make cleanall</span>
<em>before</em> building either the “before” or “after” targets.</p><p><span style="font-family:monospace">Note</span>: The table will be sorted first by absolute time
differences rounded towards zero to a whole-number of seconds, then
by times in the “after” column, and finally lexicographically by
file name. This will put the biggest changes in either direction
first, and will prefer sorting by build-time over subsecond changes
in build time (which are frequently noise); lexicographic sorting
forces an order on files which take effectively no time to compile.</p><p><span style="font-family:monospace">Example</span>: For example, the output table from <span style="font-family:monospace">make
print-pretty-timed-diff</span> may look like this:
</p><pre class="verbatim">After    | File Name | Before   || Change    | % Change
--------------------------------------------------------
0m00.39s | Total     | 0m00.35s || +0m00.03s | +11.42%
--------------------------------------------------------
0m00.37s | Slow      | 0m00.01s || +0m00.36s | +3600.00%
0m00.02s | Fast      | 0m00.34s || -0m00.32s | -94.11%
</pre></li></ul><p>The following targets and <span style="font-family:monospace">Makefile</span> variables allow collection
of per-line timing data:
</p><ul class="itemize"><li class="li-itemize">
<span style="font-family:monospace">TIMING=1</span> — passing this variable will cause
<span style="font-family:monospace">make</span> to use <span style="font-family:monospace">coqc -time</span> to write to a
<span style="font-family:monospace">.v.timing</span> file for each <span style="font-family:monospace">.v</span> file compiled, which
contains line-by-line timing information.<p><span style="font-family:monospace">Example</span>: For example, running <span style="font-family:monospace">make all TIMING=1</span> may
result in a file like this:
</p><pre class="verbatim">Chars 0 - 26 [Require~Coq.ZArith.BinInt.] 0.157 secs (0.128u,0.028s)
Chars 27 - 68 [Declare~Reduction~comp~:=~vm_c...] 0. secs (0.u,0.s)
Chars 69 - 162 [Definition~foo0~:=~Eval~comp~i...] 0.153 secs (0.136u,0.019s)
Chars 163 - 208 [Definition~foo1~:=~Eval~comp~i...] 0.239 secs (0.236u,0.s)
</pre></li><li class="li-itemize"><span style="font-family:monospace">print-pretty-single-time-diff
BEFORE=path/to/file.v.before-timing
AFTER=path/to/file.v.after-timing</span> — this target will make a
sorted table of the per-line timing differences between the timing
logs in the <span style="font-family:monospace">BEFORE</span> and <span style="font-family:monospace">AFTER</span> files, display it,
and save it to the file specified by the
<span style="font-family:monospace">TIME_OF_PRETTY_BUILD_FILE</span> variable, which defaults to
<span style="font-family:monospace">time-of-build-pretty.log</span>.<p>To generate the <span style="font-family:monospace">.v.before-timing</span> or
<span style="font-family:monospace">.v.after-timing</span> files, you should pass
<span style="font-family:monospace">TIMING=before</span> or <span style="font-family:monospace">TIMING=after</span> rather than
<span style="font-family:monospace">TIMING=1</span>.</p><p><span style="font-family:monospace">Note</span>: The sorting used here is the same as in the
<span style="font-family:monospace">print-pretty-timed-diff</span> target.</p><p><span style="font-family:monospace">Note</span>: This target requires <span style="font-family:monospace">python</span> to build the table.</p><p><span style="font-family:monospace">Example</span>: For example, running
<span style="font-family:monospace">print-pretty-single-time-diff</span> might give a table like this:
</p><pre class="verbatim">After     | Code                                                | Before    || Change    | % Change
---------------------------------------------------------------------------------------------------
0m00.50s  | Total                                               | 0m04.17s  || -0m03.66s | -87.96%
---------------------------------------------------------------------------------------------------
0m00.145s | Chars 069 - 162 [Definition~foo0~:=~Eval~comp~i...] | 0m00.192s || -0m00.04s | -24.47%
0m00.126s | Chars 000 - 026 [Require~Coq.ZArith.BinInt.]        | 0m00.143s || -0m00.01s | -11.88%
   N/A    | Chars 027 - 068 [Declare~Reduction~comp~:=~nati...] | 0m00.s    || +0m00.00s | N/A
0m00.s    | Chars 027 - 068 [Declare~Reduction~comp~:=~vm_c...] |    N/A    || +0m00.00s | N/A
0m00.231s | Chars 163 - 208 [Definition~foo1~:=~Eval~comp~i...] | 0m03.836s || -0m03.60s | -93.97%
</pre></li><li class="li-itemize"><span style="font-family:monospace">all.timing.diff</span>, <span style="font-family:monospace">path/to/file.v.timing.diff</span>
— The <span style="font-family:monospace">path/to/file.v.timing.diff</span> target will make a
<span style="font-family:monospace">.v.timing.diff</span> file for the corresponding <span style="font-family:monospace">.v</span> file,
with a table as would be generated by the
<span style="font-family:monospace">print-pretty-single-time-diff</span> target; it depends on having
already made the corresponding <span style="font-family:monospace">.v.before-timing</span> and
<span style="font-family:monospace">.v.after-timing</span> files, which can be made by passing
<span style="font-family:monospace">TIMING=before</span> and <span style="font-family:monospace">TIMING=after</span>. The
<span style="font-family:monospace">all.timing.diff</span> target will make such timing difference
files for all of the <span style="font-family:monospace">.v</span> files that the <span style="font-family:monospace">Makefile</span>
knows about. It will fail if some <span style="font-family:monospace">.v.before-timing</span> or
<span style="font-family:monospace">.v.after-timing</span> files don’t exist.<p><span style="font-family:monospace">Note</span>: This target requires <span style="font-family:monospace">python</span> to build the table.
</p></li></ul>
<h5 id="sec675" class="paragraph">Reusing/extending the generated Makefile</h5>
<p>Including the generated makefile with an <span style="font-family:monospace">include</span> directive is discouraged.
The contents of this file, including variable names
and status of rules shall change in the future. Users are advised to
include <span style="font-family:monospace">Makefile.conf</span> or call a target of the generated Makefile
as in <span style="font-family:monospace">make -f Makefile target</span> from another Makefile.</p><p>One way to get access to all targets of the generated
<span style="font-family:monospace">CoqMakefile</span> is to have a generic target for invoking unknown
targets. For example:
</p><pre class="verbatim"># KNOWNTARGETS will not be passed along to CoqMakefile
KNOWNTARGETS := CoqMakefile extra-stuff extra-stuff2
# KNOWNFILES will not get implicit targets from the final rule, and so
# depending on them won't invoke the submake
# Warning: These files get declared as PHONY, so any targets depending
# on them always get rebuilt
KNOWNFILES   := Makefile _CoqProject

.DEFAULT_GOAL := invoke-coqmakefile

CoqMakefile: Makefile _CoqProject
 $(COQBIN)coq_makefile -f _CoqProject -o CoqMakefile

invoke-coqmakefile: CoqMakefile
 $(MAKE) --no-print-directory -f CoqMakefile $(filter-out $(KNOWNTARGETS),$(MAKECMDGOALS))

.PHONY: invoke-coqmakefile $(KNOWNFILES)

####################################################################
##                      Your targets here                         ##
####################################################################

# This should be the last rule, to handle any targets not declared above
%: invoke-coqmakefile
 @true
</pre>
<h5 id="sec676" class="paragraph">Building a subset of the targets with -j</h5>
<p>To build, say, two targets <span style="font-family:monospace">foo.vo</span> and <span style="font-family:monospace">bar.vo</span>
in parallel one can use <span style="font-family:monospace">make only TGTS="foo.vo bar.vo" -j</span>.</p><p>Note that <span style="font-family:monospace">make foo.vo bar.vo -j</span> has a different meaning for
the make utility, in particular it may build a shared prerequisite twice.</p>
<h5 id="sec677" class="paragraph">Notes for users of <span style="font-family:monospace">coq_makefile</span> with version &lt; 8.7</h5>
<ul class="itemize"><li class="li-itemize">
Support for “sub-directory” is deprecated. To perform actions before
	or after the build (like invoking make on a subdirectory) one can
	hook in <span style="font-family:monospace">pre-all</span> and <span style="font-family:monospace">post-all</span> extension points
</li><li class="li-itemize"><span style="font-family:monospace">-extra-phony</span> and <span style="font-family:monospace">-extra</span> are deprecated. To provide
	additional target (<span style="font-family:monospace">.PHONY</span> or not) please use
	<span style="font-family:monospace">CoqMakefile.local</span>
</li></ul><h2 id="Dependencies" class="section">15.3  Modules dependencies<a id="hevea_default1006"></a>
<a id="hevea_default1007"></a></h2>
<p>In order to compute modules dependencies (so to use <span style="font-family:monospace">make</span>),
<span style="font-variant:small-caps">Coq</span> comes with an appropriate tool, <span style="font-family:monospace">coqdep</span>.</p><p><span style="font-family:monospace">coqdep</span> computes inter-module dependencies for <span style="font-variant:small-caps">Coq</span> and
<span style="font-variant:small-caps">OCaml</span> programs, and prints the dependencies on the standard
output in a format readable by make. When a directory is given as
argument, it is recursively looked at.</p><p>Dependencies of <span style="font-variant:small-caps">Coq</span> modules are computed by looking at <span style="font-family:monospace">Require</span>
commands (<span style="font-family:monospace">Require</span>, <span style="font-family:monospace">Require Export</span>, <span style="font-family:monospace">Require Import</span>,
but also at the command <span style="font-family:monospace">Declare ML Module</span>.</p><p>Dependencies of <span style="font-variant:small-caps">OCaml</span> modules are computed by looking at
<code>open</code> commands and the dot notation <em>module.value</em>. However,
this is done approximately and you are advised to use <span style="font-family:monospace">ocamldep</span>
instead for the <span style="font-variant:small-caps">OCaml</span> modules dependencies.</p><p>See the man page of <span style="font-family:monospace">coqdep</span> for more details and options.</p><p>The build infrastructure generated by <span style="font-family:monospace">coq_makefile</span>
uses <span style="font-family:monospace">coqdep</span> to automatically compute the dependencies
among the files part of the project.</p><h2 id="coqdoc" class="section">15.4  Documenting <span style="font-variant:small-caps">Coq</span> files with coqdoc
<a id="hevea_default1008"></a></h2>
<p><span style="font-family:sans-serif">coqdoc</span> is a documentation tool for the proof assistant
<span style="font-variant:small-caps">Coq</span>, similar to <span style="font-family:sans-serif">javadoc</span> or <span style="font-family:sans-serif">ocamldoc</span>. 
The task of <span style="font-family:sans-serif">coqdoc</span> is
</p><ol class="enumerate" type=1><li class="li-enumerate">
to produce a nice L<sup>A</sup>T<sub>E</sub>X and/or HTML document from the <span style="font-variant:small-caps">Coq</span> 
sources, readable for a human and not only for the proof assistant;
</li><li class="li-enumerate">to help the user navigating in his own (or third-party) sources.
</li></ol>
<h3 id="sec680" class="subsection">15.4.1  Principles</h3>
<p>Documentation is inserted into <span style="font-variant:small-caps">Coq</span> files as <em>special comments</em>. 
Thus your files will compile as usual, whether you use <span style="font-family:sans-serif">coqdoc</span> or not.
<span style="font-family:sans-serif">coqdoc</span> presupposes that the given <span style="font-variant:small-caps">Coq</span> files are well-formed (at
least lexically). Documentation starts with
<span style="font-family:monospace">(**</span>, followed by a space, and ends with the pending <span style="font-family:monospace">*)</span>. 
The documentation format is inspired
by Todd A. Coram’s <em>Almost Free Text (AFT)</em> tool: it is mainly
ASCII text with some syntax-light controls, described below.
<span style="font-family:sans-serif">coqdoc</span> is robust: it shouldn’t fail, whatever the input is. But
remember: “garbage in, garbage out”.</p>
<h5 id="sec681" class="paragraph"><span style="font-variant:small-caps">Coq</span> material inside documentation.</h5>
<p>
<span style="font-variant:small-caps">Coq</span> material is quoted between the
delimiters <span style="font-family:monospace">[</span> and <span style="font-family:monospace">]</span>. Square brackets may be nested,
the inner ones being understood as being part of the quoted code (thus
you can quote a term like <span style="font-family:monospace">fun x =&gt; u</span> by writing
<span style="font-family:monospace">[fun x =&gt; u]</span>). Inside quotations, the code is pretty-printed in
the same way as it is in code parts.</p><p>Pre-formatted vernacular is enclosed by <span style="font-family:monospace">[[</span> and
<span style="font-family:monospace">]]</span>. The former must be followed by a newline and the latter
must follow a newline.</p>
<h5 id="sec682" class="paragraph">Pretty-printing.</h5>
<p>
<span style="font-family:sans-serif">coqdoc</span> uses different faces for identifiers and keywords. 
The pretty-printing of <span style="font-variant:small-caps">Coq</span> tokens (identifiers or symbols) can be
controlled using one of the following commands:
</p><pre>
(** printing <em>token</em> %...L<sup>A</sup>T<sub>E</sub>X...% #...HTML...# *)
</pre><p>
or
</p><pre>
(** printing <em>token</em> $...L<sup>A</sup>T<sub>E</sub>X math...$ #...HTML...# *)
</pre><p>
It gives the L<sup>A</sup>T<sub>E</sub>X and HTML texts to be produced for the given <span style="font-variant:small-caps">Coq</span>
token. One of the L<sup>A</sup>T<sub>E</sub>X or HTML text may be omitted, causing the
default pretty-printing to be used for this token.</p><p>The printing for one token can be removed with
</p><pre>
(** remove printing <em>token</em> *)
</pre><p>Initially, the pretty-printing table contains the following mapping:
</p><div class="center"><div class="centered">
<table style="border-spacing:6px;border-collapse:separate;" class="cellpading0"><tr><td style="text-align:left;white-space:nowrap" > <code>-&gt;</code></td><td style="text-align:left;white-space:nowrap" >→</td><td style="text-align:center;white-space:nowrap" >        </td><td style="text-align:left;white-space:nowrap" > <code>&lt;-</code></td><td style="text-align:left;white-space:nowrap" >←</td><td style="text-align:center;white-space:nowrap" >        </td><td style="text-align:left;white-space:nowrap" > <code>*</code></td><td style="text-align:left;white-space:nowrap" >× </td><td style="text-align:center;white-space:nowrap" >        </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code>&lt;=</code></td><td style="text-align:left;white-space:nowrap" >≤</td><td style="text-align:center;white-space:nowrap" >        </td><td style="text-align:left;white-space:nowrap" > <code>&gt;=</code></td><td style="text-align:left;white-space:nowrap" >≥</td><td style="text-align:center;white-space:nowrap" >        </td><td style="text-align:left;white-space:nowrap" > <code>=&gt;</code></td><td style="text-align:left;white-space:nowrap" >⇒ </td><td style="text-align:center;white-space:nowrap" >        </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code>&lt;&gt;</code></td><td style="text-align:left;white-space:nowrap" >≠</td><td style="text-align:center;white-space:nowrap" >        </td><td style="text-align:left;white-space:nowrap" > <code>&lt;-&gt;</code></td><td style="text-align:left;white-space:nowrap" >↔</td><td style="text-align:center;white-space:nowrap" >        </td><td style="text-align:left;white-space:nowrap" > <code>|-</code></td><td style="text-align:left;white-space:nowrap" >⊢ </td><td style="text-align:center;white-space:nowrap" >        </td></tr>
<tr><td style="text-align:left;white-space:nowrap" > <code>\/</code></td><td style="text-align:left;white-space:nowrap" >∨</td><td style="text-align:center;white-space:nowrap" >        </td><td style="text-align:left;white-space:nowrap" > <code>/\</code></td><td style="text-align:left;white-space:nowrap" >∧</td><td style="text-align:center;white-space:nowrap" >        </td><td style="text-align:left;white-space:nowrap" > <code>~</code></td><td style="text-align:left;white-space:nowrap" >¬ 
</td><td style="text-align:center;white-space:nowrap" >        </td></tr>
</table>
</div></div><p>
Any of these can be overwritten or suppressed using the
<span style="font-family:monospace">printing</span> commands.</p><p>Important note: the recognition of tokens is done by a (ocaml)lex
automaton and thus applies the longest-match rule. For instance,
<code>-&gt;~</code> is recognized as a single token, where <span style="font-variant:small-caps">Coq</span> sees two
tokens. It is the responsibility of the user to insert space between
tokens <em>or</em> to give pretty-printing rules for the possible
combinations, e.g. 
</p><pre class="verbatim">(** printing -&gt;~ %\ensuremath{\rightarrow\lnot}% *)
</pre>
<h5 id="sec683" class="paragraph">Sections.</h5>
<p>
Sections are introduced by 1 to 4 leading stars (i.e. at the beginning of the
line) followed by a space. One star is a section, two stars a sub-section, etc.
The section title is given on the remaining of the line.
Example:
</p><pre class="verbatim">    (** * Well-founded relations
  
        In this section, we introduce...  *)
</pre>
<h5 id="sec684" class="paragraph">Lists.</h5>
<p>
List items are introduced by a leading dash. <span style="font-family:sans-serif">coqdoc</span> uses whitespace
to determine the depth of a new list item and which text belongs in
which list items. A list ends when a line of text starts at or before
the level of indenting of the list’s dash. A list item’s dash must
always be the first non-space character on its line (so, in
particular, a list can not begin on the first line of a comment -
start it on the second line instead).</p><p>Example:
</p><pre class="verbatim">     We go by induction on [n]:
     - If [n] is 0...
     - If [n] is [S n'] we require...

       two paragraphs of reasoning, and two subcases:

       - In the first case...
       - In the second case...

     So the theorem holds.
</pre>
<h5 id="sec685" class="paragraph">Rules.</h5>
<p>
More than 4 leading dashes produce a horizontal rule.</p>
<h5 id="sec686" class="paragraph">Emphasis.</h5>
<p>
Text can be italicized by placing it in underscores. A non-identifier
character must precede the leading underscore and follow the trailing
underscore, so that uses of underscores in names aren’t mistaken for
emphasis. Usually, these are spaces or punctuation.</p><pre class="verbatim">    This sentence contains some _emphasized text_.
</pre>
<h5 id="sec687" class="paragraph">Escaping to L<sup>A</sup>T<sub>E</sub>X and HTML.</h5>
<p>
Pure L<sup>A</sup>T<sub>E</sub>X or HTML material can be inserted using the following
escape sequences:
</p><ul class="itemize"><li class="li-itemize">
<code>$...LaTeX stuff...$</code> inserts some L<sup>A</sup>T<sub>E</sub>X material in math mode.
Simply discarded in HTML output.</li><li class="li-itemize"><code>%...LaTeX stuff...%</code> inserts some L<sup>A</sup>T<sub>E</sub>X material.
Simply discarded in HTML output.</li><li class="li-itemize"><code>#...HTML stuff...#</code> inserts some HTML material. Simply
discarded in L<sup>A</sup>T<sub>E</sub>X output.
</li></ul><p>Note: to simply output the characters <code>$</code>, <code>%</code> and <code>#</code>
and escaping their escaping role, these characters must be doubled.</p>
<h5 id="sec688" class="paragraph">Verbatim.</h5>
<p> 
Verbatim material is introduced by a leading <code>&lt;&lt;</code> and closed by
<code>&gt;&gt;</code> at the beginning of a line. Example:
</p><pre class="verbatim">Here is the corresponding caml code:
&lt;&lt;
  let rec fact n = 
    if n &lt;= 1 then 1 else n * fact (n-1)
&gt;&gt;
</pre>
<h5 id="sec689" class="paragraph">Hyperlinks.</h5>
<p>
Hyperlinks can be inserted into the HTML output, so that any
identifier is linked to the place of its definition.</p><p><span style="font-family:monospace">coqc </span><span style="font-family:monospace"><em>file</em></span><span style="font-family:monospace">.v</span> automatically dumps localization information
in <span style="font-family:monospace"><em>file</em></span><span style="font-family:monospace">.glob</span> or appends it to a file specified using option
<span style="font-family:monospace">--dump-glob </span><span style="font-family:monospace"><em>file</em></span>. Take care of erasing this global file, if
any, when starting the whole compilation process.</p><p>Then invoke <span style="font-family:monospace">coqdoc</span> or <span style="font-family:monospace">coqdoc --glob-from </span><span style="font-family:monospace"><em>file</em></span> to tell
<span style="font-family:sans-serif">coqdoc</span> to look for name resolutions into the file <span style="font-family:monospace"><em>file</em></span>
(it will look in <span style="font-family:monospace"><em>file</em></span><span style="font-family:monospace">.glob</span> by default).</p><p>Identifiers from the <span style="font-variant:small-caps">Coq</span> standard library are linked to the <span style="font-variant:small-caps">Coq</span>
web site at <a href="http://coq.inria.fr/library/"><span style="font-family:monospace">http://coq.inria.fr/library/</span></a>. This behavior can be
changed using command line options <span style="font-family:monospace">--no-externals</span> and
<span style="font-family:monospace">--coqlib</span>; see below.</p>
<h5 id="sec690" class="paragraph">Hiding / Showing parts of the source.</h5>
<p>
Some parts of the source can be hidden using command line options
<span style="font-family:monospace">-g</span> and <span style="font-family:monospace">-l</span> (see below), or using such comments:
</p><pre>
(* begin hide *)
<em>some Coq material</em>
(* end hide *)
</pre><p>
Conversely, some parts of the source which would be hidden can be
shown using such comments: 
</p><pre>
(* begin show *)
<em>some Coq material</em>
(* end show *)
</pre><p>
The latter cannot be used around some inner parts of a proof, but can
be used around a whole proof.</p>
<h3 id="sec691" class="subsection">15.4.2  Usage</h3>
<p><span style="font-family:sans-serif">coqdoc</span> is invoked on a shell command line as follows:
</p><table class="display dcenter"><tr style="vertical-align:middle"><td class="dcell">  <span style="font-family:monospace">coqdoc </span>&lt;<span style="font-style:italic">options and files</span>&gt;
</td></tr>
</table><p>
Any command line argument which is not an option is considered to be a
file (even if it starts with a <code>-</code>). <span style="font-variant:small-caps">Coq</span> files are identified
by the suffixes <code>.v</code> and <code>.g</code> and L<sup>A</sup>T<sub>E</sub>X files by the
suffix <code>.tex</code>. </p><dl class="description"><dt class="dt-description">
<span style="font-weight:bold">HTML output</span></dt><dd class="dd-description">  <p>This is the default output.
One HTML file is created for each <span style="font-variant:small-caps">Coq</span> file given on the command line,
together with a file <span style="font-family:monospace">index.html</span> (unless option
<span style="font-family:monospace">-no-index</span> is passed). The HTML pages use a style sheet
named <span style="font-family:monospace">style.css</span>. Such a file is distributed with <span style="font-family:sans-serif">coqdoc</span>.</p></dd><dt class="dt-description"><span style="font-weight:bold">L<sup>A</sup>T<sub>E</sub>X output</span></dt><dd class="dd-description">  <p>A single L<sup>A</sup>T<sub>E</sub>X file is created, on standard output. It can be
redirected to a file with option <span style="font-family:monospace">-o</span>. 
The order of files on the command line is kept in the final
document. L<sup>A</sup>T<sub>E</sub>X files given on the command line are copied ‘as is’
in the final document .
DVI and PostScript can be produced directly with the options
<span style="font-family:monospace">-dvi</span> and <span style="font-family:monospace">-ps</span> respectively.</p></dd><dt class="dt-description"><span style="font-weight:bold">T<sub>E</sub>Xmacs output</span></dt><dd class="dd-description">  <p>To translate the input files to T<sub>E</sub>Xmacs format, to be used by
the T<sub>E</sub>Xmacs Coq interface.
</p></dd></dl><h4 id="sec692" class="subsubsection">Command line options</h4>
<h5 id="sec693" class="paragraph">Overall options</h5>
<dl class="description"><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--html</span></span></dt><dd class="dd-description">  <p>Select a HTML output.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--latex</span></span></dt><dd class="dd-description">  <p>Select a L<sup>A</sup>T<sub>E</sub>X output.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--dvi</span></span></dt><dd class="dd-description">  <p>Select a DVI output.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--ps</span></span></dt><dd class="dd-description">  <p>Select a PostScript output.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--texmacs</span></span></dt><dd class="dd-description">  <p>Select a T<sub>E</sub>Xmacs output.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--stdout</span></span></dt><dd class="dd-description">  <p>Write output to stdout.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-o </span></span><span style="font-weight:bold"><span style="font-style:italic">file</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--output </span></span><span style="font-weight:bold"><span style="font-style:italic">file</span></span></dt><dd class="dd-description">  <p>Redirect the output into the file ‘<span style="font-style:italic">file</span>’ (meaningless with
<span style="font-family:monospace">-html</span>).</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-d </span></span><span style="font-weight:bold"><span style="font-style:italic">dir</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--directory </span></span><span style="font-weight:bold"><span style="font-style:italic">dir</span></span></dt><dd class="dd-description">  <p>Output files into directory ‘<span style="font-style:italic">dir</span>’ instead of current
directory (option <span style="font-family:monospace">-d</span> does not change the filename specified
with option <span style="font-family:monospace">-o</span>, if any).</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--body-only</span></span></dt><dd class="dd-description">  <p>Suppress the header and trailer of the final document. Thus, you can
insert the resulting document into a larger one.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-p</span></span><span style="font-weight:bold"> </span><span style="font-weight:bold"><span style="font-style:italic">string</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--preamble</span></span><span style="font-weight:bold"> </span><span style="font-weight:bold"><span style="font-style:italic">string</span></span></dt><dd class="dd-description"> <p>Insert some material in the L<sup>A</sup>T<sub>E</sub>X preamble, right before
<code>\begin{document}</code> (meaningless with <span style="font-family:monospace">-html</span>).</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--vernac-file </span></span><span style="font-weight:bold"><span style="font-style:italic">file</span></span><span style="font-weight:bold">,
</span><span style="font-weight:bold"><span style="font-family:monospace">--tex-file </span></span><span style="font-weight:bold"><span style="font-style:italic">file</span></span></dt><dd class="dd-description">  <p>Considers the file ‘<span style="font-style:italic">file</span>’ respectively as a <code>.v</code>
(or <code>.g</code>) file or a <code>.tex</code> file.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--files-from </span></span><span style="font-weight:bold"><span style="font-style:italic">file</span></span></dt><dd class="dd-description">  <p>Read file names to process in file ‘<span style="font-style:italic">file</span>’ as if they were
given on the command line. Useful for program sources split up into
several directories.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-q</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--quiet</span></span></dt><dd class="dd-description">  <p>Be quiet. Do not print anything except errors.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-h</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--help</span></span></dt><dd class="dd-description">  <p>Give a short summary of the options and exit.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-v</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--version</span></span></dt><dd class="dd-description">  <p>Print the version and exit.</p></dd></dl>
<h5 id="sec694" class="paragraph">Index options</h5>
<p>Default behavior is to build an index, for the HTML output only, into
<span style="font-family:monospace">index.html</span>.</p><dl class="description"><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--no-index</span></span></dt><dd class="dd-description">  <p>Do not output the index.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--multi-index</span></span></dt><dd class="dd-description">  <p>Generate one page for each category and each letter in the index,
together with a top page <span style="font-family:monospace">index.html</span>.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--index </span></span><span style="font-weight:bold"><span style="font-style:italic">string</span></span></dt><dd class="dd-description">  <p>Make the filename of the index <span style="font-style:italic">string</span> instead of “index”.
Useful since “index.html” is special.</p></dd></dl>
<h5 id="sec695" class="paragraph">Table of contents option</h5>
<dl class="description"><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-toc</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--table-of-contents</span></span></dt><dd class="dd-description">  <p>Insert a table of contents.
For a L<sup>A</sup>T<sub>E</sub>X output, it inserts a <code>\tableofcontents</code> at the
beginning of the document. For a HTML output, it builds a table of
contents into <span style="font-family:monospace">toc.html</span>.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--toc-depth </span></span><span style="font-weight:bold"><span style="font-style:italic">int</span></span></dt><dd class="dd-description">  <p>Only include headers up to depth <span style="font-style:italic">int</span> in the table of
contents.</p></dd></dl>
<h5 id="sec696" class="paragraph">Hyperlinks options</h5>
<dl class="description"><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--glob-from </span></span><span style="font-weight:bold"><span style="font-style:italic">file</span></span></dt><dd class="dd-description">  <p>Make references using <span style="font-variant:small-caps">Coq</span> globalizations from file <span style="font-style:italic">file</span>. 
(Such globalizations are obtained with <span style="font-variant:small-caps">Coq</span> option <span style="font-family:monospace">-dump-glob</span>).</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--no-externals</span></span></dt><dd class="dd-description">  <p>Do not insert links to the <span style="font-variant:small-caps">Coq</span> standard library.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--external </span></span><span style="font-weight:bold"><span style="font-style:italic">url</span></span><span style="font-weight:bold"> </span><span style="font-weight:bold"><span style="font-style:italic">coqdir</span></span></dt><dd class="dd-description">  <p>Use given URL for linking references whose name starts with prefix
<span style="font-style:italic">coqdir</span>.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--coqlib </span></span><span style="font-weight:bold"><span style="font-style:italic">url</span></span></dt><dd class="dd-description">  <p>Set base URL for the <span style="font-variant:small-caps">Coq</span> standard library (default is 
<a href="http://coq.inria.fr/library/"><span style="font-family:monospace">http://coq.inria.fr/library/</span></a>). This is equivalent to
<span style="font-family:monospace">--external </span><span style="font-style:italic">url</span> <span style="font-family:monospace">Coq</span>.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-R </span></span><span style="font-weight:bold"><span style="font-style:italic">dir </span></span><span style="font-weight:bold"><span style="font-style:italic">coqdir</span></span></dt><dd class="dd-description">  <p>Map physical directory <span style="font-style:italic">dir</span> to <span style="font-variant:small-caps">Coq</span> logical directory
<span style="font-style:italic">coqdir</span> (similarly to <span style="font-variant:small-caps">Coq</span> option <span style="font-family:monospace">-R</span>).</p><p>Note: option <span style="font-family:monospace">-R</span> only has effect on the files
<em>following</em> it on the command line, so you will probably need
to put this option first.</p></dd></dl>
<h5 id="sec697" class="paragraph">Title options</h5>
<dl class="description"><dt class="dt-description">
<span style="font-weight:bold"><span style="font-family:monospace">-s </span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--short</span></span></dt><dd class="dd-description">  <p>Do not insert titles for the files. The default behavior is to
insert a title like “Library Foo” for each file.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--lib-name </span></span><span style="font-weight:bold"><span style="font-style:italic">string</span></span></dt><dd class="dd-description">  <p>Print “<span style="font-style:italic">string</span> Foo” instead of “Library Foo” in titles.
For example “Chapter” and “Module” are reasonable choices.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--no-lib-name</span></span></dt><dd class="dd-description">  <p>Print just “Foo” instead of “Library Foo” in titles.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--lib-subtitles</span></span></dt><dd class="dd-description">  <p>Look for library subtitles. When enabled, the beginning of each
file is checked for a comment of the form:
</p><pre>
(** * ModuleName : text *)
</pre><p>
where <span style="font-family:monospace">ModuleName</span> must be the name of the file. If it is
present, the <span style="font-family:monospace">text</span> is used as a subtitle for the module in
appropriate places.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-t </span></span><span style="font-weight:bold"><span style="font-style:italic">string</span></span><span style="font-weight:bold">, 
</span><span style="font-weight:bold"><span style="font-family:monospace">--title </span></span><span style="font-weight:bold"><span style="font-style:italic">string</span></span></dt><dd class="dd-description">  <p>Set the document title. </p></dd></dl>
<h5 id="sec698" class="paragraph">Contents options</h5>
<dl class="description"><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-g</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--gallina</span></span></dt><dd class="dd-description">  <p>Do not print proofs.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-l</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--light</span></span></dt><dd class="dd-description">  <p>Light mode. Suppress proofs (as with <span style="font-family:monospace">-g</span>) and the following commands:
</p><ul class="itemize"><li class="li-itemize">
[<span style="font-family:monospace">Recursive</span>] <span style="font-family:monospace">Tactic Definition</span>
</li><li class="li-itemize"><span style="font-family:monospace">Hint / Hints</span> 
</li><li class="li-itemize"><span style="font-family:monospace">Require</span>
</li><li class="li-itemize"><span style="font-family:monospace">Transparent / Opaque</span>
</li><li class="li-itemize"><span style="font-family:monospace">Implicit Argument / Implicits</span>
</li><li class="li-itemize"><span style="font-family:monospace">Section / Variable / Hypothesis / End</span>
</li></ul></dd></dl><p>
The behavior of options <span style="font-family:monospace">-g</span> and <span style="font-family:monospace">-l</span> can be locally
overridden using the <span style="font-family:monospace">(* begin show *)</span> … <span style="font-family:monospace">(* end
show *)</span> environment (see above).</p><p>There are a few options to drive the parsing of comments:
</p><dl class="description"><dt class="dt-description">
<span style="font-weight:bold"><span style="font-family:monospace">--parse-comments</span></span></dt><dd class="dd-description">  <p>Parses regular comments delimited by <span style="font-family:monospace">(*</span> and <span style="font-family:monospace">*)</span> as 
well. They are typeset inline.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--plain-comments</span></span></dt><dd class="dd-description">  <p>Do not interpret comments, simply copy them as plain-text.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--interpolate</span></span></dt><dd class="dd-description">  <p>Use the globalization information to typeset identifiers appearing in
<span style="font-variant:small-caps">Coq</span> escapings inside comments.
</p></dd></dl>
<h5 id="sec699" class="paragraph">Language options</h5>
<p>Default behavior is to assume ASCII 7 bits input files.</p><dl class="description"><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-latin1</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--latin1</span></span></dt><dd class="dd-description">  <p>Select ISO-8859-1 input files. It is equivalent to
<span style="font-family:monospace">--inputenc latin1 --charset iso-8859-1</span>.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">-utf8</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">--utf8</span></span></dt><dd class="dd-description">  <p>Set <span style="font-family:monospace">--inputenc utf8x</span> for L<sup>A</sup>T<sub>E</sub>X output and
<span style="font-family:monospace">--charset utf-8</span> for HTML output. Also use Unicode
replacements for a couple of standard plain ASCII notations such
as → for <span style="font-family:monospace">-&gt;</span> and ∀ for
<span style="font-family:monospace">forall</span>. L<sup>A</sup>T<sub>E</sub>X UTF-8 support can be found at
<a href="http://www.ctan.org/pkg/unicode"><span style="font-family:monospace">http://www.ctan.org/pkg/unicode</span></a>.</p><p>For the interpretation of Unicode characters by L<sup>A</sup>T<sub>E</sub>X, extra
packages which <span style="font-family:sans-serif">coqdoc</span> does not provide by default might be
required, such as <span style="font-family:monospace">textgreek</span> for some Greek letters or
<span style="font-family:monospace">stmaryrd</span> for some mathematical symbols. If a Unicode
character is missing an interpretation in the <span style="font-family:monospace">utf8x</span> input
encoding, add
<code>\DeclareUnicodeCharacter{</code><span style="font-style:italic">code</span><code>}{</code><span style="font-style:italic">latex-interpretation</span><code>}</code>. Packages
and declarations can be added with option <span style="font-family:monospace">-p</span>.</p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--inputenc</span></span><span style="font-weight:bold"> </span><span style="font-weight:bold"><span style="font-style:italic">string</span></span></dt><dd class="dd-description">  <p>Give a L<sup>A</sup>T<sub>E</sub>X input encoding, as an option to L<sup>A</sup>T<sub>E</sub>X package
<span style="font-family:monospace">inputenc</span>. </p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">--charset</span></span><span style="font-weight:bold"> </span><span style="font-weight:bold"><span style="font-style:italic">string</span></span></dt><dd class="dd-description">  <p>Specify the HTML character set, to be inserted in the HTML header.</p></dd></dl><h3 id="section:coqdoc.sty" class="subsection">15.4.3  The coqdoc L<sup>A</sup>T<sub>E</sub>X style file</h3>
<p>In case you choose to produce a document without the default L<sup>A</sup>T<sub>E</sub>X
preamble (by using option <code>--no-preamble</code>), then you must insert
into your own preamble the command
</p><blockquote class="quote">
<code>\usepackage{coqdoc}</code>
</blockquote><p>The package optionally takes the argument <code>[color]</code> to typeset
identifiers with colors (this requires the <code>xcolor</code> package).</p><p>Then you may alter the rendering of the document by
redefining some macros:
</p><dl class="description"><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">coqdockw</span></span><span style="font-weight:bold">, </span><span style="font-weight:bold"><span style="font-family:monospace">coqdocid</span></span><span style="font-weight:bold">, …</span></dt><dd class="dd-description">   <p>The one-argument macros for typesetting keywords and identifiers.
Defaults are sans-serif for keywords and italic for identifiers.</p><p>For example, if you would like a slanted font for keywords, you
may insert 
</p><pre class="verbatim">     \renewcommand{\coqdockw}[1]{\textsl{#1}}
</pre><p>anywhere between <code>\usepackage{coqdoc}</code> and
<code>\begin{document}</code>. </p></dd><dt class="dt-description"><span style="font-weight:bold"><span style="font-family:monospace">coqdocmodule</span></span></dt><dd class="dd-description">   <p>One-argument macro for typesetting the title of a <code>.v</code> file.
Default is
</p><pre class="verbatim">\newcommand{\coqdocmodule}[1]{\section*{Module #1}}
</pre><p>and you may redefine it using <code>\renewcommand</code>.</p></dd></dl><h2 id="Latex" class="section">15.5  Embedded <span style="font-variant:small-caps">Coq</span> phrases inside L<sup>A</sup>T<sub>E</sub>X documents
<a id="hevea_default1009"></a><a id="hevea_default1010"></a></h2>
<p>When writing a documentation about a proof development, one may want
to insert <span style="font-variant:small-caps">Coq</span> phrases inside a L<sup>A</sup>T<sub>E</sub>X document, possibly together with
the corresponding answers of the system. We provide a
mechanical way to process such <span style="font-variant:small-caps">Coq</span> phrases embedded in L<sup>A</sup>T<sub>E</sub>X files: the
<span style="font-family:monospace">coq-tex</span> filter. This filter extracts Coq phrases embedded in
LaTeX files, evaluates them, and insert the outcome of the evaluation
after each phrase.</p><p>Starting with a file <em>file</em><span style="font-family:monospace">.tex</span> containing <span style="font-variant:small-caps">Coq</span> phrases,
the <span style="font-family:monospace">coq-tex</span> filter produces a file named <em>file</em><span style="font-family:monospace">.v.tex</span> with
the <span style="font-variant:small-caps">Coq</span> outcome.</p><p>There are options to produce the <span style="font-variant:small-caps">Coq</span> parts in smaller font, italic,
between horizontal rules, etc.
See the man page of <span style="font-family:monospace">coq-tex</span> for more details.</p><p><br>
<span style="font-weight:bold">Remark.</span> This Reference Manual and the Tutorial
have been completely produced with <span style="font-family:monospace">coq-tex</span>.</p><h2 id="Emacs" class="section">15.6  <span style="font-variant:small-caps">Coq</span> and <span style="font-variant:small-caps">GNU Emacs</span><a id="hevea_default1011"></a></h2>
<h3 id="sec703" class="subsection">15.6.1  The <span style="font-variant:small-caps">Coq</span> Emacs mode</h3>
<p><span style="font-variant:small-caps">Coq</span> comes with a Major mode for <span style="font-variant:small-caps">GNU Emacs</span>, <span style="font-family:monospace">gallina.el</span>. This mode provides
syntax highlighting
and also a rudimentary indentation facility
in the style of the Caml <span style="font-variant:small-caps">GNU Emacs</span> mode.</p><p>Add the following lines to your <code>.emacs</code> file:</p><pre class="verbatim">  (setq auto-mode-alist (cons '("\\.v$" . coq-mode) auto-mode-alist))
  (autoload 'coq-mode "gallina" "Major mode for editing Coq vernacular." t)
</pre><p>The <span style="font-variant:small-caps">Coq</span> major mode is triggered by visiting a file with extension <span style="font-family:monospace">.v</span>,
or manually with the command <code>M-x coq-mode</code>.
It gives you the correct syntax table for
the <span style="font-variant:small-caps">Coq</span> language, and also a rudimentary indentation facility:
</p><ul class="itemize"><li class="li-itemize">
pressing <span style="font-variant:small-caps">Tab</span> at the beginning of a line indents the line like
the line above;</li><li class="li-itemize">extra <span style="font-variant:small-caps">Tab</span>s increase the indentation level
(by 2 spaces by default);</li><li class="li-itemize">M-<span style="font-variant:small-caps">Tab</span> decreases the indentation level.
</li></ul><p>An inferior mode to run <span style="font-variant:small-caps">Coq</span> under Emacs, by Marco Maggesi, is also
included in the distribution, in file <span style="font-family:monospace">coq-inferior.el</span>.
Instructions to use it are contained in this file.</p><h3 id="sec704" class="subsection">15.6.2  <span style="font-variant:small-caps">Proof General</span><a id="hevea_default1012"></a></h3>
<p><span style="font-variant:small-caps">Proof General</span> is a generic interface for proof assistants based on
Emacs. The main idea is that the <span style="font-variant:small-caps">Coq</span> commands you are
editing are sent to a <span style="font-variant:small-caps">Coq</span> toplevel running behind Emacs and the
answers of the system automatically inserted into other Emacs buffers.
Thus you don’t need to copy-paste the <span style="font-variant:small-caps">Coq</span> material from your files
to the <span style="font-variant:small-caps">Coq</span> toplevel or conversely from the <span style="font-variant:small-caps">Coq</span> toplevel to some
files.</p><p><span style="font-variant:small-caps">Proof General</span> is developed and distributed independently of the
system <span style="font-variant:small-caps">Coq</span>. It is freely available at <code>https://proofgeneral.github.io/</code>.</p><h2 id="gallina" class="section">15.7  Module specification<a id="hevea_default1013"></a></h2>
<p>Given a <span style="font-variant:small-caps">Coq</span> vernacular file, the <span style="font-family:monospace">gallina</span> filter extracts its
specification (inductive types declarations, definitions, type of
lemmas and theorems), removing the proofs parts of the file. The <span style="font-variant:small-caps">Coq</span>
file <em>file</em><span style="font-family:monospace">.v</span> gives birth to the specification file
<em>file</em><span style="font-family:monospace">.g</span> (where the suffix <span style="font-family:monospace">.g</span> stands for <span style="font-variant:small-caps">Gallina</span>).</p><p>See the man page of <span style="font-family:monospace">gallina</span> for more details and options.</p><h2 id="ManPages" class="section">15.8  Man pages<a id="hevea_default1014"></a></h2>
<p>There are man pages for the commands <span style="font-family:monospace">coqdep</span>, <span style="font-family:monospace">gallina</span> and
<span style="font-family:monospace">coq-tex</span>. Man pages are installed at installation time
(see installation instructions in file <span style="font-family:monospace">INSTALL</span>, step 6).</p>
<div id="sidebarWrapper">
  <div id="sidebar">
    <div class="block">
      <h2 class="title">Navigation</h2>
      <div class="content">
        <ul class="menu">
          <li class="leaf"><a href="index.html">Cover</a></li>
          <li class="leaf"><a href="toc.html">Table of contents</a></li>
          <li class="leaf">Index
            <ul class="menu">
              <li><a href="general-index.html">General</a></li>
              <li><a href="command-index.html">Commands</a></li>
              <li><a href="option-index.html">Options</a></li>
              <li><a href="tactic-index.html">Tactics</a></li>
              <li><a href="error-index.html">Errors</a></li>
            </ul>
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

</div>

<div id="footer">
<div id="nav-footer">
  <ul class="links-menu-footer">
    <li><a href="mailto:coq-www_@_inria.fr">webmaster</a></li>
    <li><a href="http://validator.w3.org/">xhtml valid</a></li>
    <li><a href="http://jigsaw.w3.org/css-validator/">CSS valid</a></li>
  </ul>

</div>
</div>

</div>
</body>
</html>
