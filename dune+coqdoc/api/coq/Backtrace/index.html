<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Backtrace (coq.Backtrace)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">coq</a> &#x00BB; Backtrace</nav><h1>Module <code>Backtrace</code></h1><p>* Low-level management of OCaml backtraces.</p><p>Currently, OCaml manages its backtraces in a very imperative way. That is to say, it only keeps track of the stack destroyed by the last raised exception. So we have to be very careful when using this module not to do silly things.</p><p>Basically, you need to manually handle the reraising of exceptions. In order to do so, each time the backtrace is lost, you must <code>push</code> the stack fragment. This essentially occurs whenever a <code>with</code> handler is crossed.</p><nav class="toc"><ul><li><a href="#backtrace-information">Backtrace information</a></li><li><a href="#utilities">Utilities</a></li><li><a href="#exception-handling">Exception handling</a></li></ul></nav></header><section><header><h4 id="backtrace-information"><a href="#backtrace-information" class="anchor"></a>Backtrace information</h4></header><dl><dt class="spec type" id="type-location"><a href="#type-location" class="anchor"></a><code><span class="keyword">type </span>location</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-location.loc_filename" class="anchored"><td class="def field"><a href="#type-location.loc_filename" class="anchor"></a><code>loc_filename : string;</code></td></tr><tr id="type-location.loc_line" class="anchored"><td class="def field"><a href="#type-location.loc_line" class="anchor"></a><code>loc_line : int;</code></td></tr><tr id="type-location.loc_start" class="anchored"><td class="def field"><a href="#type-location.loc_start" class="anchor"></a><code>loc_start : int;</code></td></tr><tr id="type-location.loc_end" class="anchored"><td class="def field"><a href="#type-location.loc_end" class="anchor"></a><code>loc_end : int;</code></td></tr></table><code>}</code></dt><dd><p>OCaml debugging information for function calls.</p></dd></dl><dl><dt class="spec type" id="type-frame"><a href="#type-frame" class="anchor"></a><code><span class="keyword">type </span>frame</code><code><span class="keyword"> = </span></code><code>{</code><table class="record"><tr id="type-frame.frame_location" class="anchored"><td class="def field"><a href="#type-frame.frame_location" class="anchor"></a><code>frame_location : <a href="index.html#type-location">location</a> option;</code></td></tr><tr id="type-frame.frame_raised" class="anchored"><td class="def field"><a href="#type-frame.frame_raised" class="anchor"></a><code>frame_raised : bool;</code></td></tr></table><code>}</code></dt><dd><p>A frame contains two informations: its optional physical location, and whether it raised the exception or let it pass through.</p></dd></dl><dl><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type </span>t</code></dt><dd><p>Type of backtraces. They're essentially stack of frames.</p></dd></dl><dl><dt class="spec value" id="val-empty"><a href="#val-empty" class="anchor"></a><code><span class="keyword">val </span>empty : <a href="index.html#type-t">t</a></code></dt><dd><p>Empty frame stack.</p></dd></dl><dl><dt class="spec value" id="val-push"><a href="#val-push" class="anchor"></a><code><span class="keyword">val </span>push : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a></code></dt><dd><p>Add the current backtrace information to a given backtrace.</p></dd></dl><dl><dt class="spec value" id="val-repr"><a href="#val-repr" class="anchor"></a><code><span class="keyword">val </span>repr : <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> <a href="index.html#type-frame">frame</a> list</code></dt><dd><p>Represent a backtrace as a list of frames. Leftmost element is the outermost call.</p></dd></dl></section><section><header><h4 id="utilities"><a href="#utilities" class="anchor"></a>Utilities</h4></header><dl><dt class="spec value" id="val-print_frame"><a href="#val-print_frame" class="anchor"></a><code><span class="keyword">val </span>print_frame : <a href="index.html#type-frame">frame</a> <span>&#45;&gt;</span> string</code></dt><dd><p>Represent a frame.</p></dd></dl></section><section><header><h4 id="exception-handling"><a href="#exception-handling" class="anchor"></a>Exception handling</h4></header><dl><dt class="spec value" id="val-record_backtrace"><a href="#val-record_backtrace" class="anchor"></a><code><span class="keyword">val </span>record_backtrace : bool <span>&#45;&gt;</span> unit</code></dt><dd><p>Whether to activate the backtrace recording mechanism. Note that it will only work whenever the program was compiled with the <code>debug</code> flag.</p></dd></dl><dl><dt class="spec value" id="val-get_backtrace"><a href="#val-get_backtrace" class="anchor"></a><code><span class="keyword">val </span>get_backtrace : <a href="../Exninfo/index.html#type-info">Exninfo.info</a> <span>&#45;&gt;</span> <a href="index.html#type-t">t</a> option</code></dt><dd><p>Retrieve the optional backtrace coming with the exception.</p></dd></dl><dl><dt class="spec value" id="val-add_backtrace"><a href="#val-add_backtrace" class="anchor"></a><code><span class="keyword">val </span>add_backtrace : exn <span>&#45;&gt;</span> <a href="../Exninfo/index.html#type-iexn">Exninfo.iexn</a></code></dt><dt class="spec value" id="val-app_backtrace"><a href="#val-app_backtrace" class="anchor"></a><code><span class="keyword">val </span>app_backtrace : src:<a href="../Exninfo/index.html#type-info">Exninfo.info</a> <span>&#45;&gt;</span> dst:<a href="../Exninfo/index.html#type-info">Exninfo.info</a> <span>&#45;&gt;</span> <a href="../Exninfo/index.html#type-info">Exninfo.info</a></code></dt><dd><p>Append the backtrace from <code>src</code> to <code>dst</code>. The returned exception is <code>dst</code> except for its backtrace information. This is targeted at container exceptions, that is, exceptions that contain exceptions. This way, one can transfer the backtrace from the container to the underlying exception, as if the latter was the one originally raised.</p></dd></dl></section></div></body></html>