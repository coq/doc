<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Standard Library | The Coq Proof Assistant</title>

<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<style type="text/css" media="all">@import "/modules/node/node.css";</style>

<style type="text/css" media="all">@import "/modules/system/defaults.css";</style>
<style type="text/css" media="all">@import "/modules/system/system.css";</style>
<style type="text/css" media="all">@import "/modules/user/user.css";</style>

<style type="text/css" media="all">@import "/sites/all/themes/coq/style.css";</style>
<style type="text/css" media="all">@import "/sites/all/themes/coq/coqdoc.css";</style>

</head>

<body>

<div id="container">
<div id="headertop">
<div id="nav">
  <ul class="links-menu">
    <li><a href="http://coq.inria.fr/" class="active">Home</a></li>
    
    <li><a href="http://coq.inria.fr/about-coq" title="More about coq">About Coq</a></li>    
    <li><a href="http://coq.inria.fr/download">Get Coq</a></li>
    <li><a href="http://coq.inria.fr/documentation">Documentation</a></li>
    <li><a href="http://coq.inria.fr/community">Community</a></li>
  </ul>
</div>
</div>

<div id="header">

<div id="logoWrapper">

<div id="logo"><a href="http://coq.inria.fr/" title="Home"><img src="/files/barron_logo.png" alt="Home" /></a>
</div>
<div id="siteName"><a href="http://coq.inria.fr/" title="Home">The Coq Proof Assistant</a>
</div>

</div>
</div>

<div id="content">

<h1 class="libtitle">Library Coq.setoid_ring.Ring_tac</h1>

<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.Setoids.Setoid.html#"><span class="id" type="library">Setoid</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.NArith.BinPos.html#"><span class="id" type="library">BinPos</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.setoid_ring.Ring_polynom.html#"><span class="id" type="library">Ring_polynom</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.setoid_ring.BinList.html#"><span class="id" type="library">BinList</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.setoid_ring.InitialRing.html#"><span class="id" type="library">InitialRing</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.quote.Quote.html#"><span class="id" type="library">Quote</span></a>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">compute_assertion</span> <span class="id" type="var">eqn</span> <span class="id" type="var">t'</span> <span class="id" type="var">t</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">nft</span> := <span class="id" type="var">eval</span> <span class="id" type="var">vm_compute</span> <span class="id" type="keyword">in</span> <span class="id" type="var">t</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">pose</span> (<span class="id" type="var">t'</span> := <span class="id" type="var">nft</span>);<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">eqn</span> : <span class="id" type="var">t</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">t'</span>);<br/>
&nbsp;&nbsp;[<span class="id" type="var">vm_cast_no_check</span> (<a class="idref" href="Coq.Init.Logic.html#refl_equal"><span class="id" type="abbreviation">refl_equal</span></a> <span class="id" type="var">t'</span>)|<span class="id" type="var">idtac</span>].<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">relation_carrier</span> <span class="id" type="var">req</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">ty</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">req</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">eval</span> <span class="id" type="var">hnf</span> <span class="id" type="keyword">in</span> <span class="id" type="var">ty</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;?<span class="id" type="var">R</span> -&gt; <span class="id" type="var">_</span> =&gt; <span class="id" type="var">R</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> 1000 "Equality has no relation type"<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">Get_goal</span> := <span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span> [|- ?<span class="id" type="var">G</span>] =&gt; <span class="id" type="var">G</span> <span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">OnEquation</span> <span class="id" type="var">req</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| |- <span class="id" type="var">req</span> ?<span class="id" type="var">lhs</span> ?<span class="id" type="var">rhs</span> =&gt; (<span class="id" type="keyword">fun</span> <span class="id" type="var">f</span> =&gt; <span class="id" type="var">f</span> <span class="id" type="var">lhs</span> <span class="id" type="var">rhs</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> "Goal is not an equation (of expected equality)")<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">OnEquationHyp</span> <span class="id" type="var">req</span> <span class="id" type="var">h</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">h</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">req</span> ?<span class="id" type="var">lhs</span> ?<span class="id" type="var">rhs</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">f</span> =&gt; <span class="id" type="var">f</span> <span class="id" type="var">lhs</span> <span class="id" type="var">rhs</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> "Hypothesis is not an equation (of expected equality)")<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">OnMainSubgoal</span> <span class="id" type="var">H</span> <span class="id" type="var">ty</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">ty</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> -&gt; ?<span class="id" type="var">ty'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">subtac</span> := <span class="id" type="var">OnMainSubgoal</span> <span class="id" type="var">H</span> <span class="id" type="var">ty'</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">kont</span> =&gt; <span class="id" type="var">lapply</span> <span class="id" type="var">H</span>; [<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="var">subtac</span> <span class="id" type="var">kont</span> | <span class="id" type="var">idtac</span>]<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; (<span class="id" type="keyword">fun</span> <span class="id" type="var">kont</span> =&gt; <span class="id" type="var">kont</span>())<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">ProveLemmaHyp</span> <span class="id" type="var">lemma</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">lemma</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">x'</span>, ?<span class="id" type="var">x</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">x'</span> -&gt; <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">kont</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">x'</span> := <span class="id" type="tactic">fresh</span> "res" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> "res_eq" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">compute_assertion</span> <span class="id" type="var">H</span> <span class="id" type="var">x'</span> <span class="id" type="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lemma'</span> := <span class="id" type="var">constr</span>:(<span class="id" type="var">lemma</span> <span class="id" type="var">x'</span> <span class="id" type="var">H</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">kont</span> <span class="id" type="var">lemma'</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>||<span class="id" type="var">idtac</span>"ProveLemmaHyp: cleanup failed");<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; (<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> "ProveLemmaHyp: lemma not of the expected form")<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">ProveLemmaHyps</span> <span class="id" type="var">lemma</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">lemma</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">forall</span> <span class="id" type="var">x'</span>, ?<span class="id" type="var">x</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">x'</span> -&gt; <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">kont</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">x'</span> := <span class="id" type="tactic">fresh</span> "res" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> "res_eq" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">compute_assertion</span> <span class="id" type="var">H</span> <span class="id" type="var">x'</span> <span class="id" type="var">x</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lemma'</span> := <span class="id" type="var">constr</span>:(<span class="id" type="var">lemma</span> <span class="id" type="var">x'</span> <span class="id" type="var">H</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ProveLemmaHyps</span> <span class="id" type="var">lemma'</span> <span class="id" type="var">kont</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>||<span class="id" type="var">idtac</span>"ProveLemmaHyps: cleanup failed");<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">x'</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; (<span class="id" type="keyword">fun</span> <span class="id" type="var">kont</span> =&gt; <span class="id" type="var">kont</span> <span class="id" type="var">lemma</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">ApplyLemmaThen</span> <span class="id" type="var">lemma</span> <span class="id" type="var">expr</span> <span class="id" type="var">kont</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lem</span> := <span class="id" type="var">constr</span>:(<span class="id" type="var">lemma</span> <span class="id" type="var">expr</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">ProveLemmaHyp</span> <span class="id" type="var">lem</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">lem'</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">Heq</span> := <span class="id" type="tactic">fresh</span> "thm" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Heq</span>:=<span class="id" type="var">lem'</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">OnMainSubgoal</span> <span class="id" type="var">Heq</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">Heq</span>) <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">kont</span> <span class="id" type="var">Heq</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">clear</span> <span class="id" type="var">Heq</span>||<span class="id" type="var">idtac</span>"ApplyLemmaThen: cleanup failed")).<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">ApplyLemmaThenAndCont</span> <span class="id" type="var">lemma</span> <span class="id" type="var">expr</span> <span class="id" type="var">tac</span> <span class="id" type="var">CONT_tac</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">ApplyLemmaThen</span> <span class="id" type="var">lemma</span> <span class="id" type="var">expr</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">lemma'</span> =&gt; <span class="id" type="tactic">try</span> <span class="id" type="var">tac</span> <span class="id" type="var">lemma'</span>; <span class="id" type="var">CONT_tac</span>()).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">ReflexiveRewriteTactic</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">FV_tac</span> <span class="id" type="var">SYN_tac</span> <span class="id" type="var">LEMMA_tac</span> <span class="id" type="var">MAIN_tac</span> <span class="id" type="var">fv</span> <span class="id" type="var">terms</span> :=<br/>
&nbsp;&nbsp;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">list_fold_left</span> <span class="id" type="var">FV_tac</span> <span class="id" type="var">fv</span> <span class="id" type="var">terms</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">RW_tac</span> <span class="id" type="var">lemma</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fcons</span> <span class="id" type="var">term</span> <span class="id" type="var">CONT_tac</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">expr</span> := <span class="id" type="var">SYN_tac</span> <span class="id" type="var">term</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">main</span> <span class="id" type="var">H</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (?<span class="id" type="var">req</span> <span class="id" type="var">_</span> ?<span class="id" type="var">rhs</span>) =&gt; <span class="id" type="var">change</span> (<span class="id" type="var">req</span> <span class="id" type="var">term</span> <span class="id" type="var">rhs</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">H</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">MAIN_tac</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">ApplyLemmaThenAndCont</span> <span class="id" type="var">lemma</span> <span class="id" type="var">expr</span> <span class="id" type="var">main</span> <span class="id" type="var">CONT_tac</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">lazy_list_fold_right</span> <span class="id" type="var">fcons</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span>=&gt;<span class="id" type="var">idtac</span>) <span class="id" type="var">terms</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">LEMMA_tac</span> <span class="id" type="var">fv</span> <span class="id" type="var">RW_tac</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">FV_hypo_tac</span> <span class="id" type="var">mkFV</span> <span class="id" type="var">req</span> <span class="id" type="var">lH</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">R</span> := <span class="id" type="var">relation_carrier</span> <span class="id" type="var">req</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">FV_hypo_l_tac</span> <span class="id" type="var">h</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">h</span> <span class="id" type="keyword">with</span> @<a class="idref" href="Coq.setoid_ring.InitialRing.html#mkhypo"><span class="id" type="constructor">mkhypo</span></a> (<span class="id" type="var">req</span> ?<span class="id" type="var">pe</span> <span class="id" type="var">_</span>) <span class="id" type="var">_</span> =&gt; <span class="id" type="var">mkFV</span> <span class="id" type="var">pe</span> <span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">FV_hypo_r_tac</span> <span class="id" type="var">h</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">h</span> <span class="id" type="keyword">with</span> @<a class="idref" href="Coq.setoid_ring.InitialRing.html#mkhypo"><span class="id" type="constructor">mkhypo</span></a> (<span class="id" type="var">req</span> <span class="id" type="var">_</span> ?<span class="id" type="var">pe</span>) <span class="id" type="var">_</span> =&gt; <span class="id" type="var">mkFV</span> <span class="id" type="var">pe</span> <span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">list_fold_right</span> <span class="id" type="var">FV_hypo_l_tac</span> (@<a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <span class="id" type="var">R</span>) <span class="id" type="var">lH</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">list_fold_right</span> <span class="id" type="var">FV_hypo_r_tac</span> <span class="id" type="var">fv</span> <span class="id" type="var">lH</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">mkHyp_tac</span> <span class="id" type="var">C</span> <span class="id" type="var">req</span> <span class="id" type="var">Reify</span> <span class="id" type="var">lH</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkHyp</span> <span class="id" type="var">h</span> <span class="id" type="var">res</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">h</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;| @<a class="idref" href="Coq.setoid_ring.InitialRing.html#mkhypo"><span class="id" type="constructor">mkhypo</span></a> (<span class="id" type="var">req</span> ?<span class="id" type="var">r1</span> ?<span class="id" type="var">r2</span>) <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">pe1</span> := <span class="id" type="var">Reify</span> <span class="id" type="var">r1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">pe2</span> := <span class="id" type="var">Reify</span> <span class="id" type="var">r2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">pe1</span><a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">pe2</span><a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a> <span class="id" type="var">res</span>)<br/>
&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> 1 "hypothesis is not a ring equality"<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">list_fold_right</span> <span class="id" type="var">mkHyp</span> (@<a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> (<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PExpr"><span class="id" type="inductive">PExpr</span></a> <span class="id" type="var">C</span> <a class="idref" href="Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">*</span></a> <a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PExpr"><span class="id" type="inductive">PExpr</span></a> <span class="id" type="var">C</span>)) <span class="id" type="var">lH</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">proofHyp_tac</span> <span class="id" type="var">lH</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">get_proof</span> <span class="id" type="var">h</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">h</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| @<a class="idref" href="Coq.setoid_ring.InitialRing.html#mkhypo"><span class="id" type="constructor">mkhypo</span></a> <span class="id" type="var">_</span> ?<span class="id" type="var">p</span> =&gt; <span class="id" type="var">p</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">rec</span> <span class="id" type="var">bh</span> <span class="id" type="var">l</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">l</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.Init.Logic.html#I"><span class="id" type="constructor">I</span></a>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> ?<span class="id" type="var">h</span> <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="var">get_proof</span> <span class="id" type="var">h</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#cons"><span class="id" type="constructor">cons</span></a> ?<span class="id" type="var">h</span> ?<span class="id" type="var">tl</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l</span> := <span class="id" type="var">get_proof</span> <span class="id" type="var">h</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">r</span> := <span class="id" type="var">bh</span> <span class="id" type="var">tl</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.Init.Logic.html#conj"><span class="id" type="constructor">conj</span></a> <span class="id" type="var">l</span> <span class="id" type="var">r</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">bh</span> <span class="id" type="var">lH</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_MonPol</span> <span class="id" type="var">lemma</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">lemma</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">context</span> [(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#mk_monpol_list"><span class="id" type="definition">mk_monpol_list</span></a> ?<span class="id" type="var">cO</span> ?<span class="id" type="var">cI</span> ?<span class="id" type="var">cadd</span> ?<span class="id" type="var">cmul</span> ?<span class="id" type="var">csub</span> ?<span class="id" type="var">copp</span> ?<span class="id" type="var">cdiv</span> ?<span class="id" type="var">ceqb</span> <span class="id" type="var">_</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#mk_monpol_list"><span class="id" type="definition">mk_monpol_list</span></a> <span class="id" type="var">cO</span> <span class="id" type="var">cI</span> <span class="id" type="var">cadd</span> <span class="id" type="var">cmul</span> <span class="id" type="var">csub</span> <span class="id" type="var">copp</span> <span class="id" type="var">cdiv</span> <span class="id" type="var">ceqb</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> 1 "ring/field anomaly: bad correctness lemma (get_MonPol)"<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">FV</span> <span class="id" type="var">Cst</span> <span class="id" type="var">CstPow</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">pow</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span> :=<br/>
&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">rec</span> <span class="id" type="var">TFV</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">f</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">Cst</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.setoid_ring.InitialRing.html#NotConstant"><span class="id" type="definition">NotConstant</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">add</span> ?<span class="id" type="var">t1</span> ?<span class="id" type="var">t2</span>) =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">TFV</span> <span class="id" type="var">t2</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">TFV</span> <span class="id" type="var">t1</span> <span class="id" type="var">fv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">mul</span> ?<span class="id" type="var">t1</span> ?<span class="id" type="var">t2</span>) =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">TFV</span> <span class="id" type="var">t2</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">TFV</span> <span class="id" type="var">t1</span> <span class="id" type="var">fv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">sub</span> ?<span class="id" type="var">t1</span> ?<span class="id" type="var">t2</span>) =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">TFV</span> <span class="id" type="var">t2</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">TFV</span> <span class="id" type="var">t1</span> <span class="id" type="var">fv</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">opp</span> ?<span class="id" type="var">t1</span>) =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">TFV</span> <span class="id" type="var">t1</span> <span class="id" type="var">fv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">pow</span> ?<span class="id" type="var">t1</span> ?<span class="id" type="var">n</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">CstPow</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.setoid_ring.InitialRing.html#NotConstant"><span class="id" type="definition">InitialRing.NotConstant</span></a> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">AddFvTail</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">TFV</span> <span class="id" type="var">t1</span> <span class="id" type="var">fv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">AddFvTail</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">fv</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">f</span>()<br/>
&nbsp;<span class="id" type="keyword">in</span> <span class="id" type="var">TFV</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">mkPolexpr</span> <span class="id" type="var">C</span> <span class="id" type="var">Cst</span> <span class="id" type="var">CstPow</span> <span class="id" type="var">radd</span> <span class="id" type="var">rmul</span> <span class="id" type="var">rsub</span> <span class="id" type="var">ropp</span> <span class="id" type="var">rpow</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span> :=<br/>
&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">rec</span> <span class="id" type="var">mkP</span> <span class="id" type="var">t</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">f</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">Cst</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.setoid_ring.InitialRing.html#NotConstant"><span class="id" type="definition">InitialRing.NotConstant</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">t</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">radd</span> ?<span class="id" type="var">t1</span> ?<span class="id" type="var">t2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">mkP</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e2</span> := <span class="id" type="var">mkP</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEadd"><span class="id" type="constructor">PEadd</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">rmul</span> ?<span class="id" type="var">t1</span> ?<span class="id" type="var">t2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">mkP</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e2</span> := <span class="id" type="var">mkP</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEmul"><span class="id" type="constructor">PEmul</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">rsub</span> ?<span class="id" type="var">t1</span> ?<span class="id" type="var">t2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">mkP</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e2</span> := <span class="id" type="var">mkP</span> <span class="id" type="var">t2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEsub"><span class="id" type="constructor">PEsub</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">ropp</span> ?<span class="id" type="var">t1</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">mkP</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEopp"><span class="id" type="constructor">PEopp</span></a> <span class="id" type="var">e1</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">rpow</span> ?<span class="id" type="var">t1</span> ?<span class="id" type="var">n</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">CstPow</span> <span class="id" type="var">n</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.setoid_ring.InitialRing.html#NotConstant"><span class="id" type="definition">InitialRing.NotConstant</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">p</span> := <span class="id" type="var">Find_at</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span> <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEX"><span class="id" type="constructor">PEX</span></a> <span class="id" type="var">C</span> <span class="id" type="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">c</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">mkP</span> <span class="id" type="var">t1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEpow"><span class="id" type="constructor">PEpow</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">p</span> := <span class="id" type="var">Find_at</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span> <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEX"><span class="id" type="constructor">PEX</span></a> <span class="id" type="var">C</span> <span class="id" type="var">p</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">c</span> =&gt; <span class="id" type="keyword">fun</span> <span class="id" type="var">_</span> =&gt; <span class="id" type="var">constr</span>:(@<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEc"><span class="id" type="constructor">PEc</span></a> <span class="id" type="var">C</span> <span class="id" type="var">c</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">f</span> ()<br/>
&nbsp;<span class="id" type="keyword">in</span> <span class="id" type="var">mkP</span> <span class="id" type="var">t</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">PackRing</span> <span class="id" type="var">F</span> <span class="id" type="var">req</span> <span class="id" type="var">sth</span> <span class="id" type="var">ext</span> <span class="id" type="var">morph</span> <span class="id" type="var">arth</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">lemma1</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">context</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[@<a class="idref" href="Coq.setoid_ring.Ring_polynom.html#PEeval"><span class="id" type="definition">PEeval</span></a> ?<span class="id" type="var">R</span> ?<span class="id" type="var">rO</span> ?<span class="id" type="var">add</span> ?<span class="id" type="var">mul</span> ?<span class="id" type="var">sub</span> ?<span class="id" type="var">opp</span> ?<span class="id" type="var">C</span> ?<span class="id" type="var">phi</span> ?<span class="id" type="var">Cpow</span> ?<span class="id" type="var">powphi</span> ?<span class="id" type="var">pow</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">fun</span> <span class="id" type="var">proj</span> =&gt; <span class="id" type="var">proj</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> 1 "field anomaly: bad correctness lemma (parse)"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">F</span> <span class="id" type="var">RNG</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_Carrier</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_Eq</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">req</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_Pre</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pre</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_Post</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">post</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_NormLemma</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">lemma1</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_SimplifyLemma</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">lemma2</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_RingFV</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">FV</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">pow</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_RingMeta</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">mkPolexpr</span> <span class="id" type="var">C</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">pow</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_RingHypTac</span> <span class="id" type="var">RNG</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">RNG</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">pre</span> <span class="id" type="var">post</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">R</span> <span class="id" type="var">req</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">C</span> <span class="id" type="var">Cpow</span> <span class="id" type="var">powphi</span> <span class="id" type="var">pow</span> <span class="id" type="var">lemma1</span> <span class="id" type="var">lemma2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkPol</span> := <span class="id" type="var">mkPolexpr</span> <span class="id" type="var">C</span> <span class="id" type="var">cst_tac</span> <span class="id" type="var">pow_tac</span> <span class="id" type="var">add</span> <span class="id" type="var">mul</span> <span class="id" type="var">sub</span> <span class="id" type="var">opp</span> <span class="id" type="var">pow</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">fv</span> <span class="id" type="var">lH</span> =&gt; <span class="id" type="var">mkHyp_tac</span> <span class="id" type="var">C</span> <span class="id" type="var">req</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">t</span> =&gt; <span class="id" type="var">mkPol</span> <span class="id" type="var">t</span> <span class="id" type="var">fv</span>) <span class="id" type="var">lH</span>).<br/>

<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="ring_subst_niter"><span class="id" type="definition">ring_subst_niter</span></a> := (10<a class="idref" href="Coq.Init.Peano.html#:nat_scope:x_'*'_x"><span class="id" type="notation">*</span></a>10<a class="idref" href="Coq.Init.Peano.html#:nat_scope:x_'*'_x"><span class="id" type="notation">*</span></a>10)%<span class="id" type="var">nat</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">Ring</span> <span class="id" type="var">RNG</span> <span class="id" type="var">lemma</span> <span class="id" type="var">lH</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">req</span> := <span class="id" type="var">get_Eq</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">OnEquation</span> <span class="id" type="var">req</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">lhs</span> <span class="id" type="var">rhs</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkFV</span> := <span class="id" type="var">get_RingFV</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkPol</span> := <span class="id" type="var">get_RingMeta</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkHyp</span> := <span class="id" type="var">get_RingHypTac</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">FV_hypo_tac</span> <span class="id" type="var">mkFV</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">get_Eq</span> <span class="id" type="var">RNG</span>) <span class="id" type="var">lH</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">mkFV</span> <span class="id" type="var">lhs</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">mkFV</span> <span class="id" type="var">rhs</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">check_fv</span> <span class="id" type="var">fv</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">pe1</span> := <span class="id" type="var">mkPol</span> <span class="id" type="var">lhs</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">pe2</span> := <span class="id" type="var">mkPol</span> <span class="id" type="var">rhs</span> <span class="id" type="var">fv</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lpe</span> := <span class="id" type="var">mkHyp</span> <span class="id" type="var">fv</span> <span class="id" type="var">lH</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">vlpe</span> := <span class="id" type="tactic">fresh</span> "hyp_list" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">vfv</span> := <span class="id" type="tactic">fresh</span> "fv_list" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pose</span> (<span class="id" type="var">vlpe</span> := <span class="id" type="var">lpe</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pose</span> (<span class="id" type="var">vfv</span> := <span class="id" type="var">fv</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">apply</span> (<span class="id" type="var">lemma</span> <span class="id" type="var">vfv</span> <span class="id" type="var">vlpe</span> <span class="id" type="var">pe1</span> <span class="id" type="var">pe2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" type="tactic">fail</span> "typing error while applying ring");<br/>
&nbsp;&nbsp;&nbsp;&nbsp;[ ((<span class="id" type="keyword">let</span> <span class="id" type="var">prh</span> := <span class="id" type="var">proofHyp_tac</span> <span class="id" type="var">lH</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">exact</span> <span class="id" type="var">prh</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" type="var">idtac</span> "can not automatically proof hypothesis :";<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">idtac</span> " maybe a left member of a hypothesis is not a monomial")<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">vm_compute</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">exact</span> (<a class="idref" href="Coq.Init.Logic.html#refl_equal"><span class="id" type="abbreviation">refl_equal</span></a> <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a>) || <span class="id" type="tactic">fail</span> "not a valid ring equation")]).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">Ring_norm_gen</span> <span class="id" type="var">f</span> <span class="id" type="var">RNG</span> <span class="id" type="var">lemma</span> <span class="id" type="var">lH</span> <span class="id" type="var">rl</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkFV</span> := <span class="id" type="var">get_RingFV</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkPol</span> := <span class="id" type="var">get_RingMeta</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mkHyp</span> := <span class="id" type="var">get_RingHypTac</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mk_monpol</span> := <span class="id" type="var">get_MonPol</span> <span class="id" type="var">lemma</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">fv</span> := <span class="id" type="var">FV_hypo_tac</span> <span class="id" type="var">mkFV</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">get_Eq</span> <span class="id" type="var">RNG</span>) <span class="id" type="var">lH</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lemma_tac</span> <span class="id" type="var">fv</span> <span class="id" type="var">kont</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lpe</span> := <span class="id" type="var">mkHyp</span> <span class="id" type="var">fv</span> <span class="id" type="var">lH</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">vlpe</span> := <span class="id" type="tactic">fresh</span> "list_hyp" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">vlmp</span> := <span class="id" type="tactic">fresh</span> "list_hyp_norm" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">vlmp_eq</span> := <span class="id" type="tactic">fresh</span> "list_hyp_norm_eq" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">prh</span> := <span class="id" type="var">proofHyp_tac</span> <span class="id" type="var">lH</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">pose</span> (<span class="id" type="var">vlpe</span> := <span class="id" type="var">lpe</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">compute_assertion</span> <span class="id" type="var">vlmp_eq</span> <span class="id" type="var">vlmp</span> (<span class="id" type="var">mk_monpol</span> <span class="id" type="var">vlpe</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">H</span> := <span class="id" type="tactic">fresh</span> "ring_lemma" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">assert</span> (<span class="id" type="var">H</span> := <span class="id" type="var">lemma</span> <span class="id" type="var">vlpe</span> <span class="id" type="var">fv</span> <span class="id" type="var">prh</span> <span class="id" type="var">vlmp</span> <span class="id" type="var">vlmp_eq</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|| <span class="id" type="tactic">fail</span> "type error when build the rewriting lemma");<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">vlmp_eq</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">kont</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>||<span class="id" type="var">idtac</span>"Ring_norm_gen: cleanup failed");<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">subst</span> <span class="id" type="var">vlpe</span> <span class="id" type="var">vlmp</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">simpl_ring</span> <span class="id" type="var">H</span> := (<span class="id" type="var">protect_fv</span> "ring" <span class="id" type="keyword">in</span> <span class="id" type="var">H</span>; <span class="id" type="var">f</span> <span class="id" type="var">H</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">ReflexiveRewriteTactic</span> <span class="id" type="var">mkFV</span> <span class="id" type="var">mkPol</span> <span class="id" type="var">lemma_tac</span> <span class="id" type="var">simpl_ring</span> <span class="id" type="var">fv</span> <span class="id" type="var">rl</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">Ring_gen</span> <span class="id" type="var">RNG</span> <span class="id" type="var">lH</span> <span class="id" type="var">rl</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lemma</span> := <span class="id" type="var">get_NormLemma</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">get_Pre</span> <span class="id" type="var">RNG</span> ();<br/>
&nbsp;&nbsp;<span class="id" type="var">Ring</span> <span class="id" type="var">RNG</span> (<span class="id" type="var">lemma</span> <a class="idref" href="Coq.setoid_ring.Ring_tac.html#ring_subst_niter"><span class="id" type="definition">ring_subst_niter</span></a>) <span class="id" type="var">lH</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 0) "ring" :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">G</span> := <span class="id" type="var">Get_goal</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">ring_lookup</span> (<span class="id" type="var">PackRing</span> <span class="id" type="var">Ring_gen</span>) [] <span class="id" type="var">G</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 0) "ring" "[" <span class="id" type="var">constr_list</span>(<span class="id" type="var">lH</span>) "]" :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">G</span> := <span class="id" type="var">Get_goal</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">ring_lookup</span> (<span class="id" type="var">PackRing</span> <span class="id" type="var">Ring_gen</span>) [<span class="id" type="var">lH</span>] <span class="id" type="var">G</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">Ring_simplify_gen</span> <span class="id" type="var">f</span> <span class="id" type="var">RNG</span> <span class="id" type="var">lH</span> <span class="id" type="var">rl</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lemma</span> := <span class="id" type="var">get_SimplifyLemma</span> <span class="id" type="var">RNG</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l</span> := <span class="id" type="tactic">fresh</span> "to_rewrite" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">pose</span> (<span class="id" type="var">l</span>:= <span class="id" type="var">rl</span>);<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> (<a class="idref" href="Coq.Init.Logic.html#refl_equal"><span class="id" type="abbreviation">refl_equal</span></a> <span class="id" type="var">l</span>);<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">l</span> <span class="id" type="tactic">at</span> 2;<br/>
&nbsp;&nbsp;<span class="id" type="var">get_Pre</span> <span class="id" type="var">RNG</span> ();<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">rl</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| [|- <span class="id" type="var">l</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">RL</span> -&gt; <span class="id" type="var">_</span> ] =&gt; <span class="id" type="var">RL</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="tactic">fail</span> 1 "ring_simplify anomaly: bad goal after pre"<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">Heq</span> := <span class="id" type="tactic">fresh</span> "Heq" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Heq</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">Heq</span> <span class="id" type="var">l</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">Ring_norm_gen</span> <span class="id" type="var">f</span> <span class="id" type="var">RNG</span> (<span class="id" type="var">lemma</span> <a class="idref" href="Coq.setoid_ring.Ring_tac.html#ring_subst_niter"><span class="id" type="definition">ring_subst_niter</span></a>) <span class="id" type="var">lH</span> <span class="id" type="var">rl</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">get_Post</span> <span class="id" type="var">RNG</span> ().<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">Ring_simplify</span> := <span class="id" type="var">Ring_simplify_gen</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">H</span> =&gt; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">H</span>).<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 0) "ring_simplify" <span class="id" type="var">constr_list</span>(<span class="id" type="var">rl</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">G</span> := <span class="id" type="var">Get_goal</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">ring_lookup</span> (<span class="id" type="var">PackRing</span> <span class="id" type="var">Ring_simplify</span>) [] <span class="id" type="var">rl</span> <span class="id" type="var">G</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> (<span class="id" type="tactic">at</span> <span class="id" type="var">level</span> 0)<br/>
&nbsp;&nbsp;"ring_simplify" "[" <span class="id" type="var">constr_list</span>(<span class="id" type="var">lH</span>) "]" <span class="id" type="var">constr_list</span>(<span class="id" type="var">rl</span>) :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">G</span> := <span class="id" type="var">Get_goal</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">ring_lookup</span> (<span class="id" type="var">PackRing</span> <span class="id" type="var">Ring_simplify</span>) [<span class="id" type="var">lH</span>] <span class="id" type="var">rl</span> <span class="id" type="var">G</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span> "ring_simplify" <span class="id" type="var">constr_list</span>(<span class="id" type="var">rl</span>) "in" <span class="id" type="var">hyp</span>(<span class="id" type="var">H</span>):=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">G</span> := <span class="id" type="var">Get_goal</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">g</span> := <span class="id" type="tactic">fresh</span> "goal" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">g</span>:= <span class="id" type="var">G</span>);<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">ring_lookup</span> (<span class="id" type="var">PackRing</span> <span class="id" type="var">Ring_simplify</span>) [] <span class="id" type="var">rl</span> <span class="id" type="var">t</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">g</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">g</span>.<br/>

<br/>
<span class="id" type="keyword">Tactic Notation</span><br/>
&nbsp;&nbsp;"ring_simplify" "["<span class="id" type="var">constr_list</span>(<span class="id" type="var">lH</span>)"]" <span class="id" type="var">constr_list</span>(<span class="id" type="var">rl</span>) "in" <span class="id" type="var">hyp</span>(<span class="id" type="var">H</span>):=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">G</span> := <span class="id" type="var">Get_goal</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <span class="id" type="var">type</span> <span class="id" type="var">of</span> <span class="id" type="var">H</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">g</span> := <span class="id" type="tactic">fresh</span> "goal" <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">g</span>:= <span class="id" type="var">G</span>);<br/>
&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="var">H</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="var">ring_lookup</span> (<span class="id" type="var">PackRing</span> <span class="id" type="var">Ring_simplify</span>) [<span class="id" type="var">lH</span>] <span class="id" type="var">rl</span> <span class="id" type="var">t</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>;<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">g</span>;<span class="id" type="tactic">clear</span> <span class="id" type="var">g</span>.<br/>

<br/>
</div>
<div id="sidebarWrapper">
<div id="sidebar">

<div class="block">
<h2 class="title">Navigation</h2>
<div class="content">

<ul class="menu">

<li class="leaf">Standard Library
  <ul class="menu">
  <li><a href="index.html">Table of contents</a></li>
  <li><a href="genindex.html">Index</a></li>
  </ul>
</li>

</ul>

</div>
</div>

</div>
</div>


</div>

<div id="footer">
<div id="nav-footer">
  <ul class="links-menu-footer">
    <li><a href="mailto:www-coq_@_lix.polytechnique.fr">webmaster</a></li>
    <li><a href="http://validator.w3.org/check?uri=referer">xhtml valid</a></li>
    <li><a href="http://jigsaw.w3.org/css-validator/check/referer">CSS valid</a></li>
  </ul>

</div>
</div>

</div>

</body>
</html>

