<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>Standard Library | The Coq Proof Assistant</title>

<link rel="shortcut icon" href="favicon.ico" type="image/x-icon" />
<style type="text/css" media="all">@import "/modules/node/node.css";</style>

<style type="text/css" media="all">@import "/modules/system/defaults.css";</style>
<style type="text/css" media="all">@import "/modules/system/system.css";</style>
<style type="text/css" media="all">@import "/modules/user/user.css";</style>

<style type="text/css" media="all">@import "/sites/all/themes/coq/style.css";</style>
<style type="text/css" media="all">@import "/sites/all/themes/coq/coqdoc.css";</style>

</head>

<body>

<div id="container">
<div id="headertop">
<div id="nav">
  <ul class="links-menu">
    <li><a href="http://coq.inria.fr/" class="active">Home</a></li>
    
    <li><a href="http://coq.inria.fr/about-coq" title="More about coq">About Coq</a></li>    
    <li><a href="http://coq.inria.fr/download">Get Coq</a></li>
    <li><a href="http://coq.inria.fr/documentation">Documentation</a></li>
    <li><a href="http://coq.inria.fr/community">Community</a></li>
  </ul>
</div>
</div>

<div id="header">

<div id="logoWrapper">

<div id="logo"><a href="http://coq.inria.fr/" title="Home"><img src="/files/barron_logo.png" alt="Home" /></a>
</div>
<div id="siteName"><a href="http://coq.inria.fr/" title="Home">The Coq Proof Assistant</a>
</div>

</div>
</div>

<div id="content">

<h1 class="libtitle">Library Coq.field.LegacyField_Tactic</h1>

<div class="code">

<br/>

<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.Lists.List.html#"><span class="id" type="library">List</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coq.ring.LegacyRing.html#"><span class="id" type="library">LegacyRing</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="Coq.field.LegacyField_Compl.html#"><span class="id" type="library">LegacyField_Compl</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Export</span> <a class="idref" href="Coq.field.LegacyField_Theory.html#"><span class="id" type="library">LegacyField_Theory</span></a>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">get_component</span> <span class="id" type="var">a</span> <span class="id" type="var">s</span> := <span class="id" type="var">eval</span> <span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">iota</span> <span class="id" type="var">delta</span> [<span class="id" type="var">a</span>] <span class="id" type="keyword">in</span> (<span class="id" type="var">a</span> <span class="id" type="var">s</span>).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">body_of</span> <span class="id" type="var">s</span> := <span class="id" type="var">eval</span> <span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">iota</span> <span class="id" type="var">delta</span> [<span class="id" type="var">s</span>] <span class="id" type="keyword">in</span> <span class="id" type="var">s</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">mem_assoc</span> <span class="id" type="var">var</span> <span class="id" type="var">lvar</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">lvar</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="var">constr</span>:<a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a><br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X2</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:(<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">var</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">constr</span>:<a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">mem_assoc</span> <span class="id" type="var">var</span> <span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">number</span> <span class="id" type="var">lvar</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">rec</span> <span class="id" type="var">number_aux</span> <span class="id" type="var">lvar</span> <span class="id" type="var">cpt</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">lvar</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (@<a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">constr</span>:(@<a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> (<a class="idref" href="Coq.Init.Datatypes.html#prod"><span class="id" type="inductive">prod</span></a> <span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">X2</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X3</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l2</span> := <span class="id" type="var">number_aux</span> <span class="id" type="var">X3</span> (<a class="idref" href="Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">cpt</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">X2</span><a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a><span class="id" type="var">cpt</span><a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">l2</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">in</span> <span class="id" type="var">number_aux</span> <span class="id" type="var">lvar</span> 0.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">build_varlist</span> <span class="id" type="var">FT</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">rec</span> <span class="id" type="var">seek_var</span> <span class="id" type="var">lvar</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">AT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">A</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AzeroT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Azero</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AoneT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aone</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AplusT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aplus</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AmultT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Amult</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AoppT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aopp</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AinvT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Ainv</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">AzeroT</span> =&gt; <span class="id" type="var">lvar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">AoneT</span> =&gt; <span class="id" type="var">lvar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">AplusT</span> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l1</span> := <span class="id" type="var">seek_var</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">seek_var</span> <span class="id" type="var">l1</span> <span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">AmultT</span> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l1</span> := <span class="id" type="var">seek_var</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">seek_var</span> <span class="id" type="var">l1</span> <span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">AoppT</span> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">seek_var</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| (<span class="id" type="var">AinvT</span> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">seek_var</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">res</span> := <span class="id" type="var">mem_assoc</span> <span class="id" type="var">X1</span> <span class="id" type="var">lvar</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">res</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> =&gt; <span class="id" type="var">lvar</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a> =&gt; <span class="id" type="var">constr</span>:(<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">lvar</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">AT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">A</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lvar</span> := <span class="id" type="var">seek_var</span> (@<a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <span class="id" type="var">AT</span>) <span class="id" type="var">trm</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">number</span> <span class="id" type="var">lvar</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">assoc</span> <span class="id" type="var">elt</span> <span class="id" type="var">lst</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">lst</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="tactic">fail</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(?</span></a><span class="id" type="var">X1</span><a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,?</span></a><span class="id" type="var">X2</span><a class="idref" href="Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">)</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X3</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:(<span class="id" type="var">elt</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">X1</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| (?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">constr</span>:<span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">assoc</span> <span class="id" type="var">elt</span> <span class="id" type="var">X3</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">AT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">A</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AzeroT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Azero</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AoneT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aone</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AplusT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aplus</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AmultT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Amult</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AoppT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aopp</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AinvT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Ainv</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">AzeroT</span> =&gt; <span class="id" type="var">constr</span>:<a class="idref" href="Coq.field.LegacyField_Theory.html#EAzero"><span class="id" type="constructor">EAzero</span></a><br/>
&nbsp;&nbsp;| <span class="id" type="var">AoneT</span> =&gt; <span class="id" type="var">constr</span>:<a class="idref" href="Coq.field.LegacyField_Theory.html#EAone"><span class="id" type="constructor">EAone</span></a><br/>
&nbsp;&nbsp;| (<span class="id" type="var">AplusT</span> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">e2</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAplus"><span class="id" type="constructor">EAplus</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;| (<span class="id" type="var">AmultT</span> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">e2</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;| (<span class="id" type="var">AoppT</span> ?<span class="id" type="var">X1</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAopp"><span class="id" type="constructor">EAopp</span></a> <span class="id" type="var">e</span>)<br/>
&nbsp;&nbsp;| (<span class="id" type="var">AinvT</span> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">e</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> <span class="id" type="var">e</span>)<br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">idx</span> := <span class="id" type="var">assoc</span> <span class="id" type="var">X1</span> <span class="id" type="var">lvar</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAvar"><span class="id" type="constructor">EAvar</span></a> <span class="id" type="var">idx</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">remove</span> <span class="id" type="var">e</span> <span class="id" type="var">l</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">l</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="var">l</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">e</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X2</span> =&gt; <span class="id" type="var">constr</span>:<span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X2</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X3</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">nl</span> := <span class="id" type="var">remove</span> <span class="id" type="var">e</span> <span class="id" type="var">X3</span> <span class="id" type="keyword">in</span> <span class="id" type="var">constr</span>:(<span class="id" type="var">X2</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">nl</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">union</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">l1</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="var">l2</span><br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X2</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X3</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">nl2</span> := <span class="id" type="var">remove</span> <span class="id" type="var">X2</span> <span class="id" type="var">l2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">nl</span> := <span class="id" type="var">union</span> <span class="id" type="var">X3</span> <span class="id" type="var">nl2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<span class="id" type="var">X2</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">nl</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">raw_give_mult</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">constr</span>:(<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a>)<br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAopp"><span class="id" type="constructor">EAopp</span></a> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">raw_give_mult</span> <span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAplus"><span class="id" type="constructor">EAplus</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l1</span> := <span class="id" type="var">raw_give_mult</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">l2</span> := <span class="id" type="var">raw_give_mult</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">union</span> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">l1</span> := <span class="id" type="var">raw_give_mult</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">l2</span> := <span class="id" type="var">raw_give_mult</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.Init.Datatypes.html#app"><span class="id" type="definition">app</span></a> <span class="id" type="var">l1</span> <span class="id" type="var">l2</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">constr</span>:(@<a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <a class="idref" href="Coq.field.LegacyField_Theory.html#ExprA"><span class="id" type="inductive">ExprA</span></a>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">give_mult</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">ltrm</span> := <span class="id" type="var">raw_give_mult</span> <span class="id" type="var">trm</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#mult_of_list"><span class="id" type="definition">mult_of_list</span></a> <span class="id" type="var">ltrm</span>).<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">apply_assoc</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#assoc"><span class="id" type="definition">assoc</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:(<span class="id" type="var">t</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- (<a class="idref" href="Coq.field.LegacyField_Theory.html#assoc_correct"><span class="id" type="lemma">assoc_correct</span></a> <span class="id" type="var">FT</span> <span class="id" type="var">trm</span>); <span class="id" type="var">change</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#assoc"><span class="id" type="definition">assoc</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">with</span> <span class="id" type="var">t</span> <span class="id" type="keyword">in</span> |- *<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">apply_distrib</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#distrib"><span class="id" type="definition">distrib</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:(<span class="id" type="var">t</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- (<a class="idref" href="Coq.field.LegacyField_Theory.html#distrib_correct"><span class="id" type="lemma">distrib_correct</span></a> <span class="id" type="var">FT</span> <span class="id" type="var">trm</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">change</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#distrib"><span class="id" type="definition">distrib</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">with</span> <span class="id" type="var">t</span> <span class="id" type="keyword">in</span> |- *<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">grep_mult</span> := <span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">id</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">&lt;&gt;</span></a> <span class="id" type="var">_</span>) |- <span class="id" type="var">_</span> =&gt; <span class="id" type="var">id</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">weak_reduce</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;|  |- <span class="id" type="var">context</span> [(<a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span> <span class="id" type="var">_</span>)] =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">iota</span> <span class="id" type="var">zeta</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">delta</span> [<span class="id" type="var">interp_ExprA</span> <span class="id" type="var">assoc_2nd</span> <span class="id" type="var">eq_nat_dec</span> <span class="id" type="var">mult_of_list</span> <span class="id" type="var">X1</span> <span class="id" type="var">X2</span> <span class="id" type="var">A</span> <span class="id" type="var">Azero</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Aone</span> <span class="id" type="var">Aplus</span> <span class="id" type="var">Amult</span> <span class="id" type="var">Aopp</span> <span class="id" type="var">Ainv</span>] <span class="id" type="keyword">in</span> |- *<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">multiply</span> <span class="id" type="var">mul</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;|  |- (<a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> ?<span class="id" type="var">FT</span> ?<span class="id" type="var">X2</span> ?<span class="id" type="var">X3</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> ?<span class="id" type="var">FT</span> ?<span class="id" type="var">X2</span> ?<span class="id" type="var">X4</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">AzeroT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Azero</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> <span class="id" type="var">FT</span> <span class="id" type="var">X2</span> <span class="id" type="var">mul</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">&lt;&gt;</span></a> <span class="id" type="var">AzeroT</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="tactic">intro</span>; (<span class="id" type="keyword">let</span> <span class="id" type="var">id</span> := <span class="id" type="var">grep_mult</span> <span class="id" type="keyword">in</span> <span class="id" type="tactic">apply</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#mult_eq"><span class="id" type="lemma">mult_eq</span></a> <span class="id" type="var">FT</span> <span class="id" type="var">X3</span> <span class="id" type="var">X4</span> <span class="id" type="var">mul</span> <span class="id" type="var">X2</span> <span class="id" type="var">id</span>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">weak_reduce</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">let</span> <span class="id" type="var">AoneT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aone</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">body_of</span> <span class="id" type="var">FT</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AmultT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Amult</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">body_of</span> <span class="id" type="var">FT</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;|  |- <span class="id" type="var">context</span> [(<span class="id" type="var">AmultT</span> <span class="id" type="var">_</span> <span class="id" type="var">AoneT</span>)] =&gt; <span class="id" type="tactic">rewrite</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#AmultT_1r"><span class="id" type="lemma">AmultT_1r</span></a> <span class="id" type="var">FT</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">FT</span> <span class="id" type="var">X2</span>) ]<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">apply_multiply</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#multiply"><span class="id" type="definition">multiply</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:(<span class="id" type="var">t</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- (<a class="idref" href="Coq.field.LegacyField_Theory.html#multiply_correct"><span class="id" type="lemma">multiply_correct</span></a> <span class="id" type="var">FT</span> <span class="id" type="var">trm</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">change</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#multiply"><span class="id" type="definition">multiply</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">with</span> <span class="id" type="var">t</span> <span class="id" type="keyword">in</span> |- *<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">apply_inverse</span> <span class="id" type="var">mul</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">t</span> := <span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#inverse_simplif"><span class="id" type="definition">inverse_simplif</span></a> <span class="id" type="var">mul</span> <span class="id" type="var">trm</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:(<span class="id" type="var">t</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- (<a class="idref" href="Coq.field.LegacyField_Theory.html#inverse_correct"><span class="id" type="lemma">inverse_correct</span></a> <span class="id" type="var">FT</span> <span class="id" type="var">trm</span> <span class="id" type="var">mul</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="var">change</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#inverse_simplif"><span class="id" type="definition">inverse_simplif</span></a> <span class="id" type="var">mul</span> <span class="id" type="var">trm</span>) <span class="id" type="keyword">with</span> <span class="id" type="var">t</span> <span class="id" type="keyword">in</span> |- * | <span class="id" type="tactic">assumption</span> ]<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">strong_fail</span> <span class="id" type="var">tac</span> := <span class="id" type="var">first</span> [ <span class="id" type="var">tac</span> | <span class="id" type="tactic">fail</span> 2 ].<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">inverse_test_aux</span> <span class="id" type="var">FT</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">AplusT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aplus</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AmultT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Amult</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AoppT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aopp</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AinvT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Ainv</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (<span class="id" type="var">AinvT</span> <span class="id" type="var">_</span>) =&gt; <span class="id" type="tactic">fail</span> 1<br/>
&nbsp;&nbsp;| (<span class="id" type="var">AoppT</span> ?<span class="id" type="var">X1</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">strong_fail</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">inverse_test_aux</span> <span class="id" type="var">FT</span> <span class="id" type="var">X1</span>; <span class="id" type="var">idtac</span>)<br/>
&nbsp;&nbsp;| (<span class="id" type="var">AplusT</span> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">strong_fail</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">inverse_test_aux</span> <span class="id" type="var">FT</span> <span class="id" type="var">X1</span>; <span class="id" type="var">inverse_test_aux</span> <span class="id" type="var">FT</span> <span class="id" type="var">X2</span>)<br/>
&nbsp;&nbsp;| (<span class="id" type="var">AmultT</span> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">strong_fail</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">inverse_test_aux</span> <span class="id" type="var">FT</span> <span class="id" type="var">X1</span>; <span class="id" type="var">inverse_test_aux</span> <span class="id" type="var">FT</span> <span class="id" type="var">X2</span>)<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">inverse_test</span> <span class="id" type="var">FT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">AplusT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aplus</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;|  |- (?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X2</span>) =&gt; <span class="id" type="var">inverse_test_aux</span> <span class="id" type="var">FT</span> (<span class="id" type="var">AplusT</span> <span class="id" type="var">X1</span> <span class="id" type="var">X2</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">apply_simplif</span> <span class="id" type="var">sfun</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;|  |- (<a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span> ?<span class="id" type="var">X3</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>) =&gt;<br/>
&nbsp;&nbsp;<span class="id" type="var">sfun</span> <span class="id" type="var">X1</span> <span class="id" type="var">X2</span> <span class="id" type="var">X3</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;|  |- (<a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span> ?<span class="id" type="var">X3</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">sfun</span> <span class="id" type="var">X1</span> <span class="id" type="var">X2</span> <span class="id" type="var">X3</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">unfolds</span> <span class="id" type="var">FT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">get_component</span> <span class="id" type="var">Aminus</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="tactic">unfold</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">in</span> |- *<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>;<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">get_component</span> <span class="id" type="var">Adiv</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="tactic">unfold</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">in</span> |- *<br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">idtac</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">reduce</span> <span class="id" type="var">FT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">AzeroT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Azero</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AoneT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aone</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AplusT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aplus</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AmultT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Amult</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AoppT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aopp</span> <span class="id" type="var">FT</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">AinvT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Ainv</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;(<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">iota</span> <span class="id" type="var">zeta</span> <span class="id" type="var">delta</span> -[<span class="id" type="var">AzeroT</span> <span class="id" type="var">AoneT</span> <span class="id" type="var">AplusT</span> <span class="id" type="var">AmultT</span> <span class="id" type="var">AoppT</span> <span class="id" type="var">AinvT</span>] <span class="id" type="keyword">in</span> |- * ||<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> |- *).<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">field_gen_aux</span> <span class="id" type="var">FT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">AplusT</span> := <span class="id" type="var">get_component</span> <span class="id" type="var">Aplus</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">goal</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;|  |- (?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lvar</span> := <span class="id" type="var">build_varlist</span> <span class="id" type="var">FT</span> (<span class="id" type="var">AplusT</span> <span class="id" type="var">X1</span> <span class="id" type="var">X2</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">trm1</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">trm2</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mul</span> := <span class="id" type="var">give_mult</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAplus"><span class="id" type="constructor">EAplus</span></a> <span class="id" type="var">trm1</span> <span class="id" type="var">trm2</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">let</span> <span class="id" type="var">ft</span> := <span class="id" type="var">FT</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">vm</span> := <span class="id" type="var">lvar</span> <span class="id" type="keyword">in</span> <a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> <span class="id" type="var">ft</span> <span class="id" type="var">vm</span> <span class="id" type="var">trm1</span> <a class="idref" href="Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> <span class="id" type="var">ft</span> <span class="id" type="var">vm</span> <span class="id" type="var">trm2</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> |- *; <span class="id" type="tactic">auto</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="tactic">intros</span> <span class="id" type="var">ft</span> <span class="id" type="var">vm</span>; <span class="id" type="var">apply_simplif</span> <span class="id" type="var">apply_distrib</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">apply_simplif</span> <span class="id" type="var">apply_assoc</span>; <span class="id" type="var">multiply</span> <span class="id" type="var">mul</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="var">apply_simplif</span> <span class="id" type="var">apply_multiply</span>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">apply_simplif</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">apply_inverse</span> <span class="id" type="var">mul</span>);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">let</span> <span class="id" type="var">id</span> := <span class="id" type="var">grep_mult</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">id</span>; <span class="id" type="var">weak_reduce</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">ft</span> <span class="id" type="var">vm</span>; <span class="id" type="var">first</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;[ <span class="id" type="var">inverse_test</span> <span class="id" type="var">FT</span>; <span class="id" type="var">legacy</span> <span class="id" type="tactic">ring</span> | <span class="id" type="var">field_gen_aux</span> <span class="id" type="var">FT</span> ])<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">idtac</span> ] ]<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">field_gen</span> <span class="id" type="var">FT</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">unfolds</span> <span class="id" type="var">FT</span>; (<span class="id" type="var">inverse_test</span> <span class="id" type="var">FT</span>; <span class="id" type="var">legacy</span> <span class="id" type="tactic">ring</span>) || <span class="id" type="var">field_gen_aux</span> <span class="id" type="var">FT</span>.<br/>

<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">init_exp</span> <span class="id" type="var">FT</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e</span> :=<br/>
&nbsp;&nbsp;&nbsp;(<span class="id" type="keyword">match</span> <span class="id" type="var">get_component</span> <span class="id" type="var">Aminus</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="var">eval</span> <span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">delta</span> [<span class="id" type="var">X1</span>] <span class="id" type="keyword">in</span> <span class="id" type="var">trm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">trm</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">get_component</span> <span class="id" type="var">Adiv</span> <span class="id" type="var">FT</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#Some"><span class="id" type="constructor">Some</span></a> ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="var">eval</span> <span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">delta</span> [<span class="id" type="var">X1</span>] <span class="id" type="keyword">in</span> <span class="id" type="var">e</span><br/>
&nbsp;&nbsp;| <span class="id" type="var">_</span> =&gt; <span class="id" type="var">e</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_inv</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAplus"><span class="id" type="constructor">EAplus</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">simpl_inv</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">e2</span> := <span class="id" type="var">simpl_inv</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAplus"><span class="id" type="constructor">EAplus</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">simpl_inv</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">e2</span> := <span class="id" type="var">simpl_inv</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAopp"><span class="id" type="constructor">EAopp</span></a> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">e</span> := <span class="id" type="var">simpl_inv</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAopp"><span class="id" type="constructor">EAopp</span></a> <span class="id" type="var">e</span>)<br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">SimplInvAux</span> <span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="var">constr</span>:<span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;<span class="id" type="keyword">with</span> <span class="id" type="var">SimplInvAux</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">simpl_inv</span> <span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">simpl_inv</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> <span class="id" type="var">X1</span>) <span class="id" type="keyword">with</span> <span class="id" type="var">e2</span> := <span class="id" type="var">simpl_inv</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> <span class="id" type="var">X2</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="keyword">let</span> <span class="id" type="var">e</span> := <span class="id" type="var">simpl_inv</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> <span class="id" type="var">e</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">map_tactic</span> <span class="id" type="var">fcn</span> <span class="id" type="var">lst</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">lst</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="var">lst</span><br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X2</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X3</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">r</span> := <span class="id" type="var">fcn</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">with</span> <span class="id" type="var">t</span> := <span class="id" type="var">map_tactic</span> <span class="id" type="var">fcn</span> <span class="id" type="var">X3</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<span class="id" type="var">r</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">t</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">build_monom_aux</span> <span class="id" type="var">lst</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">lst</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> =&gt; <span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#assoc"><span class="id" type="definition">assoc</span></a> <span class="id" type="var">trm</span>)<br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">?</span></a><span class="id" type="var">X2</span> =&gt; <span class="id" type="var">build_monom_aux</span> <span class="id" type="var">X2</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> <span class="id" type="var">trm</span> <span class="id" type="var">X1</span>)<br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">build_monom</span> <span class="id" type="var">lnum</span> <span class="id" type="var">lden</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">ildn</span> := <span class="id" type="var">map_tactic</span> <span class="id" type="var">ltac</span>:(<span class="id" type="keyword">fun</span> <span class="id" type="var">e</span> =&gt; <span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> <span class="id" type="var">e</span>)) <span class="id" type="var">lden</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">ltot</span> := <span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.Init.Datatypes.html#app"><span class="id" type="definition">app</span></a> <span class="id" type="var">lnum</span> <span class="id" type="var">ildn</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">trm</span> := <span class="id" type="var">build_monom_aux</span> <span class="id" type="var">ltot</span> <span class="id" type="var">EAone</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> <span class="id" type="var">_</span> ?<span class="id" type="var">X1</span>) =&gt; <span class="id" type="var">constr</span>:<span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="var">constr</span>:<span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_monom_aux</span> <span class="id" type="var">lnum</span> <span class="id" type="var">lden</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> ?<span class="id" type="var">X1</span>) ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mma</span> := <span class="id" type="var">mem_assoc</span> <span class="id" type="var">X1</span> <span class="id" type="var">lnum</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">mma</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">newlnum</span> := <span class="id" type="var">remove</span> <span class="id" type="var">X1</span> <span class="id" type="var">lnum</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpl_monom_aux</span> <span class="id" type="var">newlnum</span> <span class="id" type="var">lden</span> <span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a> =&gt; <span class="id" type="var">simpl_monom_aux</span> <span class="id" type="var">lnum</span> (<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">lden</span>) <span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAmult"><span class="id" type="constructor">EAmult</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mma</span> := <span class="id" type="var">mem_assoc</span> <span class="id" type="var">X1</span> <span class="id" type="var">lden</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">mma</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">newlden</span> := <span class="id" type="var">remove</span> <span class="id" type="var">X1</span> <span class="id" type="var">lden</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpl_monom_aux</span> <span class="id" type="var">lnum</span> <span class="id" type="var">newlden</span> <span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a> =&gt; <span class="id" type="var">simpl_monom_aux</span> (<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">lnum</span>) <span class="id" type="var">lden</span> <span class="id" type="var">X2</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAinv"><span class="id" type="constructor">EAinv</span></a> ?<span class="id" type="var">X1</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mma</span> := <span class="id" type="var">mem_assoc</span> <span class="id" type="var">X1</span> <span class="id" type="var">lnum</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">mma</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">newlnum</span> := <span class="id" type="var">remove</span> <span class="id" type="var">X1</span> <span class="id" type="var">lnum</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">build_monom</span> <span class="id" type="var">newlnum</span> <span class="id" type="var">lden</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a> =&gt; <span class="id" type="var">build_monom</span> <span class="id" type="var">lnum</span> (<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">lden</span>)<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">mma</span> := <span class="id" type="var">mem_assoc</span> <span class="id" type="var">X1</span> <span class="id" type="var">lden</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">mma</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#true"><span class="id" type="constructor">true</span></a> =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">newlden</span> := <span class="id" type="var">remove</span> <span class="id" type="var">X1</span> <span class="id" type="var">lden</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">build_monom</span> <span class="id" type="var">lnum</span> <span class="id" type="var">newlden</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;| <a class="idref" href="Coq.Init.Datatypes.html#false"><span class="id" type="constructor">false</span></a> =&gt; <span class="id" type="var">build_monom</span> (<span class="id" type="var">X1</span> <a class="idref" href="Coq.Init.Datatypes.html#:list_scope:x_'::'_x"><span class="id" type="notation">::</span></a> <span class="id" type="var">lnum</span>) <span class="id" type="var">lden</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">end</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_monom</span> <span class="id" type="var">trm</span> := <span class="id" type="var">simpl_monom_aux</span> (@<a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <a class="idref" href="Coq.field.LegacyField_Theory.html#ExprA"><span class="id" type="inductive">ExprA</span></a>) (@<a class="idref" href="Coq.Init.Datatypes.html#nil"><span class="id" type="constructor">nil</span></a> <a class="idref" href="Coq.field.LegacyField_Theory.html#ExprA"><span class="id" type="inductive">ExprA</span></a>) <span class="id" type="var">trm</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">simpl_all_monomials</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">match</span> <span class="id" type="var">constr</span>:<span class="id" type="var">trm</span> <span class="id" type="keyword">with</span><br/>
&nbsp;&nbsp;| (<a class="idref" href="Coq.field.LegacyField_Theory.html#EAplus"><span class="id" type="constructor">EAplus</span></a> ?<span class="id" type="var">X1</span> ?<span class="id" type="var">X2</span>) =&gt;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">e1</span> := <span class="id" type="var">simpl_monom</span> <span class="id" type="var">X1</span> <span class="id" type="keyword">with</span> <span class="id" type="var">e2</span> := <span class="id" type="var">simpl_all_monomials</span> <span class="id" type="var">X2</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">constr</span>:(<a class="idref" href="Coq.field.LegacyField_Theory.html#EAplus"><span class="id" type="constructor">EAplus</span></a> <span class="id" type="var">e1</span> <span class="id" type="var">e2</span>)<br/>
&nbsp;&nbsp;| ?<span class="id" type="var">X1</span> =&gt; <span class="id" type="var">simpl_monom</span> <span class="id" type="var">X1</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">end</span>.<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">assoc_distrib</span> <span class="id" type="var">trm</span> := <span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#assoc"><span class="id" type="definition">assoc</span></a> (<a class="idref" href="Coq.field.LegacyField_Theory.html#distrib"><span class="id" type="definition">distrib</span></a> <span class="id" type="var">trm</span>)).<br/>

<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">eval_weak_reduce</span> <span class="id" type="var">trm</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="var">eval</span><br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">cbv</span> <span class="id" type="var">beta</span> <span class="id" type="var">iota</span> <span class="id" type="var">zeta</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">delta</span> [<span class="id" type="var">interp_ExprA</span> <span class="id" type="var">assoc_2nd</span> <span class="id" type="var">eq_nat_dec</span> <span class="id" type="var">mult_of_list</span> <span class="id" type="var">A</span> <span class="id" type="var">Azero</span> <span class="id" type="var">Aone</span> <span class="id" type="var">Aplus</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">Amult</span> <span class="id" type="var">Aopp</span> <span class="id" type="var">Ainv</span>] <span class="id" type="keyword">in</span> <span class="id" type="var">trm</span>.<br/>

<br/>
<span class="id" type="keyword">Ltac</span> <span class="id" type="var">field_term</span> <span class="id" type="var">FT</span> <span class="id" type="var">exp</span> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">newexp</span> := <span class="id" type="var">init_exp</span> <span class="id" type="var">FT</span> <span class="id" type="var">exp</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">lvar</span> := <span class="id" type="var">build_varlist</span> <span class="id" type="var">FT</span> <span class="id" type="var">newexp</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">trm</span> := <span class="id" type="var">interp_A</span> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">newexp</span> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tma</span> := <span class="id" type="var">eval</span> <span class="id" type="tactic">compute</span> <span class="id" type="keyword">in</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#assoc"><span class="id" type="definition">assoc</span></a> <span class="id" type="var">trm</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">tsmp</span> :=<br/>
&nbsp;&nbsp;&nbsp;<span class="id" type="var">simpl_all_monomials</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ltac</span>:(<span class="id" type="var">assoc_distrib</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">simpl_all_monomials</span> <span class="id" type="var">ltac</span>:(<span class="id" type="var">simpl_inv</span> <span class="id" type="var">tma</span>))) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">trep</span> := <span class="id" type="var">eval_weak_reduce</span> (<a class="idref" href="Coq.field.LegacyField_Theory.html#interp_ExprA"><span class="id" type="definition">interp_ExprA</span></a> <span class="id" type="var">FT</span> <span class="id" type="var">lvar</span> <span class="id" type="var">tsmp</span>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;(<span class="id" type="tactic">replace</span> <span class="id" type="var">exp</span> <span class="id" type="keyword">with</span> <span class="id" type="var">trep</span>; [ <span class="id" type="var">legacy</span> <span class="id" type="tactic">ring</span> <span class="id" type="var">trep</span> | <span class="id" type="var">field_gen</span> <span class="id" type="var">FT</span> ]).<br/>
</div>
<div id="sidebarWrapper">
<div id="sidebar">

<div class="block">
<h2 class="title">Navigation</h2>
<div class="content">

<ul class="menu">

<li class="leaf">Standard Library
  <ul class="menu">
  <li><a href="index.html">Table of contents</a></li>
  <li><a href="genindex.html">Index</a></li>
  </ul>
</li>

</ul>

</div>
</div>

</div>
</div>


</div>

<div id="footer">
<div id="nav-footer">
  <ul class="links-menu-footer">
    <li><a href="mailto:www-coq_@_lix.polytechnique.fr">webmaster</a></li>
    <li><a href="http://validator.w3.org/check?uri=referer">xhtml valid</a></li>
    <li><a href="http://jigsaw.w3.org/css-validator/check/referer">CSS valid</a></li>
  </ul>

</div>
</div>

</div>

</body>
</html>

