<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>System (coq-core.System)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 1.5.3"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> â€“ <a href="../index.html">coq-core</a> &#x00BB; System</nav><h1>Module <code>System</code></h1><h6 id="coqtop-specific-system-utilities"><a href="#coqtop-specific-system-utilities" class="anchor"></a>Coqtop specific system utilities</h6><nav class="toc"><ul><li><a href="#directories">Directories</a></li><li><a href="#files-and-load-paths">Files and load paths</a></li><li><a href="#i/o-functions">I/O functions</a></li><li><a href="#time-stamps.">Time stamps.</a></li></ul></nav></header><section><header><h6 id="directories"><a href="#directories" class="anchor"></a>Directories</h6></header><dl><dt class="spec type" id="type-unix_path"><a href="#type-unix_path" class="anchor"></a><code><span class="keyword">type</span> unix_path</code><code> = string</code></dt><dt class="spec type" id="type-file_kind"><a href="#type-file_kind" class="anchor"></a><code><span class="keyword">type</span> file_kind</code><code> = </code><table class="variant"><tr id="type-file_kind.FileDir" class="anchored"><td class="def constructor"><a href="#type-file_kind.FileDir" class="anchor"></a><code>| </code><code><span class="constructor">FileDir</span> <span class="keyword">of</span> <a href="index.html#type-unix_path">unix_path</a> * string</code></td></tr><tr id="type-file_kind.FileRegular" class="anchored"><td class="def constructor"><a href="#type-file_kind.FileRegular" class="anchor"></a><code>| </code><code><span class="constructor">FileRegular</span> <span class="keyword">of</span> string</code></td></tr></table></dt></dl><dl><dt class="spec value" id="val-(//)"><a href="#val-(//)" class="anchor"></a><code><span class="keyword">val</span> (//) : <a href="index.html#type-unix_path">unix_path</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-unix_path">unix_path</a></code></dt><dt class="spec value" id="val-exists_dir"><a href="#val-exists_dir" class="anchor"></a><code><span class="keyword">val</span> exists_dir : <a href="index.html#type-unix_path">unix_path</a> <span>&#45;&gt;</span> bool</code></dt></dl><aside><p><code>exclude_search_in_dirname path</code> excludes <code>path</code> when processing directories</p></aside><dl><dt class="spec value" id="val-exclude_directory"><a href="#val-exclude_directory" class="anchor"></a><code><span class="keyword">val</span> exclude_directory : <a href="index.html#type-unix_path">unix_path</a> <span>&#45;&gt;</span> unit</code></dt></dl><aside><p><code>process_directory f path</code> applies <code>f</code> on contents of directory <code>path</code>; fails with Unix_error if the latter does not exists; skips all files or dirs starting with &quot;.&quot;</p></aside><dl><dt class="spec value" id="val-process_directory"><a href="#val-process_directory" class="anchor"></a><code><span class="keyword">val</span> process_directory : <span>(<a href="index.html#type-file_kind">file_kind</a> <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> <a href="index.html#type-unix_path">unix_path</a> <span>&#45;&gt;</span> unit</code></dt></dl><aside><p><code>process_subdirectories f path</code> applies <code>f path/file file</code> on each <code>file</code> of the directory <code>path</code>; fails with Unix_error if the latter does not exists; kips all files or dirs starting with &quot;.&quot;</p></aside><dl><dt class="spec value" id="val-process_subdirectories"><a href="#val-process_subdirectories" class="anchor"></a><code><span class="keyword">val</span> process_subdirectories : <span>(<a href="index.html#type-unix_path">unix_path</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> unit)</span> <span>&#45;&gt;</span> <a href="index.html#type-unix_path">unix_path</a> <span>&#45;&gt;</span> unit</code></dt></dl></section><section><header><h6 id="files-and-load-paths"><a href="#files-and-load-paths" class="anchor"></a>Files and load paths</h6></header><aside><p>Load path entries remember the original root given by the user. For efficiency, we keep the full path (field <code>directory</code>), the root path and the path relative to the root.</p></aside><dl><dt class="spec value" id="val-all_subdirs"><a href="#val-all_subdirs" class="anchor"></a><code><span class="keyword">val</span> all_subdirs : <span>unix_path:string</span> <span>&#45;&gt;</span> <span><span>(<a href="../CUnix/index.html#type-physical_path">CUnix.physical_path</a> * <span>string list</span>)</span> list</span></code></dt><dt class="spec value" id="val-is_in_path"><a href="#val-is_in_path" class="anchor"></a><code><span class="keyword">val</span> is_in_path : <a href="../CUnix/index.html#type-load_path">CUnix.load_path</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-is_in_system_path"><a href="#val-is_in_system_path" class="anchor"></a><code><span class="keyword">val</span> is_in_system_path : string <span>&#45;&gt;</span> bool</code></dt><dt class="spec value" id="val-where_in_path"><a href="#val-where_in_path" class="anchor"></a><code><span class="keyword">val</span> where_in_path : <span>?&#8288;warn:bool</span> <span>&#45;&gt;</span> <a href="../CUnix/index.html#type-load_path">CUnix.load_path</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../CUnix/index.html#type-physical_path">CUnix.physical_path</a> * string</code></dt><dt class="spec value" id="val-find_file_in_path"><a href="#val-find_file_in_path" class="anchor"></a><code><span class="keyword">val</span> find_file_in_path : <span>?&#8288;warn:bool</span> <span>&#45;&gt;</span> <a href="../CUnix/index.html#type-load_path">CUnix.load_path</a> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="../CUnix/index.html#type-physical_path">CUnix.physical_path</a> * string</code></dt><dd><p><code>find_file_in_path ?warn loadpath filename</code> returns the directory name and long name of the first physical occurrence <code>filename</code> in one of the directory of the <code>loadpath</code>; fails with a user error if no such file exists; warn if two or more files exist in the loadpath; returns instead the directory name of <code>filename</code> is <code>filename</code> is an absolute path</p></dd></dl><dl><dt class="spec value" id="val-all_in_path"><a href="#val-all_in_path" class="anchor"></a><code><span class="keyword">val</span> all_in_path : <span><span>(<a href="../CUnix/index.html#type-physical_path">CUnix.physical_path</a> * <span class="type-var">'a</span>)</span> list</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <span><span>(<span class="type-var">'a</span> * string)</span> list</span></code></dt><dd><p><code>all_in_path loadpath filename</code> returns the list of the directory name and full name of all physical occurrences of <code>filename</code> in a <code>loadpath</code> binding physical paths to some arbitrary key</p></dd></dl><dl><dt class="spec value" id="val-trust_file_cache"><a href="#val-trust_file_cache" class="anchor"></a><code><span class="keyword">val</span> trust_file_cache : <span>bool Stdlib.ref</span></code></dt><dd><p><code>trust_file_cache</code> indicates whether we trust the underlying mapped file-system not to change along the execution of Coq. This assumption greatly speds up file search, but it is often inconvenient in interactive mode</p></dd></dl><dl><dt class="spec value" id="val-file_exists_respecting_case"><a href="#val-file_exists_respecting_case" class="anchor"></a><code><span class="keyword">val</span> file_exists_respecting_case : string <span>&#45;&gt;</span> string <span>&#45;&gt;</span> bool</code></dt></dl></section><section><header><h6 id="i/o-functions"><a href="#i/o-functions" class="anchor"></a>I/O functions</h6></header><aside><p>Generic input and output functions, parameterized by a magic number and a suffix. The intern functions raise the exception <code>Bad_magic_number</code> when the check fails, with the full file name and expected/observed magic numbers.</p></aside><dl><dt class="spec type" id="type-magic_number_error"><a href="#type-magic_number_error" class="anchor"></a><code><span class="keyword">type</span> magic_number_error</code><code> = </code><code>{</code><table class="record"><tr id="type-magic_number_error.filename" class="anchored"><td class="def field"><a href="#type-magic_number_error.filename" class="anchor"></a><code>filename : string;</code></td></tr><tr id="type-magic_number_error.actual" class="anchored"><td class="def field"><a href="#type-magic_number_error.actual" class="anchor"></a><code>actual : int32;</code></td></tr><tr id="type-magic_number_error.expected" class="anchored"><td class="def field"><a href="#type-magic_number_error.expected" class="anchor"></a><code>expected : int32;</code></td></tr></table><code>}</code></dt></dl><dl><dt class="spec exception" id="exception-Bad_magic_number"><a href="#exception-Bad_magic_number" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Bad_magic_number</span> <span class="keyword">of</span> <a href="index.html#type-magic_number_error">magic_number_error</a></code></dt><dt class="spec exception" id="exception-Bad_version_number"><a href="#exception-Bad_version_number" class="anchor"></a><code><span class="keyword">exception</span> </code><code><span class="exception">Bad_version_number</span> <span class="keyword">of</span> <a href="index.html#type-magic_number_error">magic_number_error</a></code></dt></dl><dl><dt class="spec value" id="val-with_magic_number_check"><a href="#val-with_magic_number_check" class="anchor"></a><code><span class="keyword">val</span> with_magic_number_check : <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt></dl><aside><p>big-endian encoding and decoding of int32 (4 btyes) and int64 (8 bytes)</p></aside><dl><dt class="spec value" id="val-input_int32"><a href="#val-input_int32" class="anchor"></a><code><span class="keyword">val</span> input_int32 : Stdlib.in_channel <span>&#45;&gt;</span> int32</code></dt><dt class="spec value" id="val-input_int64"><a href="#val-input_int64" class="anchor"></a><code><span class="keyword">val</span> input_int64 : Stdlib.in_channel <span>&#45;&gt;</span> int64</code></dt><dt class="spec value" id="val-output_int32"><a href="#val-output_int32" class="anchor"></a><code><span class="keyword">val</span> output_int32 : Stdlib.out_channel <span>&#45;&gt;</span> int32 <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-output_int64"><a href="#val-output_int64" class="anchor"></a><code><span class="keyword">val</span> output_int64 : Stdlib.out_channel <span>&#45;&gt;</span> int64 <span>&#45;&gt;</span> unit</code></dt></dl><aside><p>Clones of Marshal.to_channel (with flush) and Marshal.from_channel (with nice error message)</p></aside><dl><dt class="spec value" id="val-marshal_out"><a href="#val-marshal_out" class="anchor"></a><code><span class="keyword">val</span> marshal_out : Stdlib.out_channel <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> unit</code></dt><dt class="spec value" id="val-marshal_in"><a href="#val-marshal_in" class="anchor"></a><code><span class="keyword">val</span> marshal_in : string <span>&#45;&gt;</span> Stdlib.in_channel <span>&#45;&gt;</span> <span class="type-var">'a</span></code></dt><dt class="spec value" id="val-check_caml_version"><a href="#val-check_caml_version" class="anchor"></a><code><span class="keyword">val</span> check_caml_version : <span>caml:string</span> <span>&#45;&gt;</span> <span>file:string</span> <span>&#45;&gt;</span> unit</code></dt></dl></section><section><header><h6 id="time-stamps."><a href="#time-stamps." class="anchor"></a>Time stamps.</h6></header><dl><dt class="spec type" id="type-time"><a href="#type-time" class="anchor"></a><code><span class="keyword">type</span> time</code></dt></dl><dl><dt class="spec value" id="val-get_time"><a href="#val-get_time" class="anchor"></a><code><span class="keyword">val</span> get_time : unit <span>&#45;&gt;</span> <a href="index.html#type-time">time</a></code></dt><dt class="spec value" id="val-time_difference"><a href="#val-time_difference" class="anchor"></a><code><span class="keyword">val</span> time_difference : <a href="index.html#type-time">time</a> <span>&#45;&gt;</span> <a href="index.html#type-time">time</a> <span>&#45;&gt;</span> float</code></dt><dd><p>in seconds</p></dd></dl><dl><dt class="spec value" id="val-fmt_time_difference"><a href="#val-fmt_time_difference" class="anchor"></a><code><span class="keyword">val</span> fmt_time_difference : <a href="index.html#type-time">time</a> <span>&#45;&gt;</span> <a href="index.html#type-time">time</a> <span>&#45;&gt;</span> <a href="../Pp/index.html#type-t">Pp.t</a></code></dt><dt class="spec value" id="val-with_time"><a href="#val-with_time" class="anchor"></a><code><span class="keyword">val</span> with_time : <span>batch:bool</span> <span>&#45;&gt;</span> <span>header:<a href="../Pp/index.html#type-t">Pp.t</a></span> <span>&#45;&gt;</span> <span>(<span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span>)</span> <span>&#45;&gt;</span> <span class="type-var">'a</span> <span>&#45;&gt;</span> <span class="type-var">'b</span></code></dt><dt class="spec value" id="val-get_toplevel_path"><a href="#val-get_toplevel_path" class="anchor"></a><code><span class="keyword">val</span> get_toplevel_path : <span>?&#8288;byte:bool</span> <span>&#45;&gt;</span> string <span>&#45;&gt;</span> string</code></dt><dd><p><code>get_toplevel_path program</code> builds a complete path to the executable denoted by <code>program</code>. This involves:</p><ul><li>locating the directory: we don't rely on PATH as to make calls to /foo/bin/coqtop chose the right /foo/bin/coqproofworker</li></ul><ul><li>adding the proper suffixes: .opt/.byte depending on the current mode, + .exe if in windows.</li></ul><p>Note that this function doesn't check that the executable actually exists. This is left back to caller, as well as the choice of fallback strategy. We could add a fallback strategy here but it is better not to as in most cases if this function fails to construct the right name you want you execution to fail rather than fall into choosing some random binary from the system-wide installation of Coq.</p></dd></dl></section></div></body></html>